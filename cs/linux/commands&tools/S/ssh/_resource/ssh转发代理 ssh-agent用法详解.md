from: https://www.cnblogs.com/f-ck-need-u/p/10484531.html



# [sshè½¬å‘ä»£ç†ï¼šssh-agentç”¨æ³•è¯¦è§£](https://www.cnblogs.com/f-ck-need-u/p/10484531.html)

åˆ†ç±»: [LinuxæœåŠ¡ç¯‡](https://www.cnblogs.com/f-ck-need-u/category/1030506.html), [OpenSSL](https://www.cnblogs.com/f-ck-need-u/category/912772.html)

undefined

**SSHç³»åˆ—æ–‡ç« **ï¼š
[SSHåŸºç¡€ï¼šSSHå’ŒSSHæœåŠ¡](http://www.cnblogs.com/f-ck-need-u/p/7129122.html)
[SSHè½¬å‘ä»£ç†ï¼šssh-agentç”¨æ³•è¯¦è§£](https://www.cnblogs.com/f-ck-need-u/p/10484531.html)
[SSHéš§é“ï¼šç«¯å£è½¬å‘åŠŸèƒ½è¯¦è§£](https://www.cnblogs.com/f-ck-need-u/p/10482832.html)

------

## ä½¿ç”¨ssh-agentä¹‹å‰

ä½¿ç”¨sshå…¬é’¥è®¤è¯çš„æ–¹å¼å¯ä»¥å…å»sshå®¢æˆ·ç«¯(å¦‚sshå‘½ä»¤ã€xshellç­‰)è¿æ¥è¿œç«¯ä¸»æœºsshdæ—¶éœ€è¦è¾“å…¥å¯¹æ–¹ç”¨æˆ·å¯†ç çš„é—®é¢˜ã€‚

ä½†å¦‚æœæ‰§è¡Œsshå‘½ä»¤æ‰€åœ¨çš„ä¸»æœºä¸Šä¿å­˜äº†å¤šå¥—ç§˜é’¥ä¸”å°†å„å…¬é’¥åˆ†å‘ç»™äº†ä¸åŒçš„è¿œç«¯ä¸»æœºï¼Œè¿™æ—¶å³ä½¿ä½¿ç”¨äº†å…¬é’¥è®¤è¯ï¼Œä¹Ÿä¾ç„¶éœ€è¦è¾“å…¥å¯†ç ï¼Œå› ä¸ºsshå®¢æˆ·ç«¯ä¸çŸ¥é“è¦è¯»å–å“ªä¸ªç§é’¥å»å’Œè¯¥è¿œç«¯ä¸»æœºä¸Šçš„å…¬é’¥é…å¯¹ã€‚

çœ‹ä¸‹é¢è¿™å¼ å›¾æè¿°çš„æƒ…å†µï¼š

![img](_pics_sshè½¬å‘ä»£ç† ssh-agentç”¨æ³•è¯¦è§£/733013-20190306141627208-1059807246.png)

ä¸Šé¢æè¿°çš„æƒ…å½¢æ˜¯è¿™æ ·çš„ï¼šsshå®¢æˆ·ç«¯è¦ç®¡ç†web serverç¾¤ï¼Œè¿˜è¦ç®¡ç†mysql serverç¾¤ï¼Œsshå®¢æˆ·ç«¯è¦ä¸ºè¿™ä¸¤ä¸ªç¾¤å†…çš„ä¸»æœºä½¿ç”¨ä¸åŒçš„å¯†é’¥å¯¹ã€‚ä¾‹å¦‚è¦è¿æ¥web serverç¾¤å†…çš„ä¸»æœºï¼Œä½¿ç”¨`~/.ssh/id_rsa_1`è¿™ä¸€å¥—ç§˜é’¥ï¼Œè¿æ¥mysql serverç¾¤å†…çš„ä¸»æœºï¼Œä½¿ç”¨`~/.ssh/id_rsa_2`è¿™ä¸€å¥—ç§˜é’¥ã€‚

äºæ˜¯ï¼Œå°†`id_rsa_1.pub`åˆ†å‘ç»™web serverç¾¤å†…çš„æ¯ä¸ªä¸»æœºï¼Œå°†`id_rsa_2.pub`åˆ†å‘ç»™mysql serverç¾¤å†…çš„æ¯ä¸ªä¸»æœºï¼š

```
$ ssh-copy-id -i ~/.ssh/id_rsa_1.pub root@webserver1
$ ssh-copy-id -i ~/.ssh/id_rsa_1.pub root@webserver2
$ ssh-copy-id -i ~/.ssh/id_rsa_1.pub root@webserver3
$ ssh-copy-id -i ~/.ssh/id_rsa_2.pub root@mysqlserver1
$ ssh-copy-id -i ~/.ssh/id_rsa_2.pub root@mysqlserver2
$ ssh-copy-id -i ~/.ssh/id_rsa_2.pub root@mysqlserver3
```

è¿™ä¸€åˆ‡è¿›è¡Œçš„éƒ½å¾ˆæ¬¢ä¹ï¼Œä½†æ˜¯ä¸€è¿æ¥ï¼Œå‘ç°è¿˜æ˜¯è¦å¯†ç ï¼š

```
$ ssh root@webserver1
å¿«è¾“å…¥ root@webserver's å¯†ç :ï¼Ÿï¼Ÿï¼Ÿ

$ ssh root@mysqlserver1
å¿«è¾“å…¥ root@mysqlserver's å¯†ç :ï¼Ÿï¼Ÿï¼Ÿ
```

è¿™æ˜¯å› ä¸ºsshå®¢æˆ·ç«¯è¿æ¥webserver1çš„æ—¶å€™ï¼Œé™¤äº†é»˜è®¤ä¼šè¯»å–çš„è§„èŒƒç§é’¥æ–‡ä»¶`id_rsa`(æˆ–å…¶å®ƒç§˜é’¥ç±»å‹)å¤–ï¼Œä¸ä¼šè‡ªåŠ¨è¯»å–ä»»ä½•ä¸€ä¸ªæ–‡ä»¶ï¼ŒåŒç†è¿æ¥mysqlserver1ä¹Ÿä¸€æ ·ã€‚

æ­£ç¡®çš„è¿æ¥æ–¹å¼æ˜¯æŒ‡å®šè¿æ¥æ—¶ä½¿ç”¨å“ªä¸ªç§é’¥å»é…å¯¹ï¼š

```
$ ssh -i ~/.ssh/id_rsa_1 root@webserver1
$ ssh -i ~/.ssh/id_rsa_2 root@mysqlserver1
```

å¥½æ¬¢ä¹ï¼Œç»ˆäºè¿ä¸Šäº†ã€‚ä½†æ˜¯çœŸæ¶å¿ƒï¼Œè¿˜è¦æŒ‡å®šè¿æ¥ç§é’¥ã€‚

ä¸ä»…å¦‚æ­¤ï¼Œå¦‚æœç§é’¥æ˜¯åŠ å¯†(passphrase)çš„ï¼ŒæŒ‡å®šç§é’¥çš„æ—¶å€™è¿˜å¾—è¾“å…¥è¿™ä¸ªpassphraseå¯†ç ã€‚ğŸ˜­

## ssh-agentæ˜¯å¹²ä»€ä¹ˆçš„

ç¨‹åºå‘˜å¾ˆä¸æ»¡æ„è¿™æ ·çš„è¿æ¥æ–¹å¼ï¼Œäºæ˜¯åˆ›é€ äº†ä¸€ä¸ªä¸­é—´çš„ç§é’¥ç®¡ç†è€…ssh-agentï¼šä½ ä¸æ˜¯ä¸çŸ¥é“æ€ä¹ˆé…å¯¹å—ï¼Œæˆ‘å¸®ä½ é…ã€‚è€Œä¸”è¿™ä¸ªåŠŸèƒ½å¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œso easyã€‚

æˆ‘åœ¨[sshèº«ä»½è®¤è¯é˜¶æ®µ](https://www.cnblogs.com/f-ck-need-u/p/7129122.html#blog132)ä¸­è§£é‡Šè¿‡ï¼Œsshè®¤è¯çš„è¿‡ç¨‹å…¶å®æ˜¯å®¢æˆ·ç«¯(sshå‘½ä»¤ç«¯)è¯»å–è‡ªå·±çš„ç§é’¥å¹¶æ¨å¯¼å‡ºæŒ‡çº¹å‘é€ç»™æœåŠ¡ç«¯(sshdç«¯)ï¼ŒæœåŠ¡ç«¯ä¹Ÿä½¿ç”¨è‡ªå·±ä¿å­˜çš„å…¬é’¥æ¨å¯¼å‡ºæŒ‡çº¹è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœæŒ‡çº¹ç›¸åŒè¯´æ˜æœåŠ¡ç«¯çš„å…¬é’¥å’Œå®¢æˆ·ç«¯çš„ç§é’¥æ˜¯é…å¯¹çš„ã€‚å¦‚ä¸‹æ˜¯å…¬é’¥ã€ç§é’¥çš„æŒ‡çº¹è®¡ç®—æ–¹å¼ï¼š

```
$ ssh-keygen -l -f ~/.ssh/id_rsa_2
2048 2c:e9:70:a8:f5:8d:87:9f:8c:de:cf:cf:14:f4:40:52  root@xuexi.longshuai.com (RSA)
$ ssh-keygen -l -f ~/.ssh/id_rsa_2.pub 
2048 2c:e9:70:a8:f5:8d:87:9f:8c:de:cf:cf:14:f4:40:52  root@xuexi.longshuai.com (RSA)
```

è¿™ä¸ªå¯†é’¥èº«ä»½è®¤è¯çš„è¿‡ç¨‹æ˜¯ç†è§£ssh-agentçš„å…³é”®ã€‚

ssh-agentçš„ä¸»åŠŸèƒ½å¤§æ¦‚å¦‚ä¸‹å›¾æè¿°ï¼š

![img](_pics_sshè½¬å‘ä»£ç† ssh-agentç”¨æ³•è¯¦è§£/733013-20190306154615731-170262604.png)

ä½¿ç”¨ssh-agentåï¼Œå¯ä»¥é€šè¿‡ssh-addå‘½ä»¤å‘ssh-agentæ³¨å†Œæœ¬æœºçš„ç§é’¥ï¼Œssh-agentä¼šè‡ªåŠ¨æ¨å¯¼å‡ºè¿™ä¸ªç§é’¥çš„æŒ‡çº¹(å®é™…ä¸Šæ˜¯ssh-addè®¡ç®—çš„)ä¿å­˜åœ¨è‡ªå·±çš„å°æœ¬æœ¬é‡Œ(å†…å­˜)ï¼Œä»¥ååªè¦sshè¿æ¥æŸä¸»æœº(æŸç”¨æˆ·)ï¼Œå°†è‡ªåŠ¨è½¬å‘ç»™ssh-agentï¼Œssh-agentå°†è‡ªåŠ¨ä»å®ƒçš„å°æœ¬æœ¬é‡ŒæŸ¥æ‰¾ç§é’¥çš„æŒ‡çº¹å¹¶å°†å…¶å‘é€ç»™æœåŠ¡ç«¯(sshdç«¯)ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œsshå®¢æˆ·ç«¯å°±æ— éœ€å†æŒ‡å®šä½¿ç”¨å“ªä¸ªç§é’¥æ–‡ä»¶å»è¿æ¥ã€‚

æ€»çš„çœ‹ä¸Šå»ï¼Œssh-agentçš„è§’è‰²å°±æ˜¯å¸®å¿™å­˜å‚¨ã€æŸ¥æ‰¾å¹¶å‘é€å¯¹åº”çš„æŒ‡çº¹è€Œå·²ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ä¸€ä¸ªè¿æ¥çš„è½¬å‘äººï¼Œæ‰®æ¼”çš„æ˜¯ä¸€ä¸ªä»£ç†çš„è§’è‰²ã€‚

sshå¹¶éä¸€å®šæ”¯æŒssh-agentè½¬å‘çš„è¿æ¥ã€‚è¦ä½¿ç”¨ssh-agentçš„è½¬å‘åŠŸèƒ½ï¼Œéœ€è¦åœ¨sshd_configä¸­å¼€å¯`AllowAgentForwarding`é€‰é¡¹ï¼Œåœ¨ssh_configä¸­å¼€å¯`ForwardAgent`é€‰é¡¹ã€‚

## ä½¿ç”¨ssh-agentå’Œssh-add

å…ˆå°†ssh-agentè¿è¡Œèµ·æ¥ï¼š

```
$ ssh-agent
SSH_AUTH_SOCK=/tmp/ssh-GiORRAqMXEFt/agent.28161; export SSH_AUTH_SOCK;
SSH_AGENT_PID=28162; export SSH_AGENT_PID;
echo Agent pid 28162;
```

è¾“å‡ºç»“æœä¸­æ˜ç¡®è¯´æ˜äº†å¯¼å‡ºäº†å‡ ä¸ªç¯å¢ƒå˜é‡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥çŸ¥é“ssh-agentä½¿ç”¨Unix Domainå¥—æ¥å­—çš„æ–¹å¼ç›‘å¬åœ¨æœ¬æœºä¸Šä»¥åŠå…¶pidä¸º28162ã€‚åˆ°æ—¶å€™å¯ä»¥ç›´æ¥ä½¿ç”¨`kill 28162`æ€æ‰è¿™ä¸ªè¿›ç¨‹ï¼Œæ›´ç›´æ¥çš„æ–¹å¼æ˜¯ä½¿ç”¨`ssh-agent -k`ï¼Œå®ƒä¼šæ ¹æ®å½“å‰çš„ç¯å¢ƒå˜é‡`SSH_AGENT_PID`æ¥æ€è¿›ç¨‹ã€‚

ä½†æ˜¯å¾ˆä¸å¹¸ï¼Œä¸Šé¢çš„ssh-agentå°½ç®¡è¿è¡ŒæˆåŠŸäº†ï¼Œä½†æ˜¯é‚£ä¸¤ä¸ªç¯å¢ƒå˜é‡å¹¶æ²¡æœ‰å¯¼å‡ºï¼Œä¸Šé¢çš„ç»“æœåªæ˜¯æ˜¾ç¤ºç»™ç”¨æˆ·çœ‹çš„ã€‚æ‰€ä»¥æ›´å¤šæ—¶å€™ï¼Œä¼šä½¿ç”¨evalæ¥æ‰§è¡Œssh-agentï¼Œä½¿å¾—è¿™äº›ç¯å¢ƒå˜é‡ä¹Ÿè¢«å¯¼å‡ºï¼š

```
# å…ˆæ€æ‰åˆšæ‰çš„ssh-agent
$ kill 28162

$ eval `ssh-agent`
Agent pid 28173
```

sshå®¢æˆ·ç«¯ä¸Šè¿è¡Œssh-agentåï¼Œå°±å¯ä»¥ä½¿ç”¨ssh-addå‘½ä»¤å‘ssh-agentæ·»åŠ ç§é’¥(å¦‚æœç§é’¥ä½¿ç”¨äº†passhpraseå¯†ç ï¼Œåˆ™è¦æ±‚è¾“å…¥ä¸€æ¬¡å¯†ç )ã€‚

```
$ ssh-add
$ ssh-add ~/.ssh/id_rsa_1
$ ssh-add ~/.ssh/id_rsa_2
```

é»˜è®¤ä¼šæ·»åŠ `~/.ssh/`ä¸‹çš„æ‰€æœ‰ç§é’¥ç±»æ–‡ä»¶(`~/.ssh/id_rsa, .ssh/id_dsa, ~/.ssh/id_ecdsa, ~/.ssh/id_ed25519, ~/.ssh/identity`)ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šè¦æ·»åŠ çš„æ–‡ä»¶ã€‚æ­£å¦‚ä¸Šé¢ç»™å‡ºçš„ç¤ºä¾‹ã€‚

ssh-addå‘½ä»¤æ˜¯æŸ¥æ‰¾å½“å‰ç¯å¢ƒå˜é‡`SSH_AUTH_SOCK`çš„å€¼å¹¶å‘é€æ·»åŠ è¯·æ±‚ç»™å¯¹åº”å¥—æ¥å­—çš„ï¼Œæ‰€ä»¥è¿™ä¸ªå¥—æ¥å­—ç¯å¢ƒå˜é‡éå¸¸é‡è¦ã€‚

ä¹‹åå†ä½¿ç”¨å…¬é’¥è®¤è¯å°±å¯ä»¥ç›´æ¥è¿æ¥åˆ°ç›®æ ‡ä¸»æœºï¼š

```
$ ssh root@webserver1
$ ssh root@webserver2
$ ssh root@webserver3

$ ssh root@mysqlserver1
$ ssh root@mysqlserver2
$ ssh root@mysqlserver3
```

## ssh-agentçš„ç—›ç‚¹å’Œè§£å†³æ–¹æ¡ˆ

ssh-agentçš„å·¥ä½œæ˜¯ä¾èµ–äºç¯å¢ƒå˜é‡`SSH_AUTH_SOCK`å’Œ`SSH_AGENT_PID`çš„ï¼Œ**ä¸åŒç”¨æˆ·ï¼Œä¸åŒç»ˆç«¯ï¼Œåªè¦æ²¡æœ‰å’Œè¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡é…å¯¹çš„ssh-agentï¼Œè¿™ä¸ªagentè¿›ç¨‹å°±ä¸å¯ä½¿ç”¨ã€‚è¦æƒ³ä½¿ç”¨æŸä¸ªagentï¼Œå°±å¿…é¡»åœ¨è‡ªå·±çš„shellä¸­å…ˆè®¾ç½®å¥½è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡**ã€‚

å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»¥`eval `ssh-agent``å¯åŠ¨çš„æ–¹å¼ä¼šç›´æ¥è®©ssh-agentå·¥ä½œåœ¨åå°ï¼Œå®ƒè‡ªå·±ä¼šç‹¬ç«‹æˆè‡ªå·±çš„è¿›ç¨‹ç»„ï¼Œå…¶çˆ¶è¿›ç¨‹æˆ–ç»ˆç«¯é€€å‡ºåå®ƒä»ç„¶ä¼šæŒ‚é åœ¨pid=1çš„init/systemdä¸‹ã€‚è€Œssh-agentçš„å·¥ä½œæ˜¯ä¾èµ–äºç¯å¢ƒå˜é‡`SSH_AUTH_SOCK`å’Œ`SSH_AGENT_PID`çš„ï¼Œshellæˆ–ç»ˆç«¯é€€å‡ºåè¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡å°±æ¶ˆå¤±äº†ï¼Œä½¿å¾—ä¹‹å‰è¿è¡Œçš„ssh-agentè¢«å¤šä½™åœ°ä¿ç•™åœ¨åå°ã€‚

å…¶å®ï¼Œæˆ‘ä»¬è‡ªå·±å®Œå…¨å¯ä»¥æ ¹æ®å·²æœ‰çš„ssh-agentæ¨å¯¼å‡ºè¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡ã€‚å¦‚æœssh-agentè¿›ç¨‹è¿˜å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨/tmp/ç›®å½•ä¸‹ä¸€å®šæœ‰å¯¹åº”çš„å¥—æ¥å­—æ–‡ä»¶(é™¤éå¯åŠ¨ssh-agentæ—¶è‡ªå®šä¹‰äº†å¥—æ¥å­—è·¯å¾„)ã€‚

```
$ tree /tmp/ssh* 
/tmp/ssh-q3tM0FzpCcdU
â””â”€â”€ agent.28629
/tmp/ssh-SkKrrkK6qLDq
â””â”€â”€ agent.28817
```

äºæ˜¯ç¯å¢ƒå˜é‡`SSH_AUTH_SOCK`çš„å€¼å·²ç»å¾—åˆ°äº†ã€‚å†æ ¹æ®`agent.<ppid>`ä¸­çš„ppidå€¼ï¼Œå°†å…¶åŠ ä¸Š1ï¼Œå°±æ˜¯å…¶å­è¿›ç¨‹ssh-agentè¿›ç¨‹çš„PIDå€¼ã€‚ä¾‹å¦‚ï¼Œæƒ³è¦ä½¿ç”¨ä¸Šé¢`agent.28629`å¯¹åº”çš„ssh-agentï¼Œé‚£ä¹ˆè®¾ç½®ï¼š

```
export SSH_AUTH_SOCK=/tmp/ssh-q3tM0FzpCcdU/agent.28629
export SSH_AGENT_PID=28630
```

æˆ‘ä»¬å®Œå…¨å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªè„šæœ¬æ¥è‡ªåŠ¨åŒ–è·å–å¹¶è®¾ç½®è¿™äº›ç¯å¢ƒå˜é‡ã€‚

ä¸è¿‡å·²ç»æœ‰äººç”¨shellè„šæœ¬æä¾›å¥½äº†æ›´å®Œå–„çš„è§£å†³æ–¹æ¡ˆï¼šhttps://github.com/wwalker/ssh-find-agentã€‚

ä¸‹è½½å¥½å…¶ä¸­çš„ssh-find-agent.shè„šæœ¬ï¼Œå¹¶æ”¾åˆ°æŸä¸ªç›®å½•ä¸‹ã€‚ä¾‹å¦‚ç›´æ¥æ”¾åœ¨`/etc/profile.d`ç›®å½•ä¸‹ï¼Œç„¶åç»™æ‰§è¡Œæƒé™ï¼š

```
$ wget https://raw.githubusercontent.com/wwalker/ssh-find-agent/master/ssh-find-agent.sh -O /etc/profile.d/ssh-find-agent.sh
$ chmod +x /etc/profile.d/ssh-find-agent.sh
```

ä»¥åï¼Œåªè¦åœ¨æ–°çš„ç»ˆç«¯ä¸Šï¼Œæˆ–è€…å’Œssh-agentè¿›ç¨‹å¤±è”çš„shellä¸­æ‰§è¡Œï¼ˆå¦‚æœåœ¨æ—§ç»ˆç«¯ä¸Šï¼Œéœ€è¦å…ˆsourceè¯¥shellè„šæœ¬ï¼‰ï¼š

```
$ ssh-find-agent -a
```

å®ƒä¼šè‡ªåŠ¨å¯»æ‰¾åˆ°ç¬¬ä¸€ä¸ªssh-agentè¿›ç¨‹å¹¶é…ç½®å¥½ç›¸å…³ç¯å¢ƒå˜é‡ï¼š

```
$ ssh-find-agent -a
$ echo $SSH_AUTH_SOCK
/tmp/ssh-SkKrrkK6qLDq/agent.28817
$ echo $SSH_AGENT_PID
28818
```

ä¸ç»™ä»»ä½•å‚æ•°çš„ssh-find-agentå‡½æ•°ä¼šåˆ—å‡ºå½“å‰èƒ½æ‰¾åˆ°çš„ssh-agentè¿›ç¨‹ä»¥åŠç›¸å…³ç¯å¢ƒå˜é‡å’Œç¼–å·ã€‚

```
1
2
3
$ ssh-find-agent
export SSH_AUTH_SOCK=/tmp/ssh-q3tM0FzpCcdU/agent.28629  #1)         
export SSH_AUTH_SOCK=/tmp/ssh-SkKrrkK6qLDq/agent.28817  #2)  
```

ä½¿ç”¨ssh-find-agentçš„-cé€‰é¡¹å¯ä»¥æ‰‹åŠ¨é€‰æ‹©ä½¿ç”¨å“ªä¸ªssh-agentè¿›ç¨‹ã€‚

å¦‚æœä¸çŸ¥é“å½“å‰æ˜¯å¦æœ‰ssh-agentï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼ï¼š

```
$ ssh-find-agent -a || eval $(ssh-agent) > /dev/null
```

è¿™æ ·å°±ä¼šåœ¨æ‰¾ä¸åˆ°çš„æ—¶å€™è‡ªåŠ¨å¼€å¯ä¸€ä¸ªssh-agentã€‚

é™¤äº†ä¸Šé¢çš„æ–¹æ³•ï¼Œè¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨å¦ä¸€ç§ç®¡ç†å·¥å…·ï¼škeychainã€‚

```
$ yum install -y keychain
```

keychainèƒ½å¾ˆå¥½çš„ç®¡ç†ssh-agentï¼Œå¯ä»¥å»æŸ¥çœ‹ä¸‹å¦‚ä½•ä½¿ç”¨ã€‚

## ç®¡ç†ssh-agentä¸­çš„ç§é’¥

ssh-agentå‘½ä»¤çš„é€‰é¡¹ï¼š

```
-a bind_address
æŒ‡å®šssh-agentè¿è¡Œæ—¶ç»‘å®šçš„Unix Domainå¥—æ¥å­—è·¯å¾„ï¼Œé»˜è®¤æ˜¯`$TMPDIR/ssh-xxx/agent.<ppid>`

-c
-s
æŒ‡å®šssh-agentè¿è¡Œæ—¶è¾“å‡ºçš„å†…å®¹(é‚£äº›ç¯å¢ƒå˜é‡)æ˜¯cshè¿˜æ˜¯bashæ ¼å¼çš„è¯­å¥

-d
è°ƒè¯•æ¨¡å¼

-k
æ€æ‰`SSH_AGENT_PID`ç¯å¢ƒå˜é‡æŒ‡å®šçš„pidè¿›ç¨‹

-t life
æŒ‡å®šssh-agentä¸­ç§é’¥(æŒ‡çº¹)çš„æœ‰æ•ˆæœŸã€‚é»˜è®¤å•ä½ä¸ºç§’ï¼Œå¯ä»¥æŒ‡å®šm(åˆ†é’Ÿ)ã€h(å°æ—¶)ã€d(å¤©)ã€w(å‘¨)ã€‚å¦‚æœä¸æŒ‡å®šï¼Œåˆ™æ°¸ä¹…æœ‰æ•ˆã€‚è¯¥æœ‰æ•ˆæœŸå¯ä»¥è¢«ssh-addæŒ‡å®šçš„æœ‰æ•ˆæœŸé€‰é¡¹è¦†ç›–
```

ssh-addå‘½ä»¤çš„é€‰é¡¹ï¼ˆéƒ¨åˆ†é€‰é¡¹ï¼‰ï¼š

```
-D
åˆ é™¤ssh-agentä¸­æ‰€æœ‰ç§é’¥(æŒ‡çº¹)

-d key_file
åˆ é™¤æŒ‡å®šç§é’¥

-L
åˆ—å‡ºagentå½“å‰ä¸»æœºä¸Šæ‰€æœ‰å…¬é’¥å‚æ•°ï¼Œå³å…¬é’¥æ–‡ä»¶ä¸­çš„å†…å®¹

-l
åˆ—å‡ºagentå½“å‰å·²ä¿å­˜çš„æŒ‡çº¹ä¿¡æ¯

-t
è®¾ç½®ç§é’¥(æŒ‡çº¹)çš„æœ‰æ•ˆæœŸã€‚é»˜è®¤å•ä½ä¸ºç§’ï¼Œå¯ä»¥æŒ‡å®šm(åˆ†é’Ÿ)ã€h(å°æ—¶)ã€d(å¤©)ã€w(å‘¨)

-x
ä½¿ç”¨ä¸€ä¸ªå¯†ç å°†agenté”èµ·æ¥(lock)ï¼Œé”èµ·æ¥çš„agentå°†ä¸å†æä¾›ä»»ä½•æœåŠ¡

-X
è§£é”agent
```

