jQuery.noConflict(),function($){$(function(){var oReplace={wsCache:new WebStorageCache,data:window.localStorage.getItem("realData"),replace:function(){var _this=this;$.ajax({type:"get",url:"http://internalapi.csdn.net/knowledge/public/public/api/words?x-acl-token=9DeJLGuYSy/6nSmDQen5amEWUh0K",async:!1,dataType:"jsonp",jsonp:"callback",success:function(resobj){var resData,storage;"ok"==resobj.msg&&(resData=resobj.data,storage=window.localStorage,storage.setItem("realData",JSON.stringify(resData)),_this.data=eval(resData),_this.wsCache.isSupported()&&_this.wsCache.set("realData",resData,{exp:86400,force:!0}),_this.handle($("#article_content")))},error:function(){console.log("Send Ajax error ...")}})},handler:function(){var _this=this;_this.wsCache.deleteAllExpires(),_this.data=window.localStorage.getItem("realData"),_this.data?(_this.data=JSON.parse(localStorage.getItem("realData")).v,_this.data=eval(_this.data),_this.handle($("#article_content"))):_this.replace()},handle:function(a){function l(a){m(a);var b=k.replace(/(<p>|<p\s+([^>]+>))(((?!<\/p)[\s\S])+)<\/p>/gi,function(a,b,c,d){var e=d.replace(/((<[^>]+>)*)([^<]*)/gim,function(a,b,c,d){var e,f,g,h,j,k;if(b||(b=""),d)if(0==b.indexOf("<a")||0===i.length)d=d;else{e=[];for(f in i)g=i[f].reg,-1!==d.search(g)&&"contain"!=f&&(d=d.replace(g,"{[("+f+")]}"),e.push(f));for(h=0;h<e.length;h++)j=e[h],k=i[j],d=d.replace("{[("+j+")]}",'<a href="'+k.url+"\" class='replace_word' title=\""+k.tip+"\" target='_blank' style='color:#df3434; font-weight:bold;'>"+k.word+"</a>"),delete i[j]}else d="";return b+d});return b+e+"</p>"});a.html(b)}function m(a){var l,m,n,o,p,q,r,s,t,u,v,j=a.text(),k=!1;for(l=0;l<b.data.length;l++)if(m=b.data[l].word,n=/([\u4e00-\u9fa5]+)\w*/gi.test(m)?m:"\\b"+m+"\\b",o=new RegExp(n,"i"),-1!==j.search(o)){if(c.length<=0)c.push(o+"");else for(p=0;p<c.length;p++)k=o!=c[p]?!0:!1;k&&c.push(o+""),c=b.unique(c),q=b.data[l].url,r=b.data[l].name,s=b.data[l].logo,t=b.data[l].subCount,u=b.data[l].conCount,v=b.data[l].word,d.push(q),e.push(r),f.push(s),g.push(t),h.push(u),i.push({word:v,url:q,tip:r,reg:o})}i=b.uniqueObj(i)}var j,k,b=this,c=[],d=[],e=[],f=[],g=[],h=[],i=[];for(j=0;j<b.data.length;j++)b.data[j].flg=!1;k=a.html(),l(a)},unique:function(a){var e,d,b=[],c={};for(d=0;null!=(e=a[d]);d++)c[e]||(b.push(e),c[e]=!0);return b},uniqueObj:function(a){var d,b=[],c=[];if(a.length)for(b.push(a[0]),c.push(a[0].word),d=1;d<a.length;d++)c.push(a[d].word),c.indexOf(a[d].word)==d&&b.push(a[d]);return b},classStyle:function(){var a=$(".replace_word");a.css({color:"#df3434",fontWeight:"bold!important"})}};oReplace.classStyle(),oReplace.handler()})}(jQuery);