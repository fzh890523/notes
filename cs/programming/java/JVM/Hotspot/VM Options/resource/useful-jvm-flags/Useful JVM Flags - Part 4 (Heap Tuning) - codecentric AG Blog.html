<!doctype html><html lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#" class="no-js"><head><meta charset="UTF-8"><link type="text/css" media="all" href="https://blog.codecentric.de/wp-content/cache/autoptimize/2/autoptimize_06a85d694f971f4152da449e38354fab.php" rel="stylesheet" /><title>Useful JVM Flags - Part 4 (Heap Tuning) - codecentric AG Blog</title><link href="https://blog.codecentric.de/wp-content/themes/codecentric2015/img/icons/favicon.ico" rel="shortcut icon"><link href="https://blog.codecentric.de/wp-content/themes/codecentric2015/img/icons/touch.png" rel="apple-touch-icon-precomposed"><link rel="profile" href="http://gmpg.org/xfn/11"/><link rel="pingback" href="https://blog.codecentric.de/xmlrpc.php"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="google-site-verification" content="udyUJphOAc3iTldVhEpkEzYUeCNAQm1RJM4xXwKi82Q" /> <script>(function(i,s,o,g,r,a,m){i['InstanaEumObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//eum.instana.io/eum.min.js','ineum'); ineum('apiKey', 'cnkUbWdYSY-gaq4B26lgxw'); // Backend trace ID to facilitate correlation of frontend/backend traces. // Trace ID is available in backend to user code. // User is himself responsible for embedding this trace ID in this snippet. // ineum('traceId', '<backend trace id>'); // free form key/value pairs for advanced end-user tracking // ineum('meta', 'user', 'tom.mason@example.com');</script> <link rel="canonical" href="https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/" /><link rel="publisher" href="https://plus.google.com/+codecentricDe"/><meta property="og:locale" content="en_US" /><meta property="og:type" content="article" /><meta property="og:title" content="Useful JVM Flags - Part 4 (Heap Tuning) - codecentric AG Blog" /><meta property="og:description" content="Ideally, a Java application runs just fine with the default JVM settings so that there is no need to set any flags at all. However, in case of performance problems (which unfortunately arise quite often) some knowledge about relevant JVM flags is a welcome companion. In this part of our series, we will take a... Read more" /><meta property="og:url" content="https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/" /><meta property="og:site_name" content="codecentric AG Blog" /><meta property="article:publisher" content="https://www.facebook.com/codecentric" /><meta property="article:section" content="Java" /><meta property="article:published_time" content="2012-07-29T15:35:31+02:00" /><meta property="fb:admins" content="828173743" /><meta name="twitter:card" content="summary" /><meta name="twitter:description" content="Ideally, a Java application runs just fine with the default JVM settings so that there is no need to set any flags at all. However, in case of performance problems (which unfortunately arise quite often) some knowledge about relevant JVM flags is a welcome companion. In this part of our series, we will take a... Read more" /><meta name="twitter:title" content="Useful JVM Flags - Part 4 (Heap Tuning) - codecentric AG Blog" /><meta name="twitter:site" content="@codecentric" /><meta name="twitter:creator" content="@codecentric" /><link rel='dns-prefetch' href='//ajax.googleapis.com' /><link rel='dns-prefetch' href='//s.w.org' /> <script type="text/javascript">window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.codecentric.de\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.1"}}; !function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);</script> <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js?ver=1.11.0'></script> <link rel='https://api.w.org/' href='https://blog.codecentric.de/en/wp-json/' /><link rel="alternate" type="application/json+oembed" href="https://blog.codecentric.de/en/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.codecentric.de%2Fen%2F2012%2F07%2Fuseful-jvm-flags-part-4-heap-tuning%2F" /><link rel="alternate" type="text/xml+oembed" href="https://blog.codecentric.de/en/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.codecentric.de%2Fen%2F2012%2F07%2Fuseful-jvm-flags-part-4-heap-tuning%2F&#038;format=xml" /><meta name="generator" content="WPML ver:3.2.2 stt:1,3;" /><link rel="alternate" hreflang="en-US" href="https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/"/><link rel="alternate" hreflang="x-default" href="https://blog.codecentric.de/2011/07/nutzliche-jvm-flags-teil-4/"/><link rel="shortcut icon" type="image/x-icon" href="/wp-content/themes/codecentric2015-HP/img/icons/favicon.ico" /> <script type="text/javascript">var analyticsFileTypes = ['']; var analyticsSnippet = 'disabled'; var analyticsEventTracking = 'enabled';</script> <script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-2828835-3', 'auto'); ga('send', 'pageview');</script> </head><body class="post-template-default single single-post postid-14726 single-format-standard en useful-jvm-flags-part-4-heap-tuning"><header class="hidden-xs"><div class="header-top-outer-wrap"><div class="header-search-wrap"><div class="header-search"><div class="container"><div class="row"><div class="col-md-12"><div class="row"><form class="search" method="get" action="https://blog.codecentric.de/en" role="search"> <input class="search-input col-md-10" type="search" name="s" placeholder="To search, type and hit enter."><div class="col-md-2 pull-right text-right"> <input type="image" src="/wp-content/themes/codecentric2015/img/suche_lupe.png" alt="To search, type and hit enter."/> <span class="searchform-close"></span></div><input type='hidden' name='lang' value='en' /></form></div></div></div></div></div></div><div class="header-top-wrap"><div class="header-top"><div class="container"><div class="row regular"><div class="col-md-3 hidden-sm"> <a href="https://www.codecentric.de/"> <img src="https://blog.codecentric.de/wp-content/themes/codecentric2015/img/codecentric-logo.png" class="cc-logo" alt="codecentric"/> </a></div><div class="col-sm-2 visible-sm"> <a href="https://www.codecentric.de/"> <img src="https://blog.codecentric.de/wp-content/themes/codecentric2015/img/codecentric-logo-mobil-active.png" class="cc-logo" alt="codecentric"/> </a></div><div class="col-sm-10 col-md-9 pull-right"><ul class="list-inline list-unstyled top-nav"><li><a href="https://www.codecentric.de/leistungen/" class="">Services</a></li><li><a href="https://www.codecentric.de/karriere/" class="">Career</a></li><li><a href="https://www.codecentric.de/wissen/" class="">Knowledge</a></li><li><a href="https://blog.codecentric.de/en/" class="active">Blog</a></li><li><a href="https://www.codecentric.de/aktuelles/" class="">News</a></li><li><a href="https://www.codecentric.de/ueber-uns/" class="">About us</a></li><li class="searchform-wrap"> <span class="searchform"></span></li><li class="last"> <a href="https://blog.codecentric.de/2011/07/nutzliche-jvm-flags-teil-4/" class="lang">de</a></li></ul></div></div></div></div></div></div><div class="header-bottom"><div class="container"><div class="row"><div class="col-md-12"><div class="title"><a href="https://blog.codecentric.de/">codecentric Blog</a></div><h1 class="homepage"> IT Knowledge from developers for developers</h1><div class="counterWrap"><div class="counterWrapInner"><p> <span class="counter" data-count="1407">0</span><br/> Posts</p></div></div></div></div></div></div></header><header class="visible-xs"><div class="header-search header-search-mobil"><div class="row"><form class="search" method="get" action="https://blog.codecentric.de/en" role="search"> <input class="search-input col-md-10" type="search" name="s" placeholder="To search, type and hit enter."><div class="col-md-2 pull-right text-right"> <input type="image" src="/wp-content/themes/codecentric2015/img/suche_lupe.png" alt="To search, type and hit enter."/> <span class="searchform-close"></span></div><input type='hidden' name='lang' value='en' /></form></div></div><div class="header-top header-top-mobil"><div class="container"><div class="row"><div class="col-xs-2"><div class="trigger-menu trigger-menu-mobil"> <span></span></div></div><div class="col-xs-8 text-center"> <img src="https://blog.codecentric.de/wp-content/themes/codecentric2015/images/codecentric-logo.png" class="logo img-responsive" alt="codecentric"></div><div class="col-xs-2 text-right"><span class="search-trigger-mobil"> <img src="/wp-content/themes/codecentric2015/img/suche_lupe.png" alt="codecentric"/> </span></div></div></div></div><div class="header-bottom"><div class="container"><div class="row"><div class="col-md-12"><div class="title"><a href="https://blog.codecentric.de/">codecentric Blog</a></div></div></div></div></div></header><nav class="category-nav"><div class="container"><div class="row"><div class="col-md-12"><ul id="menu-category-navigation-en" class="list-inline list-unstyled"><li id="menu-item-28513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-28513"><a href="/en/">New</a></li><li id="menu-item-28518" class="agile menu-item menu-item-type-taxonomy menu-item-object-category menu-item-28518"><a href="https://blog.codecentric.de/en/category/agile-en/">Agile</a></li><li id="menu-item-28519" class="architektur menu-item menu-item-type-taxonomy menu-item-object-category menu-item-28519"><a href="https://blog.codecentric.de/en/category/architecture/">Architecture</a></li><li id="menu-item-28520" class="java menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-28520"><a href="https://blog.codecentric.de/en/category/java-en/">Java</a></li><li id="menu-item-28521" class="performance menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-28521"><a href="https://blog.codecentric.de/en/category/performance-en/">Performance</a></li><li id="menu-item-28522" class="continuous-delivery menu-item menu-item-type-taxonomy menu-item-object-category menu-item-28522"><a href="https://blog.codecentric.de/en/category/continuous-delivery-agile-en/">Continuous Delivery</a></li><li id="menu-item-28523" class="microservices menu-item menu-item-type-taxonomy menu-item-object-category menu-item-28523"><a href="https://blog.codecentric.de/en/category/architecture/microservices-architecture/">Microservices</a></li><li id="menu-item-28524" class="cloud menu-item menu-item-type-taxonomy menu-item-object-category menu-item-28524"><a href="https://blog.codecentric.de/en/category/architecture/cloud-architecture/">Cloud</a></li></ul><div class="close-category-nav"></div><div class="open-category-nav"></div><div class="rssLink"><a href="" class="hidden-xs"><i class="fa fa-rss" aria-hidden="true"></i> RSS-Feed</a></div></div></div></div></nav><main role="main"><section class="article-single-item"><div class="container"><div class="row"><div class="col-lg-3 col-md-2"> <a href="https://blog.codecentric.de/en/category/java-en/" title="Java" class="back">Overview</a><div class="banner hidden-sm hidden-xs"><div id="instanaBanner"> <span class="hs-cta-wrapper" id="hs-cta-wrapper-cab37222-7327-4b41-8534-bd8c4154b2d1"> <span class="hs-cta-node hs-cta-cab37222-7327-4b41-8534-bd8c4154b2d1" id="hs-cta-cab37222-7327-4b41-8534-bd8c4154b2d1"> <!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]--> <a href="http://cta-redirect.hubspot.com/cta/redirect/1918859/cab37222-7327-4b41-8534-bd8c4154b2d1" target="_blank" ><img class="hs-cta-img img-responsive" id="hs-cta-img-cab37222-7327-4b41-8534-bd8c4154b2d1" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/1918859/cab37222-7327-4b41-8534-bd8c4154b2d1.png" alt="The instana robot complete"/></a> </span> <script charset="utf-8" src="https://js.hscta.net/cta/current.js"></script> <script type="text/javascript">hbspt.cta.load(1918859, 'cab37222-7327-4b41-8534-bd8c4154b2d1', {});</script> </span></div></div></div><div class="col-lg-6 col-md-8"><article id="post-14726" class="post-14726 post type-post status-publish format-standard hentry category-java-en category-performance-en"><h1> <a href="https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/" title="Useful JVM Flags &#8211; Part 4 (Heap Tuning)">Useful JVM Flags &#8211; Part 4 (Heap Tuning)</a></h1><p class="article-details pull-left"> <span class="post-date">07/29/12</span> <span class="post-author">by <a href="https://blog.codecentric.de/en/author/patrick-peschlow/" title="Posts by Patrick Peschlow" rel="author">Patrick Peschlow</a> </span></p><p class="article-comments pull-right"> <a href="https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/#comments" title="Useful JVM Flags &#8211; Part 4 (Heap Tuning)">4 Comments </a></p><div class="clearfix"></div><p>Ideally, a Java application runs just fine with the default JVM settings so that there is no need to set any flags at all. However, in case of performance problems (which unfortunately arise quite often) some knowledge about relevant JVM flags is a welcome companion. In this part of our series, we will take a look at some JVM flags from the area of memory management. Knowing and understanding these flags will prove highly useful for developers and operations staff alike.</p><p><span id="more-14726"></span>All established HotSpot memory management and garbage collection algorithms are based on the same basic partitioning of the heap: The &#8220;young generation&#8221; contains newly allocated and short-lived objects while the &#8220;old generation&#8221; contains long-lived objects beyond a certain age. In addition to that, the &#8220;permanent generation&#8221; contains objects expected to live throughout the whole JVM lifecycle, e.g., the object representations of loaded classes or the String intern cache. For the following discussion, we assume that the heap is partitioned according to this classic strategy of young, old, and permanent generations. However, note that other strategies are also promising, one prominent example being the new G1 garbage collector, which blurs the distinction between the young and old generations. Also, current developments seem to indicate that some future version of the HotSpot JVM will not have the separation between the old and permanent generations anymore.</p><p><strong>-Xms and -Xmx (or: -XX:InitialHeapSize and -XX:MaxHeapSize)</strong></p><p>Arguably the most popular JVM flags at all are <code>-Xms</code> and <code>-Xmx</code>, which allow us to specify the initial and maximum JVM heap size, respectively. Both flags expect a value in bytes but also support a shorthand notation where &#8220;k&#8221; or &#8220;K&#8221; represent &#8220;kilo&#8221;, &#8220;m&#8221; or &#8220;M&#8221; represent &#8220;mega&#8221;, and &#8220;g&#8221; or &#8220;G&#8221; represent &#8220;giga&#8221;. For example, the following command line starts the Java class &#8220;MyApp&#8221; setting an initial heap size of 128 megabytes and a maximum heap size of 2 gigabytes:</p><div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666;">$ </span><span style="color: #c20cb9; font-weight: bold;">java</span> <span style="color: #660033;">-Xms128m</span> <span style="color: #660033;">-Xmx2g</span> MyApp</pre></td></tr></table><p class="theCode" style="display:none;">$ java -Xms128m -Xmx2g MyApp</p></div><p>Note that, in practice, the initial heap size turns out to also be a lower bound for the heap size, i.e., a minimum heap size. While it is true that the JVM may dynamically resize the heap at run time, and thus in theory we might observe the heap size fall below its initial size, I never witnessed such a case in practice even with very low heap utilization. This behavior is convenient for developers and operations because, if desired, it allows them to specify a static heap size simply by setting <code>-Xms</code> and <code>-Xmx</code> to the same value.</p><p>It is useful to know that both <code>-Xms</code> and <code>-Xmx</code> are only shortcuts which are internally mapped to <code>-XX:InitialHeapSize</code> and <code>-XX:MaxHeapSize</code>. These two XX flags may also be used directly, to the same effect:</p><div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666;">$ </span><span style="color: #c20cb9; font-weight: bold;">java</span> -XX:<span style="color: #007800;">InitialHeapSize</span>=128m -XX:<span style="color: #007800;">MaxHeapSize</span>=2g MyApp</pre></td></tr></table><p class="theCode" style="display:none;">$ java -XX:InitialHeapSize=128m -XX:MaxHeapSize=2g MyApp</p></div><p>Note that all JVM output regarding initial and maximum heap size uses the long names exclusively. Thus, when looking for information about the heap size of a running JVM, e.g., by checking the output of <code>-XX:+PrintCommandLineFlags</code> or by querying the JVM via JMX, we should look for &#8220;InitialHeapSize&#8221; or &#8220;MaxHeapSize&#8221; and not for &#8220;Xms&#8221; or &#8220;Xmx&#8221;.</p><p><strong>-XX:+HeapDumpOnOutOfMemoryError and -XX:HeapDumpPath</strong></p><p>If we refrain from setting <code>-Xmx</code> to an adequate value, we run the risk of being hit by an OutOfMemoryError, one of the most dreadful beasts that we may face when dealing with the JVM. As detailed in our <a href="http://blog.codecentric.de/en/2011/03/java-memory-configuration-and-monitoring-3rd-act/" title="Java Memory Configuration and Monitoring (3rd Act)">blog series</a> on this subject, the root cause of an OutOfMemoryError needs to be diagnosed carefully. Often, a good start for a deep analysis is a heap dump &#8211; too bad if none is available, in particular if the JVM has already crashed and the error did only appear on a production system after the application ran smoothly for several hours or days.</p><p>Luckily, there is a way to tell the JVM to generate a heap dump automatically when an OutOfMemoryError occurs, by setting the flag <code>-XX:+HeapDumpOnOutOfMemoryError</code>. Having this flag set &#8220;just in case&#8221; can save a lot of time when facing an unexpected OutOfMemoryError. By default, the heap dump is stored in a file <code>java_pid&lt;pid&gt;.hprof</code> in the directory where the JVM was started (here, <code>&lt;pid&gt;</code> is the process ID of the JVM process). To change the default, we may specify a different location using the flag <code>-XX:HeapDumpPath=&lt;path&gt;</code>, with <code>&lt;path&gt;</code> being a relative or absolute path to the file where to store the heap dump.</p><p>While all this sounds pretty nice, there is one caveat that we need to keep in mind. A heap dump can get large, and especially so when an OutOfMemoryError arises. Thus, it is recommended to always set a custom location using <code>-XX:HeapDumpPath</code>, and to choose a place with enough disk space available.</p><p><strong>-XX:OnOutOfMemoryError</strong></p><p>We can even execute an arbitrary sequence of commands when an OutOfMemoryError happens, e.g., to send an e-mail to an admin or to perform some cleanup job. This is made possible by the flag <code>-XX:OnOutOfMemoryError</code>, which expects a list of commands and, if applicable, their parameters. We will not go into the details here but just show an example configuration. With the following command line, should an OutOfMemoryError occur, we will write a heap dump to the file <code>/tmp/heapdump.hprof</code> and execute the shell script <code>cleanup.sh</code> in home directory of the user running the JVM.</p><div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666;">$ </span><span style="color: #c20cb9; font-weight: bold;">java</span> -XX:+HeapDumpOnOutOfMemoryError -XX:<span style="color: #007800;">HeapDumpPath</span>=<span style="color: #000000; font-weight: bold;">/</span>tmp<span style="color: #000000; font-weight: bold;">/</span>heapdump.hprof -XX:OnOutOfMemoryError =<span style="color: #ff0000;">&quot;sh ~/cleanup.sh&quot;</span> MyApp</pre></td></tr></table><p class="theCode" style="display:none;">$ java -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/tmp/heapdump.hprof -XX:OnOutOfMemoryError =&quot;sh ~/cleanup.sh&quot; MyApp</p></div><p><strong>-XX:PermSize and -XX:MaxPermSize</strong></p><p>The permanent generation is a separate heap area which contains, among others, the object representations of all classes loaded by the JVM. To successfully run applications that load lots of classes (e.g., because they depend on lots of third-party libraries, which in turn depend on and load classes from even more libraries) it may be necessary to increase the size of the permanent generation. This can be done using the flags <code>-XX:PermSize</code> and <code>-XX:MaxPermSize</code>. Here, <code>-XX:MaxPermSize</code> sets the maximum size of the permanent generation while <code>-XX:PermSize</code> sets its initial size on JVM startup. A quick example:</p><div class="wp_syntax" style="position:relative;"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666;">$ </span><span style="color: #c20cb9; font-weight: bold;">java</span> -XX:<span style="color: #007800;">PermSize</span>=128m -XX:<span style="color: #007800;">MaxPermSize</span>=256m MyApp</pre></td></tr></table><p class="theCode" style="display:none;">$ java -XX:PermSize=128m -XX:MaxPermSize=256m MyApp</p></div><p>Note that the permanent generation size is not counted as part of the heap size as specified by <code>-XX:MaxHeapSize</code>. That is, the amount of permanent generation memory specified by <code>-XX:MaxPermSize</code> may be required in addition to the heap memory specified by <code>-XX:MaxHeapSize</code>.</p><p><strong>-XX:InitialCodeCacheSize and -XX:ReservedCodeCacheSize</strong></p><p>An interesting but often neglected memory area of the JVM is the &#8220;code cache&#8221;, which is used to store the native code generated for compiled methods. The code cache does rarely cause performance problems, but once we have a code cache problem its effects may be devastating. If the code cache is fully utilized, the JVM prints a warning message and then switches to interpreted-only mode: The JIT compiler gets deactivated and no bytecode will be compiled into native code anymore. Thus, the application will continue to run, but slower by an order of magnitude, until someone notices.</p><p>Like with the other memory areas, we may specify the size of the code cache ourselves. The relevant flags are <code>-XX:InitialCodeCacheSize</code> and <code>-XX:ReservedCodeCacheSize</code>, and they expect byte values just like the flags introduced above.</p><p><strong>-XX:+UseCodeCacheFlushing</strong></p><p>If the code cache grows constantly, e.g., because of a memory leak caused by hot deployments, increasing the code cache size will only delay its inevitable overflow. To avoid overflow, we can try an interesting and relatively new option: to let the JVM dispose some of the compiled code when the code cache fills up. This may be done by specifying the flag <code>-XX:+UseCodeCacheFlushing</code>. Using this flag, we can at least avoid the switch to interpreted-only mode when we face code cache problems. However, I would still recommend to tackle the root cause as soon as possible once a code cache problem has manifested itself, i.e., identify the memory leak and fix it.</p></article></div><div class="col-lg-3 col-md-2 pull-right"> <span class="next-posts"> <a href="https://blog.codecentric.de/en/2012/08/javascript-shell-your-jdk-contains-everything-for-ad-hoc-programming/" rel="next">JavaScript Shell Your JDK Contains Everything for ad hoc Programming</a> </span><div class="banner hidden-sm hidden-xs"></div></div></div></div><div class="article-single-author"><div class="container"><div class="row"><div class="col-lg-3 col-md-2"><h2><a href="https://blog.codecentric.de/en/author/patrick-peschlow/" title="Posts by Patrick Peschlow" rel="author">Patrick Peschlow</a></h2></div><div class="col-lg-6 col-md-8"><div class="row"><div class="col-md-2 col-xs-3 col-sm-3"> <img src="https://blog.codecentric.de/files/2015/10/patrick_peschlow-250x250.jpg" width="200" height="200" alt="Patrick Peschlow" class="avatar avatar-200 wp-user-avatar wp-user-avatar-200 alignnone photo" /></div><div class="col-md-10 col-xs-9 col-sm-9"></div></div></div></div><div class="row"><div class="col-md-6 col-md-offset-3"><div class="ssba ssba-wrap"><div style="text-align:left"><a data-site="" class="ssba_facebook_share" href="http://www.facebook.com/sharer.php?u=https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/" target="_blank" ><img src="/wp-content/themes/codecentric2015/img/icon-facebook.png" title="Facebook" class="ssba ssba-img" alt="Share on Facebook" /></a><a data-site="" class="ssba_google_share" href="https://plus.google.com/share?url=https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/" target="_blank" ><img src="/wp-content/themes/codecentric2015/img/icon-google.png" title="Share on Google+" class="ssba ssba-img" alt="Google+" /></a><a data-site="linkedin" class="ssba_linkedin_share ssba_share_link" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/" target="_blank" ><img src="/wp-content/themes/codecentric2015/img/icon-linkedin.png" alt="Share on LinkedIn" title="LinkedIn" class="ssba ssba-img" /></a><a data-site="" class="ssba_twitter_share" href="http://twitter.com/share?url=https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/&amp;text=Useful+JVM+Flags+%E2%80%93+Part+4+%28Heap+Tuning%29+%23codecentric" target="_blank" ><img src="/wp-content/themes/codecentric2015/img/icon-twitter.png" title="Twitter" class="ssba ssba-img" alt="Tweet about this on Twitter" /></a><a data-site="reddit" class="ssba_reddit_share" href="http://reddit.com/submit?url=https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/&amp;title=Useful JVM Flags &#8211; Part 4 (Heap Tuning)" target="_blank" ><img src="/wp-content/themes/codecentric2015/img/icon-reddit.png" title="Reddit" class="ssba ssba-img" alt="Share on Reddit" /></a><a data-site="digg" class="ssba_diggit_share ssba_share_link" href="http://www.digg.com/submit?url=https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/" target="_blank" ><img src="/wp-content/themes/codecentric2015/img/icon-digg.png" title="Digg" class="ssba ssba-img" alt="Digg this" /></a><a data-site="stumbleupon" class="ssba_stumbleupon_share ssba_share_link" href="http://www.stumbleupon.com/submit?url=https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/&#038;title=Useful%20JVM%20Flags%20&#8211;%20Part%204%20(Heap%20Tuning)" target="_blank" ><img src="/wp-content/themes/codecentric2015/img/icon-stumple.png" alt="Share on StumbleUpon" title="StumbleUpon" class="ssba ssba-img" /></a></div></div></div></div></div></div><div class="container"><div class="row article-single-links"><div class="col-md-5 col-md-5"><h2>Post by <strong>Patrick Peschlow</strong></h2><div class="author-post-item"><p><a href="https://blog.codecentric.de/2015/04/elasticon-erste-elasticsearch-user-konferenz-in-san-francisco/">Elastic{ON}: Erste Elasticsearch-User-Konferenz in San Francisco</a></p></div><div class="author-post-item"><span class="cat-name">Search</span><p><a href="https://blog.codecentric.de/en/2015/03/scaling-elasticsearch-index-introduction/">Scaling an Elasticsearch Index &#8211; Introduction</a></p></div></div><div class="col-md-7 col-md-5"><div class="row"><div class="col-md-12"><h2>More content about <strong>Java</strong></h2><div class="row"><div class="col-md-8"><div class="related-post-item"> <span class="cat-name">Java</span><p> <a href="https://blog.codecentric.de/en/2017/08/parsing-of-localdate-query-parameters-in-spring-boot/">Parsing of LocalDate query parameters in Spring Boot</a></p></div><div class="related-post-item"> <span class="cat-name">Java</span><p> <a href="https://blog.codecentric.de/en/2017/08/defence-autistic-tools/">In defence of pedantic tools</a></p></div></div></div></div></div></div></div></div><a id="comments"></a><div class="container article-single-comments"><div class="row"><div class="col-md-3"><h2>Kommentare</h2></div><div class="col-md-6"><ul class="list-unstyled"><li class="comment even thread-even depth-1 parent" id="comment-75151"><div id="div-comment-75151" class="comment-body row"><div class="comment-author vcard col-md-2"> <img src="https://secure.gravatar.com/avatar/a5a8775c40e2105471250cc46d7c2701?s=96&d=mm&r=g" alt="numan"/></div><div class="comment-text col-md-10"><p class="comment-info"> <a href="https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/#comment-75151"> 30. July 2012</a> von numan</p></div><div class="col-md-10 col-md-offset-2"><p>Very clear and to the point article. Thanks!</p><div class="reply"> <a rel='nofollow' class='comment-reply-link' href='https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/?replytocom=75151#respond' onclick='return addComment.moveForm( "div-comment-75151", "75151", "respond", "14726" )' aria-label='Reply to numan'>Reply</a></div></div></div><ul class="children"><li class="comment odd alt depth-2 parent" id="comment-136456"><div id="div-comment-136456" class="comment-body row"><div class="comment-author vcard col-md-2"> <img src="https://secure.gravatar.com/avatar/6f3d362bcb98d71ed209f32f92b1d132?s=96&d=mm&r=g" alt="Sandeep"/></div><div class="comment-text col-md-10"><p class="comment-info"> <a href="https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/#comment-136456"> 19. November 2012</a> von <a href='http://yadav-sandeep.blogspot.com' rel='external nofollow' class='url'>Sandeep</a></p></div><div class="col-md-10 col-md-offset-2"><p>Can we use -XX:+UseCodeCacheFlushing in JDK 5.</p><div class="reply"> <a rel='nofollow' class='comment-reply-link' href='https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/?replytocom=136456#respond' onclick='return addComment.moveForm( "div-comment-136456", "136456", "respond", "14726" )' aria-label='Reply to Sandeep'>Reply</a></div></div></div><ul class="children"><li class="comment byuser comment-author-patrick-peschlow bypostauthor even depth-3" id="comment-136775"><div id="div-comment-136775" class="comment-body row"><div class="comment-author vcard col-md-2"> <img src="https://blog.codecentric.de/files/2015/10/patrick_peschlow-120x120.jpg" alt="Patrick Peschlow"/></div><div class="comment-text col-md-10"><p class="comment-info"> <a href="https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/#comment-136775"> 19. November 2012</a> von <a href='http://blog.codecentric.de' rel='external nofollow' class='url'>Patrick Peschlow</a></p></div><div class="col-md-10 col-md-offset-2"><p>I&#8217;m afraid this flag is not available in Java 5. If I remember correctly, it was introduced in some Java 6 update and not backported.</p><div class="reply"> <a rel='nofollow' class='comment-reply-link' href='https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/?replytocom=136775#respond' onclick='return addComment.moveForm( "div-comment-136775", "136775", "respond", "14726" )' aria-label='Reply to Patrick Peschlow'>Reply</a></div></div></div></li></ul></li></ul></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-161869"><div id="div-comment-161869" class="comment-body row"><div class="comment-author vcard col-md-2"> <img src="https://secure.gravatar.com/avatar/8af60e03862bd504ae5b57b25e021506?s=96&d=mm&r=g" alt="Ted Choi"/></div><div class="comment-text col-md-10"><p class="comment-info"> <a href="https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/#comment-161869"> 8. March 2013</a> von Ted Choi</p></div><div class="col-md-10 col-md-offset-2"><p>Thank you, this article helped me ALOT!!</p><div class="reply"> <a rel='nofollow' class='comment-reply-link' href='https://blog.codecentric.de/en/2012/07/useful-jvm-flags-part-4-heap-tuning/?replytocom=161869#respond' onclick='return addComment.moveForm( "div-comment-161869", "161869", "respond", "14726" )' aria-label='Reply to Ted Choi'>Reply</a></div></div></div></li></ul></div></div><div class="row"><div class="col-md-3"><h2>Comment</h2></div><div class="col-md-7"><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/en/2012/07/useful-jvm-flags-part-4-heap-tuning/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://blog.codecentric.de/wp-comments-post.php" method="post" id="commentform" class="comment-form form-horizontal"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><div class="form-group"><div class="col-md-12"><textarea autocomplete="nope"  placeholder="Nachricht" id="340af72564"  name="8c901de1fe"  class="form-control"  cols="45" rows="8" aria-required="true"></textarea><textarea id="comment" aria-hidden="true" name="comment" autocomplete="nope" style="clip:rect(1px, 1px, 1px, 1px);position:absolute !important;white-space:nowrap;height:1px;width:1px;overflow:hidden;" tabindex="-1"></textarea><script type="text/javascript">document.getElementById("comment").setAttribute( "id", "ca9145c2b31aa99addb90ce3bdb4d35e" );document.getElementById("340af72564").setAttribute( "id", "comment" );</script></div></div><div class="form-group"><div class="col-md-6"><input id="author" class="form-control" placeholder="Name" name="author" type="text" value="" size="30" /></div><div class="col-md-6"><input placeholder="E-Mail" id="email" name="email" class="form-control" type="text" value="" size="30" /></div></div><p class="form-submit"><input name="submit" type="submit" id="submit" class="btn btn-default pull-right" value="Submit" /> <input type='hidden' name='comment_post_ID' value='14726' id='comment_post_ID' /> <input type='hidden' name='comment_parent' id='comment_parent' value='0' /></p><p class="subscribe-to-doi-comments"> <label for="subscribe"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" /> Notify me of followup comments via e-mail</label></p></form></div></div></div></div></section></main><footer class="footer" role="contentinfo"><div class="container"><div class="row footer-sitemap"><div class="col-md-4 col-sm-12"><h3> Newsletter</h3><form action="https://www.codecentric.de/formulare/newsletter/" class="form-inline" target="_blank" method="post"><div class="form-group"><div class="row"><div class="col-xs-12"> <input type="email" class="form-control" name="email" placeholder="E-Mail Adresse"/><input type="submit" value="Submit" class=" form-control btn btn-default"/></div></div></div></form></div></div><div class="row"><div class="visible-xs col-xs-12"><ul class="list-inline list-unstyled icons-footer"><li class="first"> <a href="https://www.facebook.com/codecentric" target="_blank"> <img src="/wp-content/themes/codecentric2015/img/facebook.gif" alt="codecentric - Facebook"/> </a></li><li class="last"> <a href="https://twitter.com/codecentric" target="_blank"> <img src="/wp-content/themes/codecentric2015/img/twitter.gif" alt="codecentric - Twitter"/> </a></li></ul></div><div class="col-xs-12 col-sm-10"><ul class="list-inline list-unstyled footer-metanav"><li><a href="https://www.codecentric.de/impressum-datenschutz/" target="_blank" class="">Imprint</a></li><li><a href="https://www.codecentric.de/terms-and-conditions/" target="_blank" class="">Privacy Policy</a></li><li><a href="https://www.codecentric.de/ueber-codecentric/kontakt/" target="_blank" class="">Contact</a></li></ul></div><div class="hidden-xs col-sm-2 pull-right"><ul class="list-inline list-unstyled pull-right icons-footer"><li class="first"> <a href="https://www.facebook.com/codecentric" target="_blank"> <img src="/wp-content/themes/codecentric2015/img/facebook.gif" alt="codecentric - Facebook"/> </a></li><li class="last"> <a href="https://twitter.com/codecentric" target="_blank"> <img src="/wp-content/themes/codecentric2015/img/twitter.gif" alt="codecentric - Twitter"/> </a></li></ul></div></div></div></footer><div class="searchform-overlay"></div><div class="mobile-navi-overlay"></div><div class="mobile-navi"><div class="container"><div class="row"><div class="col-xs-12"><div class="trigger-menu trigger-menu-mobil-active"> <span>X</span></div><ul class="list-unstyled"><li><a href="https://www.codecentric.de/leistungen/" class="">Services</a></li><li><a href="https://www.codecentric.de/karriere/" class="">Career</a></li><li><a href="https://www.codecentric.de/wissen/" class="">Knowledge</a></li><li><a href="https://blog.codecentric.de/en/" class="active">Blog</a></li><li><a href="https://www.codecentric.de/aktuelles/" class="">News</a></li><li><a href="https://www.codecentric.de/ueber-uns/" class="">About us</a></li><li><a href="https://blog.codecentric.de/2011/07/nutzliche-jvm-flags-teil-4/" class="lang">Deutsch</a></li></ul></div></div></div></div> <script type='text/javascript'>var icl_vars = {"current_language":"en","icl_home":"https:\/\/blog.codecentric.de\/en\/"};</script> <script>(function(h,o,t,j,a,r){ h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)}; h._hjSettings={hjid:325170,hjsv:5}; a=o.getElementsByTagName('head')[0]; r=o.createElement('script');r.async=1; r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv; a.appendChild(r); })(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');</script> <script type="text/javascript">(function(d,s,i,r) { if (d.getElementById(i)){return;} var n=d.createElement(s),e=d.getElementsByTagName(s)[0]; n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/1918859.js'; e.parentNode.insertBefore(n, e); })(document,"script","hs-analytics",300000);</script> <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/1918859.js"></script> <script type="application/ld+json">{ "@context" : "http://schema.org", "@type": "LocalBusiness", "geo":{ "@type":"GeoCoordinates", "latitude":51.162073, "longitude":-7.007063 }, "address" : { "addressLocality": "Solingen", "addressRegion": "NRW", "postalCode": "42697", "streetAddress": "Hochstra√üe 11" }, "name":"codecentric AG", "url":"https://www.codecentric.de/", "email":"info@codecentric.de", "telephone":"+4902122336280", "image":"https://blog.codecentric.de/wp-content/themes/codecentric2015/img/codecentric-logo.png" }</script> <script type="text/javascript" defer src="https://blog.codecentric.de/wp-content/cache/autoptimize/2/autoptimize_e2f30fc27c1231b8c228cc68eac4af9b.php"></script></body></html>

<!--
Cachify | http://cachify.de
Ohne Plugin: 126 DB-Anfragen, 0.36 Sekunden, 16.64 MB
Mit Plugin: 52 DB-Anfragen, 0.18 Sekunden, 13.86 MB
Generiert: 2 hours zuvor
-->