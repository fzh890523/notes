<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta name="robots" content="nofollow" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<link rel="search" type="application/opensearchdescription+xml" href="https://www.freebsd.org/search/opensearch/man.xml" title="FreeBSD Manpages" />
<link rel="search" type="application/opensearchdescription+xml" href="https://www.freebsd.org/search/opensearch/man-freebsd-release-ports.xml" title="FreeBSD + Ports Manpages" />
<style type="text/css">
<!--
b { color: #996600; }
i { color: #008000; }
-->
span.footer_links { font-size: small; }
span.space { font-size: xx-small; }
form#man > input, form#man > button { font-size: large; }
form#man > input[name='query'] { text-align: center; }

@media only screen and (max-height: 640px), (max-width: 760px) {
div#header, div#menu { display: none !important; }
div#content { padding-top: 4.9em; }
form#man > input, button { font-size: 200%; }
form#man > button { font-size: 200%; }
form#man > input[name='query'] { width: 12em; }
form#man > select { font-size: 140%; }
span.spaces { display: none; }
}
</style>
<title>pf.conf(5)</title>
<meta http-equiv='content-type' content='text/html; charset=iso-8859-1' />
<meta name='robots' content='nofollow' />
    <link rel="stylesheet" media="screen"
    href="../layout/css/fixed.css" type="text/css"
    title="Normal Text" />
    <link rel="alternate stylesheet" media="screen"
    href="../layout/css/fixed_large.css" type="text/css"
    title="Large Text" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/favicon.ico" type="image/x-icon" />

<script type="text/javascript" src="../layout/js/google.js">
</script>

</head>
<body>

    <div id="containerwrap">
      <div id="container">
        <span class="txtoffscreen"><a href="#content"
        title="Skip site navigation" accesskey="1">Skip site
        navigation</a> (1)</span><span class="txtoffscreen"><a
        href="#content" title="Skip section navigation"
        accesskey="2">Skip section navigation</a> (2)</span>

        <div id="headercontainer">
          <div id="header">
            <h2 class="blockhide">Header And Logo</h2>

            <div id="headerlogoleft">
              <a href=".." title="FreeBSD"><img
              src="../layout/images/logo-red.png" width="457"
              height="75" alt="FreeBSD" /></a>
            </div>

            <div id="headerlogoright">
              <h2 class="blockhide">Peripheral Links</h2>

	      <div class="frontdonateroundbox">
		<div class="frontdonatetop">
		  <div>
		    <b style="display: none;">.</b>
		  </div>
		</div>
		<div class="frontdonatecontent">
		  <a href="https://www.FreeBSDFoundation.org/donate/">Donate to FreeBSD</a>
		</div>
		<div class="frontdonatebot">
		  <div>
		    <b style="display: none;">.</b>
		  </div>
		</div>
	      </div>

              <div id="search">
		<form method="get" id="search" action="https://duckduckgo.com/">
		  <h2 class="blockhide"><label for="words">Search</label></h2>
		  <input type="hidden" name="sites" value="www.FreeBSD.org,docs.FreeBSD.org,lists.FreeBSD.org,wiki.FreeBSD.org,forums.FreeBSD.org" />
		  <input type="hidden" name="ka" value="v" />
		  <input type="hidden" name="kt" value="v" />
		  <input type="hidden" name="kh" value="1" />
		  <input type="hidden" name="kj" value="r2" />
		  <input id="words" name="q" type="text" size="20"
                    autocapitalize="none"
		    maxlength="255"
		    onfocus="if( this.value==this.defaultValue ) this.value='';"
		    value="Search" />
		  <span>&nbsp;</span>
		  <input id="submit" name="submit" type="submit" value="Search" />
		</form>
              </div>
            </div>
          </div>

          <h2 class="blockhide">Site Navigation</h2>

	  <div id="menu">
	    <ul class="first">
	      <li><a href="../">Home</a></li>
	    </ul>
	    <ul>
	      <li><a href="../about.html">About</a>
		<ul>
		  <li><a href="../projects/newbies.html">Introduction</a></li>
		  <li><a href="../features.html">Features</a></li>
		  <li><a href="../advocacy/">Advocacy</a></li>
		  <li><a href="../marketing/">Marketing</a></li>
		</ul>
	      </li>
	    </ul>
	    <ul>
	      <li><a href="../where.html">Get FreeBSD</a>
		<ul>
		  <li><a href="../releases/">Release Information</a></li>
		  <li><a href="../releng/">Release Engineering</a></li>
		</ul>
	      </li>
	    </ul>
	    <ul>
	      <li><a href="../docs.html">Documentation</a>
		<ul>
		  <li><a href="../doc/en_US.ISO8859-1/books/faq/">FAQ</a></li>
		  <li><a href="../doc/en_US.ISO8859-1/books/handbook/">Handbook</a></li>
		  <li><a href="../doc/en_US.ISO8859-1/books/porters-handbook">Porter's Handbook</a></li>
		  <li><a href="../doc/en_US.ISO8859-1/books/developers-handbook">Developer's Handbook</a></li>
		  <li><a href="../cgi/man.cgi">Manual Pages</a></li>
		  <li><a href="../doc/en_US.ISO8859-1/books/fdp-primer">Documentation Project Primer</a></li>
		  <li><a href="../docs/books.html">All Books and Articles</a></li>
		</ul>
	      </li>
	    </ul>
	    <ul>
	      <li><a href="../community.html">Community</a>
		<ul>
		  <li><a href="../community/mailinglists.html">Mailing Lists</a></li>
		  <li><a href="https://forums.FreeBSD.org">Forums</a></li>
		  <li><a href="../usergroups.html">User Groups</a></li>
		  <li><a href="../events/events.html">Events</a></li>
		</ul>
	      </li>
	    </ul>
	    <ul>
	      <li><a href="../projects/index.html">Developers</a>
		<ul>
		  <li><a href="../projects/ideas/ideas.html">Project Ideas</a></li>
		  <li><a href="//svnweb.FreeBSD.org">SVN Repository</a></li>
		</ul>
	      </li>
	    </ul>
	    <ul>
	      <li><a href="../support.html">Support</a>
		<ul>
		  <li><a href="../commercial/commercial.html">Vendors</a></li>
		  <li><a href="//security.FreeBSD.org/">Security Information</a></li>
		  <li><a href="https://bugs.freebsd.org/search/">Bug Reports</a></li>
		  <li><a href="../support.html">Submit Bug-report</a></li>
		</ul>
	      </li>
	    </ul>
	    <ul>
	      <li><a href="//www.freebsdfoundation.org/">Foundation</a>
		<ul>
		  <li><a href="//www.freebsdfoundation.org/donate/">Donate</a></li>
		</ul>
	      </li>
	    </ul>
	  </div> <!-- MENU -->
        </div>

	<div id="content">

<h1>FreeBSD Manual Pages</h1>

<form id="man" method="get" action="/cgi/man.cgi">
<!-- Manual Page or Keyword Search: -->
<span class="spaces">&nbsp;&nbsp;</span>
<input type="text" id="query" value="pf.conf" name="query" size="36" autocapitalize="none"  />
<button type="submit" name="apropos" value="0">man</button>
<button type="submit" name="apropos" value="1">apropos</button>
<br/>
<span class="space">&nbsp;</span><br/>
<span class="spaces">&nbsp;&nbsp;</span>
<select name="sektion">
<option value="0">All Sections</option>
<option value="1">1 - General Commands</option>
<option value="2">2 - System Calls</option>
<option value="3">3 - Subroutines</option>
<option value="4">4 - Special Files</option>
<option selected="selected" value="5">5 - File Formats</option>
<option value="6">6 - Games</option>
<option value="7">7 - Macros and Conventions</option>
<option value="8">8 - Maintenance Commands</option>
<option value="9">9 - Kernel Interface</option>
<option value="n">n - New Commands</option>
</select>
<select name="manpath">
<option value="2.8 BSD">2.8 BSD</option>
<option value="2.9.1 BSD">2.9.1 BSD</option>
<option value="2.10 BSD">2.10 BSD</option>
<option value="2.11 BSD">2.11 BSD</option>
<option value="4.3BSD NET/2">4.3BSD NET/2</option>
<option value="4.3BSD Reno">4.3BSD Reno</option>
<option value="4.4BSD Lite2">4.4BSD Lite2</option>
<option value="386BSD 0.0">386BSD 0.0</option>
<option value="386BSD 0.1">386BSD 0.1</option>
<option value="CentOS 5.6">CentOS 5.6</option>
<option value="CentOS 5.7">CentOS 5.7</option>
<option value="CentOS 5.8">CentOS 5.8</option>
<option value="CentOS 5.9">CentOS 5.9</option>
<option value="CentOS 5.10">CentOS 5.10</option>
<option value="CentOS 5.11">CentOS 5.11</option>
<option value="CentOS 6.0">CentOS 6.0</option>
<option value="CentOS 6.1">CentOS 6.1</option>
<option value="CentOS 6.2">CentOS 6.2</option>
<option value="CentOS 6.3">CentOS 6.3</option>
<option value="CentOS 6.4">CentOS 6.4</option>
<option value="CentOS 6.5">CentOS 6.5</option>
<option value="CentOS 6.6">CentOS 6.6</option>
<option value="CentOS 7.0">CentOS 7.0</option>
<option value="CentOS 7.1">CentOS 7.1</option>
<option value="CentOS Linux/i386 3.9">CentOS Linux/i386 3.9</option>
<option value="CentOS Linux/i386 4.8">CentOS Linux/i386 4.8</option>
<option value="CentOS Linux/i386 5.4">CentOS Linux/i386 5.4</option>
<option value="CentOS Linux/i386 5.5">CentOS Linux/i386 5.5</option>
<option value="Darwin 1.3.1/x86">Darwin 1.3.1/x86</option>
<option value="Darwin 1.4.1/x86">Darwin 1.4.1/x86</option>
<option value="Darwin 6.0.2/x86">Darwin 6.0.2/x86</option>
<option value="Darwin 7.0.1">Darwin 7.0.1</option>
<option value="Darwin 8.0.1/ppc">Darwin 8.0.1/ppc</option>
<option value="Debian 2.2.7">Debian 2.2.7</option>
<option value="Debian 3.1.8">Debian 3.1.8</option>
<option value="Debian 4.0.9">Debian 4.0.9</option>
<option value="Debian 5.0.10">Debian 5.0.10</option>
<option value="Debian 6.0.10">Debian 6.0.10</option>
<option value="Debian 7.8.0">Debian 7.8.0</option>
<option value="Debian 8.1.0">Debian 8.1.0</option>
<option value="FreeBSD 1.0-RELEASE">FreeBSD 1.0-RELEASE</option>
<option value="FreeBSD 1.1-RELEASE">FreeBSD 1.1-RELEASE</option>
<option value="FreeBSD 1.1.5.1-RELEASE">FreeBSD 1.1.5.1-RELEASE</option>
<option value="FreeBSD 2.0-RELEASE">FreeBSD 2.0-RELEASE</option>
<option value="FreeBSD 2.0.5-RELEASE">FreeBSD 2.0.5-RELEASE</option>
<option value="FreeBSD 2.1.0-RELEASE">FreeBSD 2.1.0-RELEASE</option>
<option value="FreeBSD 2.1.5-RELEASE">FreeBSD 2.1.5-RELEASE</option>
<option value="FreeBSD 2.1.6.1-RELEASE">FreeBSD 2.1.6.1-RELEASE</option>
<option value="FreeBSD 2.1.7.1-RELEASE">FreeBSD 2.1.7.1-RELEASE</option>
<option value="FreeBSD 2.2.1-RELEASE">FreeBSD 2.2.1-RELEASE</option>
<option value="FreeBSD 2.2.2-RELEASE">FreeBSD 2.2.2-RELEASE</option>
<option value="FreeBSD 2.2.5-RELEASE">FreeBSD 2.2.5-RELEASE</option>
<option value="FreeBSD 2.2.6-RELEASE">FreeBSD 2.2.6-RELEASE</option>
<option value="FreeBSD 2.2.7-RELEASE">FreeBSD 2.2.7-RELEASE</option>
<option value="FreeBSD 2.2.8-RELEASE">FreeBSD 2.2.8-RELEASE</option>
<option value="FreeBSD 2.2.8-RELEASE and Ports">FreeBSD 2.2.8-RELEASE and Ports</option>
<option value="FreeBSD 3.0-RELEASE">FreeBSD 3.0-RELEASE</option>
<option value="FreeBSD 3.1-RELEASE">FreeBSD 3.1-RELEASE</option>
<option value="FreeBSD 3.2-RELEASE">FreeBSD 3.2-RELEASE</option>
<option value="FreeBSD 3.3-RELEASE">FreeBSD 3.3-RELEASE</option>
<option value="FreeBSD 3.4-RELEASE">FreeBSD 3.4-RELEASE</option>
<option value="FreeBSD 3.4-RELEASE and Ports">FreeBSD 3.4-RELEASE and Ports</option>
<option value="FreeBSD 3.5-RELEASE and Ports">FreeBSD 3.5-RELEASE and Ports</option>
<option value="FreeBSD 3.5.1-RELEASE">FreeBSD 3.5.1-RELEASE</option>
<option value="FreeBSD 3.5.1-RELEASE and Ports">FreeBSD 3.5.1-RELEASE and Ports</option>
<option value="FreeBSD 4.0-RELEASE">FreeBSD 4.0-RELEASE</option>
<option value="FreeBSD 4.1-RELEASE">FreeBSD 4.1-RELEASE</option>
<option value="FreeBSD 4.1.1-RELEASE">FreeBSD 4.1.1-RELEASE</option>
<option value="FreeBSD 4.1.1-RELEASE and Ports">FreeBSD 4.1.1-RELEASE and Ports</option>
<option value="FreeBSD 4.2-RELEASE">FreeBSD 4.2-RELEASE</option>
<option value="FreeBSD 4.2-RELEASE and Ports">FreeBSD 4.2-RELEASE and Ports</option>
<option value="FreeBSD 4.3-RELEASE">FreeBSD 4.3-RELEASE</option>
<option value="FreeBSD 4.3-RELEASE and Ports">FreeBSD 4.3-RELEASE and Ports</option>
<option value="FreeBSD 4.4-RELEASE">FreeBSD 4.4-RELEASE</option>
<option value="FreeBSD 4.5-RELEASE">FreeBSD 4.5-RELEASE</option>
<option value="FreeBSD 4.5-RELEASE and Ports">FreeBSD 4.5-RELEASE and Ports</option>
<option value="FreeBSD 4.6-RELEASE">FreeBSD 4.6-RELEASE</option>
<option value="FreeBSD 4.6-RELEASE and Ports">FreeBSD 4.6-RELEASE and Ports</option>
<option value="FreeBSD 4.6.2-RELEASE">FreeBSD 4.6.2-RELEASE</option>
<option value="FreeBSD 4.6.2-RELEASE and Ports">FreeBSD 4.6.2-RELEASE and Ports</option>
<option value="FreeBSD 4.7-RELEASE">FreeBSD 4.7-RELEASE</option>
<option value="FreeBSD 4.8-RELEASE">FreeBSD 4.8-RELEASE</option>
<option value="FreeBSD 4.8-RELEASE and Ports">FreeBSD 4.8-RELEASE and Ports</option>
<option value="FreeBSD 4.9-RELEASE">FreeBSD 4.9-RELEASE</option>
<option value="FreeBSD 4.9-RELEASE and Ports">FreeBSD 4.9-RELEASE and Ports</option>
<option value="FreeBSD 4.10-RELEASE">FreeBSD 4.10-RELEASE</option>
<option value="FreeBSD 4.10-RELEASE and Ports">FreeBSD 4.10-RELEASE and Ports</option>
<option value="FreeBSD 4.11-RELEASE">FreeBSD 4.11-RELEASE</option>
<option value="FreeBSD 4.11-RELEASE and Ports">FreeBSD 4.11-RELEASE and Ports</option>
<option value="FreeBSD 5.0-RELEASE">FreeBSD 5.0-RELEASE</option>
<option value="FreeBSD 5.1-RELEASE">FreeBSD 5.1-RELEASE</option>
<option value="FreeBSD 5.2-RELEASE">FreeBSD 5.2-RELEASE</option>
<option value="FreeBSD 5.2-RELEASE and Ports">FreeBSD 5.2-RELEASE and Ports</option>
<option value="FreeBSD 5.2.1-RELEASE">FreeBSD 5.2.1-RELEASE</option>
<option value="FreeBSD 5.2.1-RELEASE and Ports">FreeBSD 5.2.1-RELEASE and Ports</option>
<option value="FreeBSD 5.3-RELEASE">FreeBSD 5.3-RELEASE</option>
<option value="FreeBSD 5.3-RELEASE and Ports">FreeBSD 5.3-RELEASE and Ports</option>
<option value="FreeBSD 5.4-RELEASE">FreeBSD 5.4-RELEASE</option>
<option value="FreeBSD 5.4-RELEASE and Ports">FreeBSD 5.4-RELEASE and Ports</option>
<option value="FreeBSD 5.5-RELEASE">FreeBSD 5.5-RELEASE</option>
<option value="FreeBSD 5.5-RELEASE and Ports">FreeBSD 5.5-RELEASE and Ports</option>
<option value="FreeBSD 6.0-RELEASE">FreeBSD 6.0-RELEASE</option>
<option value="FreeBSD 6.0-RELEASE and Ports">FreeBSD 6.0-RELEASE and Ports</option>
<option value="FreeBSD 6.1-RELEASE">FreeBSD 6.1-RELEASE</option>
<option value="FreeBSD 6.2-RELEASE">FreeBSD 6.2-RELEASE</option>
<option value="FreeBSD 6.3-RELEASE">FreeBSD 6.3-RELEASE</option>
<option value="FreeBSD 6.3-RELEASE and Ports">FreeBSD 6.3-RELEASE and Ports</option>
<option value="FreeBSD 6.4-RELEASE">FreeBSD 6.4-RELEASE</option>
<option value="FreeBSD 6.4-RELEASE and Ports">FreeBSD 6.4-RELEASE and Ports</option>
<option value="FreeBSD 6.4-stable">FreeBSD 6.4-stable</option>
<option value="FreeBSD 7.0-RELEASE">FreeBSD 7.0-RELEASE</option>
<option value="FreeBSD 7.1-RELEASE">FreeBSD 7.1-RELEASE</option>
<option value="FreeBSD 7.1-RELEASE and Ports">FreeBSD 7.1-RELEASE and Ports</option>
<option value="FreeBSD 7.2-RELEASE">FreeBSD 7.2-RELEASE</option>
<option value="FreeBSD 7.2-RELEASE and Ports">FreeBSD 7.2-RELEASE and Ports</option>
<option value="FreeBSD 7.3-RELEASE">FreeBSD 7.3-RELEASE</option>
<option value="FreeBSD 7.3-RELEASE and Ports">FreeBSD 7.3-RELEASE and Ports</option>
<option value="FreeBSD 7.4-RELEASE">FreeBSD 7.4-RELEASE</option>
<option value="FreeBSD 7.4-RELEASE and Ports">FreeBSD 7.4-RELEASE and Ports</option>
<option value="FreeBSD 7.4-stable">FreeBSD 7.4-stable</option>
<option value="FreeBSD 8.0-RELEASE">FreeBSD 8.0-RELEASE</option>
<option value="FreeBSD 8.0-RELEASE and Ports">FreeBSD 8.0-RELEASE and Ports</option>
<option value="FreeBSD 8.1-RELEASE">FreeBSD 8.1-RELEASE</option>
<option value="FreeBSD 8.1-RELEASE and Ports">FreeBSD 8.1-RELEASE and Ports</option>
<option value="FreeBSD 8.2-RELEASE">FreeBSD 8.2-RELEASE</option>
<option value="FreeBSD 8.2-RELEASE and Ports">FreeBSD 8.2-RELEASE and Ports</option>
<option value="FreeBSD 8.3-RELEASE">FreeBSD 8.3-RELEASE</option>
<option value="FreeBSD 8.3-RELEASE and Ports">FreeBSD 8.3-RELEASE and Ports</option>
<option value="FreeBSD 8.4-RELEASE">FreeBSD 8.4-RELEASE</option>
<option value="FreeBSD 8.4-RELEASE and Ports">FreeBSD 8.4-RELEASE and Ports</option>
<option value="FreeBSD 8.4-stable">FreeBSD 8.4-stable</option>
<option value="FreeBSD 9.0-RELEASE">FreeBSD 9.0-RELEASE</option>
<option value="FreeBSD 9.0-RELEASE and Ports">FreeBSD 9.0-RELEASE and Ports</option>
<option value="FreeBSD 9.1-RELEASE">FreeBSD 9.1-RELEASE</option>
<option value="FreeBSD 9.1-RELEASE and Ports">FreeBSD 9.1-RELEASE and Ports</option>
<option value="FreeBSD 9.2-RELEASE">FreeBSD 9.2-RELEASE</option>
<option value="FreeBSD 9.2-RELEASE and Ports">FreeBSD 9.2-RELEASE and Ports</option>
<option value="FreeBSD 9.3-RELEASE">FreeBSD 9.3-RELEASE</option>
<option value="FreeBSD 9.3-RELEASE and Ports">FreeBSD 9.3-RELEASE and Ports</option>
<option value="FreeBSD 9.3-stable">FreeBSD 9.3-stable</option>
<option value="FreeBSD 10.0-RELEASE">FreeBSD 10.0-RELEASE</option>
<option value="FreeBSD 10.0-RELEASE and Ports">FreeBSD 10.0-RELEASE and Ports</option>
<option value="FreeBSD 10.1-RELEASE">FreeBSD 10.1-RELEASE</option>
<option value="FreeBSD 10.1-RELEASE and Ports">FreeBSD 10.1-RELEASE and Ports</option>
<option value="FreeBSD 10.2-RELEASE">FreeBSD 10.2-RELEASE</option>
<option value="FreeBSD 10.2-RELEASE and Ports">FreeBSD 10.2-RELEASE and Ports</option>
<option value="FreeBSD 10.3-RELEASE">FreeBSD 10.3-RELEASE</option>
<option value="FreeBSD 10.3-RELEASE and Ports">FreeBSD 10.3-RELEASE and Ports</option>
<option value="FreeBSD 10.4-RELEASE">FreeBSD 10.4-RELEASE</option>
<option value="FreeBSD 10.4-RELEASE and Ports">FreeBSD 10.4-RELEASE and Ports</option>
<option value="FreeBSD 10.4-stable">FreeBSD 10.4-stable</option>
<option value="FreeBSD 11.0-RELEASE">FreeBSD 11.0-RELEASE</option>
<option value="FreeBSD 11.0-RELEASE and Ports">FreeBSD 11.0-RELEASE and Ports</option>
<option value="FreeBSD 11.1-RELEASE">FreeBSD 11.1-RELEASE</option>
<option value="FreeBSD 11.1-RELEASE and Ports">FreeBSD 11.1-RELEASE and Ports</option>
<option value="FreeBSD 11.2-RELEASE">FreeBSD 11.2-RELEASE</option>
<option selected="selected" value="FreeBSD 11.2-RELEASE and Ports">FreeBSD 11.2-RELEASE and Ports</option>
<option value="FreeBSD 11.2-stable">FreeBSD 11.2-stable</option>
<option value="FreeBSD 12-current">FreeBSD 12-current</option>
<option value="FreeBSD Ports 2.2.8">FreeBSD Ports 2.2.8</option>
<option value="FreeBSD Ports 3.4">FreeBSD Ports 3.4</option>
<option value="FreeBSD Ports 3.5">FreeBSD Ports 3.5</option>
<option value="FreeBSD Ports 3.5.1">FreeBSD Ports 3.5.1</option>
<option value="FreeBSD Ports 4.1.1">FreeBSD Ports 4.1.1</option>
<option value="FreeBSD Ports 4.2">FreeBSD Ports 4.2</option>
<option value="FreeBSD Ports 4.3">FreeBSD Ports 4.3</option>
<option value="FreeBSD Ports 4.5">FreeBSD Ports 4.5</option>
<option value="FreeBSD Ports 4.6">FreeBSD Ports 4.6</option>
<option value="FreeBSD Ports 4.6.2">FreeBSD Ports 4.6.2</option>
<option value="FreeBSD Ports 4.7">FreeBSD Ports 4.7</option>
<option value="FreeBSD Ports 4.8">FreeBSD Ports 4.8</option>
<option value="FreeBSD Ports 4.9">FreeBSD Ports 4.9</option>
<option value="FreeBSD Ports 4.10">FreeBSD Ports 4.10</option>
<option value="FreeBSD Ports 4.11">FreeBSD Ports 4.11</option>
<option value="FreeBSD Ports 5.1">FreeBSD Ports 5.1</option>
<option value="FreeBSD Ports 5.2">FreeBSD Ports 5.2</option>
<option value="FreeBSD Ports 5.2.1">FreeBSD Ports 5.2.1</option>
<option value="FreeBSD Ports 5.3">FreeBSD Ports 5.3</option>
<option value="FreeBSD Ports 5.4">FreeBSD Ports 5.4</option>
<option value="FreeBSD Ports 5.5">FreeBSD Ports 5.5</option>
<option value="FreeBSD Ports 6.0">FreeBSD Ports 6.0</option>
<option value="FreeBSD Ports 6.2">FreeBSD Ports 6.2</option>
<option value="FreeBSD Ports 6.3">FreeBSD Ports 6.3</option>
<option value="FreeBSD Ports 6.4">FreeBSD Ports 6.4</option>
<option value="FreeBSD Ports 7.0">FreeBSD Ports 7.0</option>
<option value="FreeBSD Ports 7.1">FreeBSD Ports 7.1</option>
<option value="FreeBSD Ports 7.2">FreeBSD Ports 7.2</option>
<option value="FreeBSD Ports 7.3">FreeBSD Ports 7.3</option>
<option value="FreeBSD Ports 7.4">FreeBSD Ports 7.4</option>
<option value="FreeBSD Ports 8.0">FreeBSD Ports 8.0</option>
<option value="FreeBSD Ports 8.1">FreeBSD Ports 8.1</option>
<option value="FreeBSD Ports 8.2">FreeBSD Ports 8.2</option>
<option value="FreeBSD Ports 8.3">FreeBSD Ports 8.3</option>
<option value="FreeBSD Ports 8.4">FreeBSD Ports 8.4</option>
<option value="FreeBSD Ports 9.0">FreeBSD Ports 9.0</option>
<option value="FreeBSD Ports 9.1">FreeBSD Ports 9.1</option>
<option value="FreeBSD Ports 9.2">FreeBSD Ports 9.2</option>
<option value="FreeBSD Ports 9.3">FreeBSD Ports 9.3</option>
<option value="FreeBSD Ports 10.0">FreeBSD Ports 10.0</option>
<option value="FreeBSD Ports 10.1">FreeBSD Ports 10.1</option>
<option value="FreeBSD Ports 10.2">FreeBSD Ports 10.2</option>
<option value="FreeBSD Ports 10.3">FreeBSD Ports 10.3</option>
<option value="FreeBSD Ports 10.4">FreeBSD Ports 10.4</option>
<option value="FreeBSD Ports 11.0">FreeBSD Ports 11.0</option>
<option value="FreeBSD Ports 11.1">FreeBSD Ports 11.1</option>
<option value="FreeBSD Ports 11.2">FreeBSD Ports 11.2</option>
<option value="HP-UX 10.01">HP-UX 10.01</option>
<option value="HP-UX 10.10">HP-UX 10.10</option>
<option value="HP-UX 10.20">HP-UX 10.20</option>
<option value="HP-UX 11.00">HP-UX 11.00</option>
<option value="HP-UX 11.11">HP-UX 11.11</option>
<option value="HP-UX 11.20">HP-UX 11.20</option>
<option value="HP-UX 11.22">HP-UX 11.22</option>
<option value="Linux Slackware 3.1">Linux Slackware 3.1</option>
<option value="Minix 2.0">Minix 2.0</option>
<option value="NetBSD 1.0">NetBSD 1.0</option>
<option value="NetBSD 1.1">NetBSD 1.1</option>
<option value="NetBSD 1.2">NetBSD 1.2</option>
<option value="NetBSD 1.2.1">NetBSD 1.2.1</option>
<option value="NetBSD 1.3">NetBSD 1.3</option>
<option value="NetBSD 1.3.1">NetBSD 1.3.1</option>
<option value="NetBSD 1.3.2">NetBSD 1.3.2</option>
<option value="NetBSD 1.3.3">NetBSD 1.3.3</option>
<option value="NetBSD 1.4">NetBSD 1.4</option>
<option value="NetBSD 1.4.1">NetBSD 1.4.1</option>
<option value="NetBSD 1.4.2">NetBSD 1.4.2</option>
<option value="NetBSD 1.4.3">NetBSD 1.4.3</option>
<option value="NetBSD 1.5">NetBSD 1.5</option>
<option value="NetBSD 1.5.1">NetBSD 1.5.1</option>
<option value="NetBSD 1.5.2">NetBSD 1.5.2</option>
<option value="NetBSD 1.5.3">NetBSD 1.5.3</option>
<option value="NetBSD 1.6">NetBSD 1.6</option>
<option value="NetBSD 1.6.1">NetBSD 1.6.1</option>
<option value="NetBSD 1.6.2">NetBSD 1.6.2</option>
<option value="NetBSD 2.0">NetBSD 2.0</option>
<option value="NetBSD 2.0.2">NetBSD 2.0.2</option>
<option value="NetBSD 2.1">NetBSD 2.1</option>
<option value="NetBSD 3.0">NetBSD 3.0</option>
<option value="NetBSD 3.1">NetBSD 3.1</option>
<option value="NetBSD 4.0">NetBSD 4.0</option>
<option value="NetBSD 4.0.1">NetBSD 4.0.1</option>
<option value="NetBSD 5.0">NetBSD 5.0</option>
<option value="NetBSD 5.1">NetBSD 5.1</option>
<option value="NetBSD 6.0">NetBSD 6.0</option>
<option value="NetBSD 6.1.5">NetBSD 6.1.5</option>
<option value="NetBSD 7.0">NetBSD 7.0</option>
<option value="NetBSD 7.1">NetBSD 7.1</option>
<option value="OpenBSD 2.0">OpenBSD 2.0</option>
<option value="OpenBSD 2.1">OpenBSD 2.1</option>
<option value="OpenBSD 2.2">OpenBSD 2.2</option>
<option value="OpenBSD 2.3">OpenBSD 2.3</option>
<option value="OpenBSD 2.4">OpenBSD 2.4</option>
<option value="OpenBSD 2.5">OpenBSD 2.5</option>
<option value="OpenBSD 2.6">OpenBSD 2.6</option>
<option value="OpenBSD 2.7">OpenBSD 2.7</option>
<option value="OpenBSD 2.8">OpenBSD 2.8</option>
<option value="OpenBSD 2.9">OpenBSD 2.9</option>
<option value="OpenBSD 3.0">OpenBSD 3.0</option>
<option value="OpenBSD 3.1">OpenBSD 3.1</option>
<option value="OpenBSD 3.2">OpenBSD 3.2</option>
<option value="OpenBSD 3.3">OpenBSD 3.3</option>
<option value="OpenBSD 3.4">OpenBSD 3.4</option>
<option value="OpenBSD 3.5">OpenBSD 3.5</option>
<option value="OpenBSD 3.6">OpenBSD 3.6</option>
<option value="OpenBSD 3.7">OpenBSD 3.7</option>
<option value="OpenBSD 3.8">OpenBSD 3.8</option>
<option value="OpenBSD 3.9">OpenBSD 3.9</option>
<option value="OpenBSD 4.0">OpenBSD 4.0</option>
<option value="OpenBSD 4.1">OpenBSD 4.1</option>
<option value="OpenBSD 4.2">OpenBSD 4.2</option>
<option value="OpenBSD 4.3">OpenBSD 4.3</option>
<option value="OpenBSD 4.4">OpenBSD 4.4</option>
<option value="OpenBSD 4.5">OpenBSD 4.5</option>
<option value="OpenBSD 4.6">OpenBSD 4.6</option>
<option value="OpenBSD 4.7">OpenBSD 4.7</option>
<option value="OpenBSD 4.8">OpenBSD 4.8</option>
<option value="OpenBSD 4.9">OpenBSD 4.9</option>
<option value="OpenBSD 5.0">OpenBSD 5.0</option>
<option value="OpenBSD 5.1">OpenBSD 5.1</option>
<option value="OpenBSD 5.2">OpenBSD 5.2</option>
<option value="OpenBSD 5.3">OpenBSD 5.3</option>
<option value="OpenBSD 5.4">OpenBSD 5.4</option>
<option value="OpenBSD 5.5">OpenBSD 5.5</option>
<option value="OpenBSD 5.6">OpenBSD 5.6</option>
<option value="OpenBSD 5.7">OpenBSD 5.7</option>
<option value="OpenBSD 5.8">OpenBSD 5.8</option>
<option value="OpenBSD 5.9">OpenBSD 5.9</option>
<option value="OpenBSD 6.0">OpenBSD 6.0</option>
<option value="OpenBSD 6.1">OpenBSD 6.1</option>
<option value="OpenBSD 6.2">OpenBSD 6.2</option>
<option value="OpenDarwin 6.6.1/x86">OpenDarwin 6.6.1/x86</option>
<option value="OpenDarwin 6.6.2/x86">OpenDarwin 6.6.2/x86</option>
<option value="OpenDarwin 7.2.1">OpenDarwin 7.2.1</option>
<option value="OpenDarwin 20030208pre4/ppc">OpenDarwin 20030208pre4/ppc</option>
<option value="OSF1 V4.0/alpha">OSF1 V4.0/alpha</option>
<option value="OSF1 V5.1/alpha">OSF1 V5.1/alpha</option>
<option value="Plan 9">Plan 9</option>
<option value="Red Hat Linux/i386 4.2">Red Hat Linux/i386 4.2</option>
<option value="Red Hat Linux/i386 5.0">Red Hat Linux/i386 5.0</option>
<option value="Red Hat Linux/i386 5.2">Red Hat Linux/i386 5.2</option>
<option value="Red Hat Linux/i386 6.1">Red Hat Linux/i386 6.1</option>
<option value="Red Hat Linux/i386 6.2">Red Hat Linux/i386 6.2</option>
<option value="Red Hat Linux/i386 7.0">Red Hat Linux/i386 7.0</option>
<option value="Red Hat Linux/i386 7.1">Red Hat Linux/i386 7.1</option>
<option value="Red Hat Linux/i386 7.2">Red Hat Linux/i386 7.2</option>
<option value="Red Hat Linux/i386 7.3">Red Hat Linux/i386 7.3</option>
<option value="Red Hat Linux/i386 8.0">Red Hat Linux/i386 8.0</option>
<option value="Red Hat Linux/i386 9">Red Hat Linux/i386 9</option>
<option value="SunOS 4.1.3">SunOS 4.1.3</option>
<option value="SunOS 5.5.1">SunOS 5.5.1</option>
<option value="SunOS 5.6">SunOS 5.6</option>
<option value="SunOS 5.7">SunOS 5.7</option>
<option value="SunOS 5.8">SunOS 5.8</option>
<option value="SunOS 5.9">SunOS 5.9</option>
<option value="SunOS 5.10">SunOS 5.10</option>
<option value="SuSE Linux/i386 4.3">SuSE Linux/i386 4.3</option>
<option value="SuSE Linux/i386 5.0">SuSE Linux/i386 5.0</option>
<option value="SuSE Linux/i386 5.2">SuSE Linux/i386 5.2</option>
<option value="SuSE Linux/i386 5.3">SuSE Linux/i386 5.3</option>
<option value="SuSE Linux/i386 6.0">SuSE Linux/i386 6.0</option>
<option value="SuSE Linux/i386 6.1">SuSE Linux/i386 6.1</option>
<option value="SuSE Linux/i386 6.3">SuSE Linux/i386 6.3</option>
<option value="SuSE Linux/i386 6.4">SuSE Linux/i386 6.4</option>
<option value="SuSE Linux/i386 7.0">SuSE Linux/i386 7.0</option>
<option value="SuSE Linux/i386 7.1">SuSE Linux/i386 7.1</option>
<option value="SuSE Linux/i386 7.2">SuSE Linux/i386 7.2</option>
<option value="SuSE Linux/i386 7.3">SuSE Linux/i386 7.3</option>
<option value="SuSE Linux/i386 8.0">SuSE Linux/i386 8.0</option>
<option value="SuSE Linux/i386 8.1">SuSE Linux/i386 8.1</option>
<option value="SuSE Linux/i386 8.2">SuSE Linux/i386 8.2</option>
<option value="SuSE Linux/i386 9.2">SuSE Linux/i386 9.2</option>
<option value="SuSE Linux/i386 9.3">SuSE Linux/i386 9.3</option>
<option value="SuSE Linux/i386 10.0">SuSE Linux/i386 10.0</option>
<option value="SuSE Linux/i386 10.1">SuSE Linux/i386 10.1</option>
<option value="SuSE Linux/i386 10.2">SuSE Linux/i386 10.2</option>
<option value="SuSE Linux/i386 10.3">SuSE Linux/i386 10.3</option>
<option value="SuSE Linux/i386 11.0">SuSE Linux/i386 11.0</option>
<option value="SuSE Linux/i386 11.1">SuSE Linux/i386 11.1</option>
<option value="SuSE Linux/i386 11.2">SuSE Linux/i386 11.2</option>
<option value="SuSE Linux/i386 11.3">SuSE Linux/i386 11.3</option>
<option value="SuSE Linux/i386 ES 10 SP1">SuSE Linux/i386 ES 10 SP1</option>
<option value="ULTRIX 4.2">ULTRIX 4.2</option>
<option value="Unix Seventh Edition">Unix Seventh Edition</option>
<option value="X11R6.7.0">X11R6.7.0</option>
<option value="X11R6.8.2">X11R6.8.2</option>
<option value="X11R6.9.0">X11R6.9.0</option>
<option value="X11R7.2">X11R7.2</option>
<option value="X11R7.3.2">X11R7.3.2</option>
<option value="X11R7.4">X11R7.4</option>
<option value="XFree86 2.1">XFree86 2.1</option>
<option value="XFree86 3.3">XFree86 3.3</option>
<option value="XFree86 3.3.6">XFree86 3.3.6</option>
<option value="XFree86 4.0">XFree86 4.0</option>
<option value="XFree86 4.0.1">XFree86 4.0.1</option>
<option value="XFree86 4.0.2">XFree86 4.0.2</option>
<option value="XFree86 4.1.0">XFree86 4.1.0</option>
<option value="XFree86 4.2.0">XFree86 4.2.0</option>
<option value="XFree86 4.2.99.3">XFree86 4.2.99.3</option>
<option value="XFree86 4.3.0">XFree86 4.3.0</option>
<option value="XFree86 4.4.0">XFree86 4.4.0</option>
<option value="XFree86 4.5.0">XFree86 4.5.0</option>
<option value="XFree86 4.6.0">XFree86 4.6.0</option>
<option value="XFree86 4.7.0">XFree86 4.7.0</option>
</select>
<select name="arch">
<option  value="default">All Architectures</option>
<option  value="amd64">amd64</option>
</select>

<select name="format">
<option value="html">html</option>
<option value="pdf">pdf</option>
<option value="ascii">ascii</option>
</select>
</form>

<br/>
<span class="footer_links"><a href="/cgi/man.cgi?manpath=FreeBSD+11.2-RELEASE+and+Ports">home</a> | <a href="/cgi/man.cgi/help.html">help</a></span>
<hr/>
<pre>
PF.CONF(5)		  FreeBSD File Formats Manual		    PF.CONF(5)

<a name="NAME" href="#end"><b>NAME</b></a>
     <b>pf.conf</b> --	packet filter configuration file

<a name="DESCRIPTION" href="#end"><b>DESCRIPTION</b></a>
     The <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> packet filter modifies, drops or	passes packets according to
     rules or definitions specified in <b>pf.conf</b>.

<a name="STATEMENT_ORDER" href="#end"><b>STATEMENT ORDER</b></a>
     There are seven types of statements in <b>pf.conf</b>:

     <b>Macros</b>
	   User-defined	variables may be defined and used later, simplifying
	   the configuration file.  Macros must	be defined before they are
	   referenced in <b>pf.conf</b>.

     <b>Tables</b>
	   Tables provide a mechanism for increasing the performance and flex-
	   ibility of rules with large numbers of source or destination
	   addresses.

     <b>Options</b>
	   Options tune	the behaviour of the packet filtering engine.

     <b>Traffic</b> <b>Normalization</b> (e.g. <i>scrub</i>)
	   Traffic normalization protects internal machines against inconsis-
	   tencies in Internet protocols and implementations.

     <b>Queueing</b>
	   Queueing provides rule-based	bandwidth control.

     <b>Translation</b> (Various forms	of NAT)
	   Translation rules specify how addresses are to be mapped or redi-
	   rected to other addresses.

     <b>Packet</b> <b>Filtering</b>
	   Packet filtering provides rule-based	blocking or passing of pack-
	   ets.

     With the exception	of <b>macros</b> and <b>tables</b>, the types	of statements should
     be	grouped	and appear in <b>pf.conf</b> in the order shown above,	as this
     matches the operation of the underlying packet filtering engine.  By
     default <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a> enforces this order (see <i>set</i> <i>require-order</i> below).

     Comments can be put anywhere in the file using a hash mark	(`#'), and
     extend to the end of the current line.

     Additional	configuration files can	be included with the <b>include</b> keyword,
     for example:

	   include "/etc/pf/sub.filter.conf"

<a name="MACROS" href="#end"><b>MACROS</b></a>
     Macros can	be defined that	will later be expanded in context.  Macro
     names must	start with a letter, and may contain letters, digits and
     underscores.  Macro names may not be reserved words (for example <i>pass</i>,
     <i>in</i>, <i>out</i>).	Macros are not expanded	inside quotes.

     For example,

	   ext_if = "kue0"
	   all_ifs = "{" $ext_if lo0 "}"
	   pass	out on $ext_if from any	to any
	   pass	in  on $ext_if proto tcp from any to any port 25

<a name="TABLES" href="#end"><b>TABLES</b></a>
     Tables are	named structures which can hold	a collection of	addresses and
     networks.	Lookups	against	tables in <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a>	are relatively fast, making a
     single rule with tables much more efficient, in terms of processor	usage
     and memory	consumption, than a large number of rules which	differ only in
     IP	address	(either	created	explicitly or automatically by rule expan-
     sion).

     Tables can	be used	as the source or destination of	filter rules, <i>scrub</i>
     rules or translation rules	such as	<i>nat</i> or <i>rdr</i> (see	below for details on
     the various rule types).  Tables can also be used for the redirect
     address of	<i>nat</i> and	<i>rdr</i> rules and in the routing options of	filter rules,
     but only for <i>round-robin</i> pools.

     Tables can	be defined with	any of the following <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a> mechanisms.  As
     with macros, reserved words may not be used as table names.

     <i>manually</i>  Persistent tables can be	manually created with the <i>add</i> or
	       <i>replace</i> option of <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a>, before or after the ruleset has
	       been loaded.

     <i>pf.conf</i>   Table definitions can be	placed directly	in this	file, and
	       loaded at the same time as other	rules are loaded, atomically.
	       Table definitions inside	<b>pf.conf</b>	use the	<i>table</i> statement, and
	       are especially useful to	define non-persistent tables.  The
	       contents	of a pre-existing table	defined	without	a list of
	       addresses to initialize it is not altered when <b>pf.conf</b> is
	       loaded.	A table	initialized with the empty list, { }, will be
	       cleared on load.

     Tables may	be defined with	the following attributes:

     <i>persist</i>  The <i>persist</i> flag forces the kernel to keep the table even	when
	      no rules refer to	it.  If	the flag is not	set, the kernel	will
	      automatically remove the table when the last rule	referring to
	      it is flushed.

     <i>const</i>    The <i>const</i>	flag prevents the user from altering the contents of
	      the table	once it	has been created.  Without that	flag, <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a>
	      can be used to add or remove addresses from the table at any
	      time, even when running with <a href="/cgi/man.cgi?query=securelevel&amp;sektion=7&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">securelevel(7)</a> = 2.

     <i>counters</i>
	      The <i>counters</i> flag	enables	per-address packet and byte counters
	      which can	be displayed with <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a>.

     For example,

	   table &lt;private&gt; const { 10/8, 172.16/12, 192.168/16 }
	   table &lt;badhosts&gt; persist
	   block on fxp0 from {	&lt;private&gt;, &lt;badhosts&gt; }	to any

     creates a table called private, to	hold RFC 1918 private network blocks,
     and a table called	badhosts, which	is initially empty.  A filter rule is
     set up to block all traffic coming	from addresses listed in either	table.
     The private table cannot have its contents	changed	and the	badhosts table
     will exist	even when no active filter rules reference it.	Addresses may
     later be added to the badhosts table, so that traffic from	these hosts
     can be blocked by using

	   # pfctl -t badhosts -Tadd 204.92.77.111

     A table can also be initialized with an address list specified in one or
     more external files, using	the following syntax:

	   table &lt;spam&gt;	persist	file "/etc/spammers" file "/etc/openrelays"
	   block on fxp0 from &lt;spam&gt; to	any

     The files <i>/etc/spammers</i> and <i>/etc/openrelays</i> list IP addresses, one	per
     line.  Any	lines beginning	with a # are treated as	comments and ignored.
     In	addition to being specified by IP address, hosts may also be specified
     by	their hostname.	 When the resolver is called to	add a hostname to a
     table, <i>all</i>	resulting IPv4 and IPv6	addresses are placed into the table.
     IP	addresses can also be entered in a table by specifying a valid inter-
     face name,	a valid	interface group	or the <i>self</i> keyword, in	which case all
     addresses assigned	to the interface(s) will be added to the table.

<a name="OPTIONS" href="#end"><b>OPTIONS</b></a>
     <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> may be tuned	for various situations using the <i>set</i> command.

     <i>set</i> <i>timeout</i>

	   <i>interval</i>   Interval between purging expired states and fragments.
	   <i>frag</i>	      Seconds before an	unassembled fragment is	expired.
	   <i>src.track</i>  Length of	time to	retain a source	tracking entry after
		      the last state expires.

	   When	a packet matches a stateful connection,	the seconds to live
	   for the connection will be updated to that of the <i>proto.modifier</i>
	   which corresponds to	the connection state.  Each packet which
	   matches this	state will reset the TTL.  Tuning these	values may
	   improve the performance of the firewall at the risk of dropping
	   valid idle connections.

	   <i>tcp.first</i>
		 The state after the first packet.
	   <i>tcp.opening</i>
		 The state before the destination host ever sends a packet.
	   <i>tcp.established</i>
		 The fully established state.
	   <i>tcp.closing</i>
		 The state after the first FIN has been	sent.
	   <i>tcp.finwait</i>
		 The state after both FINs have	been exchanged and the connec-
		 tion is closed.  Some hosts (notably web servers on Solaris)
		 send TCP packets even after closing the connection.  Increas-
		 ing <i>tcp.finwait</i> (and possibly <i>tcp.closing</i>) can	prevent	block-
		 ing of	such packets.
	   <i>tcp.closed</i>
		 The state after one endpoint sends an RST.

	   ICMP	and UDP	are handled in a fashion similar to TCP, but with a
	   much	more limited set of states:

	   <i>udp.first</i>
		 The state after the first packet.
	   <i>udp.single</i>
		 The state if the source host sends more than one packet but
		 the destination host has never	sent one back.
	   <i>udp.multiple</i>
		 The state if both hosts have sent packets.
	   <i>icmp.first</i>
		 The state after the first packet.
	   <i>icmp.error</i>
		 The state after an ICMP error came back in response to	an
		 ICMP packet.

	   Other protocols are handled similarly to UDP:

	   <i>other.first</i>
	   <i>other.single</i>
	   <i>other.multiple</i>

	   Timeout values can be reduced adaptively as the number of state ta-
	   ble entries grows.

	   <i>adaptive.start</i>
		 When the number of state entries exceeds this value, adaptive
		 scaling begins.  All timeout values are scaled	linearly with
		 factor	(adaptive.end -	number of states) / (adaptive.end -
		 adaptive.start).
	   <i>adaptive.end</i>
		 When reaching this number of state entries, all timeout val-
		 ues become zero, effectively purging all state	entries	imme-
		 diately.  This	value is used to define	the scale factor, it
		 should	not actually be	reached	(set a lower state limit, see
		 below).

	   Adaptive timeouts are enabled by default, with an adaptive.start
	   value equal to 60% of the state limit, and an adaptive.end value
	   equal to 120% of the	state limit.  They can be disabled by setting
	   both	adaptive.start and adaptive.end	to 0.

	   The adaptive	timeout	values can be defined both globally and	for
	   each	rule.  When used on a per-rule basis, the values relate	to the
	   number of states created by the rule, otherwise to the total	number
	   of states.

	   For example:

		 set timeout tcp.first 120
		 set timeout tcp.established 86400
		 set timeout { adaptive.start 6000, adaptive.end 12000 }
		 set limit states 10000

	   With	9000 state table entries, the timeout values are scaled	to 50%
	   (tcp.first 60, tcp.established 43200).

     <i>set</i> <i>loginterface</i>
	   Enable collection of	packet and byte	count statistics for the given
	   interface or	interface group.  These	statistics can be viewed using

		 # pfctl -s info

	   In this example <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> collects statistics on	the interface named
	   dc0:

		 set loginterface dc0

	   One can disable the loginterface using:

		 set loginterface none

     <i>set</i> <i>limit</i>
	   Sets	hard limits on the memory pools	used by	the packet filter.
	   See <a href="/cgi/man.cgi?query=zone&amp;sektion=9&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">zone(9)</a> for an explanation of memory pools.

	   For example,

		 set limit states 20000

	   sets	the maximum number of entries in the memory pool used by state
	   table entries (generated by <i>pass</i> rules which	do not specify <i>no</i>
	   <i>state</i>) to 20000.  Using

		 set limit frags 20000

	   sets	the maximum number of entries in the memory pool used for
	   fragment reassembly (generated by <i>scrub</i> rules) to 20000.  Using

		 set limit src-nodes 2000

	   sets	the maximum number of entries in the memory pool used for
	   tracking source IP addresses	(generated by the <i>sticky-address</i> and
	   <i>src.track</i> options) to 2000.	Using

		 set limit tables 1000
		 set limit table-entries 100000

	   sets	limits on the memory pools used	by tables.  The	first limits
	   the number of tables	that can exist to 1000.	 The second limits the
	   overall number of addresses that can	be stored in tables to 100000.

	   Various limits can be combined on a single line:

		 set limit { states 20000, frags 20000,	src-nodes 2000 }

     <i>set</i> <i>ruleset-optimization</i>
	   <i>none</i>	     Disable the ruleset optimizer.
	   <i>basic</i>     Enable basic ruleset optimization.	 This is the default
		     behaviour.	 Basic ruleset optimization does four things
		     to	improve	the performance	of ruleset evaluations:

		     1.	  remove duplicate rules
		     2.	  remove rules that are	a subset of another rule
		     3.	  combine multiple rules into a	table when advanta-
			  geous
		     4.	  re-order the rules to	improve	evaluation performance

	   <i>profile</i>   Uses the currently	loaded ruleset as a feedback profile
		     to	tailor the ordering of quick rules to actual network
		     traffic.

	   It is important to note that	the ruleset optimizer will modify the
	   ruleset to improve performance.  A side effect of the ruleset modi-
	   fication is that per-rule accounting	statistics will	have different
	   meanings than before.  If per-rule accounting is important for
	   billing purposes or whatnot,	either the ruleset optimizer should
	   not be used or a label field	should be added	to all of the account-
	   ing rules to	act as optimization barriers.

	   Optimization	can also be set	as a command-line argument to
	   <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a>, overriding	the settings in	<b>pf.conf</b>.

     <i>set</i> <i>optimization</i>
	   Optimize state timeouts for one of the following network environ-
	   ments:

	   <i>normal</i>
		 A normal network environment.	Suitable for almost all	net-
		 works.
	   <i>high-latency</i>
		 A high-latency	environment (such as a satellite connection).
	   <i>satellite</i>
		 Alias for <i>high-latency</i>.
	   <i>aggressive</i>
		 Aggressively expire connections.  This	can greatly reduce the
		 memory	usage of the firewall at the cost of dropping idle
		 connections early.
	   <i>conservative</i>
		 Extremely conservative	settings.  Avoid dropping legitimate
		 connections at	the expense of greater memory utilization
		 (possibly much	greater	on a busy network) and slightly
		 increased processor utilization.

	   For example:

		 set optimization aggressive

     <i>set</i> <i>block-policy</i>
	   The <i>block-policy</i> option sets	the default behaviour for the packet
	   <i>block</i> action:

	   <i>drop</i>	     Packet is silently	dropped.
	   <i>return</i>    A TCP RST is returned for blocked TCP packets, an ICMP
		     UNREACHABLE is returned for blocked UDP packets, and all
		     other packets are silently	dropped.

	   For example:

		 set block-policy return

     <i>set</i> <i>state-policy</i>
	   The <i>state-policy</i> option sets	the default behaviour for states:

	   <i>if-bound</i>	States are bound to interface.
	   <i>floating</i>	States can match packets on any	interfaces (the
			default).

	   For example:

		 set state-policy if-bound

     <i>set</i> <i>state-defaults</i>
	   The <i>state-defaults</i> option sets the state options for	states created
	   from	rules without an explicit <i>keep</i> <i>state</i>.  For example:

		 set state-defaults pflow, no-sync

     <i>set</i> <i>hostid</i>
	   The 32-bit <i>hostid</i> identifies	this firewall's	state table entries to
	   other firewalls in a	<a href="/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfsync(4)</a> failover cluster.  By	default	the
	   hostid is set to a pseudo-random value, however it may be desirable
	   to manually configure it, for example to more easily	identify the
	   source of state table entries.

		 set hostid 1

	   The hostid may be specified in either decimal or hexadecimal.

     <i>set</i> <i>require-order</i>
	   By default <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a> enforces	an ordering of the statement types in
	   the ruleset to: <i>options</i>, <i>normalization</i>, <i>queueing</i>, <i>translation</i>,
	   <i>filtering</i>.  Setting this option to <i>no</i> disables this enforcement.
	   There may be	non-trivial and	non-obvious implications to an out of
	   order ruleset.  Consider carefully before disabling the order
	   enforcement.

     <i>set</i> <i>fingerprints</i>
	   Load	fingerprints of	known operating	systems	from the given file-
	   name.  By default fingerprints of known operating systems are auto-
	   matically loaded from <a href="/cgi/man.cgi?query=pf.os&amp;sektion=5&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf.os(5)</a> in <i>/etc</i> but can be overridden	via
	   this	option.	 Setting this option may leave a small period of time
	   where the fingerprints referenced by	the currently active ruleset
	   are inconsistent until the new ruleset finishes loading.

	   For example:

		 set fingerprints "/etc/pf.os.devel"

     <i>set</i> <i>skip</i> <i>on</i> &lt;<i>ifspec</i>&gt;
	   List	interfaces for which packets should not	be filtered.  Packets
	   passing in or out on	such interfaces	are passed as if pf was	dis-
	   abled, i.e. pf does not process them	in any way.  This can be use-
	   ful on loopback and other virtual interfaces, when packet filtering
	   is not desired and can have unexpected effects.  For	example:

		 set skip on lo0

     <i>set</i> <i>debug</i>
	   Set the debug <i>level</i> to one of the following:

	   <i>none</i>		 Don't generate	debug messages.
	   <i>urgent</i>	 Generate debug	messages only for serious errors.
	   <i>misc</i>		 Generate debug	messages for various errors.
	   <i>loud</i>		 Generate debug	messages for common conditions.

<a name="TRAFFIC%09NORMALIZATION" href="#end"><b>TRAFFIC	NORMALIZATION</b></a>
     Traffic normalization is used to sanitize packet content in such a	way
     that there	are no ambiguities in packet interpretation on the receiving
     side.  The	normalizer does	IP fragment reassembly to prevent attacks that
     confuse intrusion detection systems by sending overlapping	IP fragments.
     Packet normalization is invoked with the <i>scrub</i> directive.

     <i>scrub</i> has the following options:

     <i>no-df</i>
	   Clears the <i>dont-fragment</i> bit	from a matching	IP packet.  Some oper-
	   ating systems are known to generate fragmented packets with the
	   <i>dont-fragment</i> bit set.  This	is particularly	true with NFS.	<i>Scrub</i>
	   will	drop such fragmented <i>dont-fragment</i> packets unless <i>no-df</i>	is
	   specified.

	   Unfortunately some operating	systems	also generate their
	   <i>dont-fragment</i> packets with a	zero IP	identification field.  Clear-
	   ing the <i>dont-fragment</i> bit on	packets	with a zero IP ID may cause
	   deleterious results if an upstream router later fragments the
	   packet.  Using the <i>random-id</i>	modifier (see below) is	recommended in
	   combination with the	<i>no-df</i> modifier to ensure unique	IP identi-
	   fiers.

     <i>min-ttl</i> &lt;<i>number</i>&gt;
	   Enforces a minimum TTL for matching IP packets.

     <i>max-mss</i> &lt;<i>number</i>&gt;
	   Enforces a maximum MSS for matching TCP packets.

     <i>set-tos</i> &lt;<i>string</i>&gt; |	&lt;<i>number</i>&gt;
	   Enforces a <i>TOS</i> for matching IP packets.  <i>TOS</i>	may be given as	one of
	   <i>lowdelay</i>, <i>throughput</i>, <i>reliability</i>, or as either hex or decimal.

     <i>random-id</i>
	   Replaces the	IP identification field	with random values to compen-
	   sate	for predictable	values generated by many hosts.	 This option
	   only	applies	to packets that	are not	fragmented after the optional
	   fragment reassembly.

     <i>fragment</i> <i>reassemble</i>
	   Using <i>scrub</i> rules, fragments	can be reassembled by normalization.
	   In this case, fragments are buffered	until they form	a complete
	   packet, and only the	completed packet is passed on to the filter.
	   The advantage is that filter	rules have to deal only	with complete
	   packets, and	can ignore fragments.  The drawback of caching frag-
	   ments is the	additional memory cost.

     <i>reassemble</i>	<i>tcp</i>
	   Statefully normalizes TCP connections.  <i>scrub</i> <i>reassemble</i> <i>tcp</i>	rules
	   may not have	the direction (in/out) specified.  <i>reassemble</i> <i>tcp</i> per-
	   forms the following normalizations:

	   ttl	    Neither side of the	connection is allowed to reduce	their
		    IP TTL.  An	attacker may send a packet such	that it
		    reaches the	firewall, affects the firewall state, and
		    expires before reaching the	destination host.  <i>reassemble</i>
		    <i>tcp</i>	will raise the TTL of all packets back up to the high-
		    est	value seen on the connection.
	   timestamp modulation
		    Modern TCP stacks will send	a timestamp on every TCP
		    packet and echo the	other endpoint's timestamp back	to
		    them.  Many	operating systems will merely start the	time-
		    stamp at zero when first booted, and increment it several
		    times a second.  The uptime	of the host can	be deduced by
		    reading the	timestamp and multiplying by a constant.  Also
		    observing several different	timestamps can be used to
		    count hosts	behind a NAT device.  And spoofing TCP packets
		    into a connection requires knowing or guessing valid time-
		    stamps.  Timestamps	merely need to be monotonically
		    increasing and not derived off a guessable base time.
		    <i>reassemble</i> <i>tcp</i> will	cause <i>scrub</i> to modulate	the TCP	time-
		    stamps with	a random number.
	   extended PAWS checks
		    There is a problem with TCP	on long	fat pipes, in that a
		    packet might get delayed for longer	than it	takes the con-
		    nection to wrap its	32-bit sequence	space.	In such	an
		    occurrence,	the old	packet would be	indistinguishable from
		    a new packet and would be accepted as such.	 The solution
		    to this is called PAWS: Protection Against Wrapped
		    Sequence numbers.  It protects against it by making	sure
		    the	timestamp on each packet does not go backwards.
		    <i>reassemble</i> <i>tcp</i> also	makes sure the timestamp on the	packet
		    does not go	forward	more than the RFC allows.  By doing
		    this, <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a>	artificially extends the security of TCP
		    sequence numbers by	10 to 18 bits when the host uses
		    appropriately randomized timestamps, since a blind
		    attacker would have	to guess the timestamp as well.

     For example,

	   scrub in on $ext_if all fragment reassemble

     The <i>no</i> option prefixed to a scrub rule causes matching packets to remain
     unscrubbed, much in the same way as <i>drop</i> <i>quick</i> works in the packet	filter
     (see below).  This	mechanism should be used when it is necessary to
     exclude specific packets from broader scrub rules.

<a name="QUEUEING" href="#end"><b>QUEUEING</b></a>
     The ALTQ system is	currently not available	in the GENERIC kernel nor as
     loadable modules.	In order to use	the herein after called	queueing
     options one has to	use a custom built kernel.  Please refer to <a href="/cgi/man.cgi?query=altq&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">altq(4)</a> to
     learn about the related kernel options.

     Packets can be assigned to	queues for the purpose of bandwidth control.
     At	least two declarations are required to configure queues, and later any
     packet filtering rule can reference the defined queues by name.  During
     the filtering component of	<b>pf.conf</b>, the last referenced <i>queue</i> name	is
     where any packets from <i>pass</i> rules will be queued, while for <i>block</i> rules
     it	specifies where	any resulting ICMP or TCP RST packets should be
     queued.  The <i>scheduler</i> defines the	algorithm used to decide which packets
     get delayed, dropped, or sent out immediately.  There are three
     <i>schedulers</i>	currently supported.

     <i>cbq</i>   Class Based Queueing.  <i>Queues</i> attached to an	interface build	a
	   tree, thus each <i>queue</i> can have further child	<i>queues</i>.	 Each queue
	   can have a <i>priority</i> and a <i>bandwidth</i> assigned.  <i>Priority</i> mainly con-
	   trols the time packets take to get sent out,	while <i>bandwidth</i>	has
	   primarily effects on	throughput.  <i>cbq</i> achieves both partitioning
	   and sharing of link bandwidth by hierarchically structured classes.
	   Each	class has its own <i>queue</i>	and is assigned	its share of
	   <i>bandwidth</i>.  A child class can borrow	bandwidth from its parent
	   class as long as excess bandwidth is	available (see the option
	   <i>borrow</i>, below).

     <i>priq</i>  Priority Queueing.  <i>Queues</i> are flat attached	to the interface,
	   thus, <i>queues</i>	cannot have further child <i>queues</i>.  Each	<i>queue</i> has a
	   unique <i>priority</i> assigned, ranging from 0 to 15.  Packets in the
	   <i>queue</i> with the highest <i>priority</i> are processed first.

     <i>hfsc</i>  Hierarchical	Fair Service Curve.  <i>Queues</i> attached to	an interface
	   build a tree, thus each <i>queue</i> can have further child	<i>queues</i>.	 Each
	   queue can have a <i>priority</i> and a <i>bandwidth</i> assigned.	<i>Priority</i>
	   mainly controls the time packets take to get	sent out, while
	   <i>bandwidth</i> primarily affects throughput.  <i>hfsc</i> supports both link-
	   sharing and guaranteed real-time services.  It employs a service
	   curve based QoS model, and its unique feature is an ability to
	   decouple <i>delay</i> and <i>bandwidth</i>	allocation.

     The interfaces on which queueing should be	activated are declared using
     the <i>altq</i> <i>on</i> declaration.  <i>altq</i> <i>on</i> has the following keywords:

     &lt;<i>interface</i>&gt;
	   Queueing is enabled on the named interface.

     &lt;<i>scheduler</i>&gt;
	   Specifies which queueing scheduler to use.  Currently supported
	   values are <i>cbq</i> for Class Based Queueing, <i>priq</i> for Priority Queueing
	   and <i>hfsc</i> for	the Hierarchical Fair Service Curve scheduler.

     <i>bandwidth</i> &lt;<i>bw</i>&gt;
	   The maximum bitrate for all queues on an interface may be specified
	   using the <i>bandwidth</i> keyword.	 The value can be specified as an
	   absolute value or as	a percentage of	the interface bandwidth.  When
	   using an absolute value, the	suffixes <i>b</i>, <i>Kb</i>,	<i>Mb</i>, and	<i>Gb</i> are used to
	   represent bits, kilobits, megabits, and gigabits per	second,
	   respectively.  The value must not exceed the	interface bandwidth.
	   If <i>bandwidth</i>	is not specified, the interface	bandwidth is used (but
	   take	note that some interfaces do not know their bandwidth, or can
	   adapt their bandwidth rates).

     <i>qlimit</i> &lt;<i>limit</i>&gt;
	   The maximum number of packets held in the queue.  The default is
	   50.

     <i>tbrsize</i> &lt;<i>size</i>&gt;
	   Adjusts the size, in	bytes, of the token bucket regulator.  If not
	   specified, heuristics based on the interface	bandwidth are used to
	   determine the size.

     <i>queue</i> &lt;<i>list</i>&gt;
	   Defines a list of subqueues to create on an interface.

     In	the following example, the interface dc0 should	queue up to 5Mbps in
     four second-level queues using Class Based	Queueing.  Those four queues
     will be shown in a	later example.

	   altq	on dc0 cbq bandwidth 5Mb queue { std, http, mail, ssh }

     Once interfaces are activated for queueing	using the <i>altq</i> directive, a
     sequence of <i>queue</i> directives may be defined.  The name associated with a
     <i>queue</i> must	match a	queue defined in the <i>altq</i> directive (e.g. mail), or,
     except for	the <i>priq</i> <i>scheduler</i>, in a parent	<i>queue</i> declaration.  The	fol-
     lowing keywords can be used:

     <i>on</i>	&lt;<i>interface</i>&gt;
	   Specifies the interface the queue operates on.  If not given, it
	   operates on all matching interfaces.

     <i>bandwidth</i> &lt;<i>bw</i>&gt;
	   Specifies the maximum bitrate to be processed by the	queue.	This
	   value must not exceed the value of the parent <i>queue</i> and can be
	   specified as	an absolute value or a percentage of the parent
	   queue's bandwidth.  If not specified, defaults to 100% of the par-
	   ent queue's bandwidth.  The <i>priq</i> scheduler does not support band-
	   width specification.

     <i>priority</i> &lt;<i>level</i>&gt;
	   Between queues a priority level can be set.	For <i>cbq</i>	and <i>hfsc</i>, the
	   range is 0 to 7 and for <i>priq</i>, the range is 0	to 15.	The default
	   for all is 1.  <i>Priq</i> queues with a higher priority are always	served
	   first.  <i>Cbq</i> and <i>Hfsc</i>	queues with a higher priority are preferred in
	   the case of overload.

     <i>qlimit</i> &lt;<i>limit</i>&gt;
	   The maximum number of packets held in the queue.  The default is
	   50.

     The <i>scheduler</i> can get additional parameters with &lt;<i>scheduler</i>&gt;
     (&lt;<i>parameters</i>&gt;).  Parameters are as	follows:

     <i>default</i>	 Packets not matched by	another	queue are assigned to this
		 one.  Exactly one default queue is required.

     <i>red</i>	 Enable	RED (Random Early Detection) on	this queue.  RED drops
		 packets with a	probability proportional to the	average	queue
		 length.

     <i>rio</i>	 Enables RIO on	this queue.  RIO is RED	with IN/OUT, thus run-
		 ning RED two times more than RIO would	achieve	the same
		 effect.  RIO is currently not supported in the	GENERIC	ker-
		 nel.

     <i>ecn</i>	 Enables ECN (Explicit Congestion Notification)	on this	queue.
		 ECN implies RED.

     The <i>cbq</i> <i>scheduler</i> supports	an additional option:

     <i>borrow</i>	 The queue can borrow bandwidth	from the parent.

     The <i>hfsc</i> <i>scheduler</i>	supports some additional options:

     <i>realtime</i> &lt;<i>sc</i>&gt;
		 The minimum required bandwidth	for the	queue.

     <i>upperlimit</i>	&lt;<i>sc</i>&gt;
		 The maximum allowed bandwidth for the queue.

     <i>linkshare</i> &lt;<i>sc</i>&gt;
		 The bandwidth share of	a backlogged queue.

     &lt;<i>sc</i>&gt; is an	acronym	for <i>service</i> <i>curve</i>.

     The format	for service curve specifications is (<i>m1</i>, <i>d</i>, <i>m2</i>).  <i>m2</i> controls
     the bandwidth assigned to the queue.  <i>m1</i> and <i>d</i> are	optional and can be
     used to control the initial bandwidth assignment.	For the	first <i>d</i>	mil-
     liseconds the queue gets the bandwidth given as <i>m1</i>, afterwards the	value
     given in <i>m2</i>.

     Furthermore, with <i>cbq</i> and <i>hfsc</i>, child queues can be specified as in an
     <i>altq</i> declaration, thus building a tree of queues using a part of their
     parent's bandwidth.

     Packets can be assigned to	queues based on	filter rules by	using the
     <i>queue</i> keyword.  Normally only one <i>queue</i> is	specified; when	a second one
     is	specified it will instead be used for packets which have a <i>TOS</i> of
     <i>lowdelay</i> and for TCP ACKs with no data payload.

     To	continue the previous example, the examples below would	specify	the
     four referenced queues, plus a few	child queues.  Interactive <a href="/cgi/man.cgi?query=ssh&amp;sektion=1&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ssh(1)</a> ses-
     sions get priority	over bulk transfers like <a href="/cgi/man.cgi?query=scp&amp;sektion=1&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">scp(1)</a>	and <a href="/cgi/man.cgi?query=sftp&amp;sektion=1&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">sftp(1)</a>.  The
     queues may	then be	referenced by filtering	rules (see <i>PACKET</i> <i>FILTERING</i>
     below).

     queue std bandwidth 10% cbq(default)
     queue http	bandwidth 60% priority 2 cbq(borrow red) \
	   { employees,	developers }
     queue  developers bandwidth 75% cbq(borrow)
     queue  employees bandwidth	15%
     queue mail	bandwidth 10% priority 0 cbq(borrow ecn)
     queue ssh bandwidth 20% cbq(borrow) { ssh_interactive, ssh_bulk }
     queue  ssh_interactive bandwidth 50% priority 7 cbq(borrow)
     queue  ssh_bulk bandwidth 50% priority 0 cbq(borrow)

     block return out on dc0 inet all queue std
     pass out on dc0 inet proto	tcp from $developerhosts to any	port 80	\
	   queue developers
     pass out on dc0 inet proto	tcp from $employeehosts	to any port 80 \
	   queue employees
     pass out on dc0 inet proto	tcp from any to	any port 22 \
	   queue(ssh_bulk, ssh_interactive)
     pass out on dc0 inet proto	tcp from any to	any port 25 \
	   queue mail

<a name="TRANSLATION" href="#end"><b>TRANSLATION</b></a>
     Translation rules modify either the source	or destination address of the
     packets associated	with a stateful	connection.  A stateful	connection is
     automatically created to track packets matching such a rule as long as
     they are not blocked by the filtering section of <b>pf.conf</b>.	The transla-
     tion engine modifies the specified	address	and/or port in the packet,
     recalculates IP, TCP and UDP checksums as necessary, and passes it	to the
     packet filter for evaluation.

     Since translation occurs before filtering the filter engine will see
     packets as	they look after	any addresses and ports	have been translated.
     Filter rules will therefore have to filter	based on the translated
     address and port number.  Packets that match a translation	rule are only
     automatically passed if the <i>pass</i> modifier is given, otherwise they	are
     still subject to <i>block</i> and	<i>pass</i> rules.

     The state entry created permits <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> to keep track of the	original
     address for traffic associated with that state and	correctly direct
     return traffic for	that connection.

     Various types of translation are possible with pf:

     <i>binat</i>
	   A <i>binat</i> rule	specifies a bidirectional mapping between an external
	   IP netblock and an internal IP netblock.

     <i>nat</i>   A <i>nat</i> rule specifies	that IP	addresses are to be changed as the
	   packet traverses the	given interface.  This technique allows	one or
	   more	IP addresses on	the translating	host to	support	network	traf-
	   fic for a larger range of machines on an "inside" network.
	   Although in theory any IP address can be used on the	inside,	it is
	   strongly recommended	that one of the	address	ranges defined by RFC
	   1918	be used.  These	netblocks are:

	   10.0.0.0 - 10.255.255.255 (all of net 10, i.e., 10/8)
	   172.16.0.0 -	172.31.255.255 (i.e., 172.16/12)
	   192.168.0.0 - 192.168.255.255 (i.e.,	192.168/16)

     <i>rdr</i>   The packet is redirected to another destination and possibly	a dif-
	   ferent port.	 <i>rdr</i> rules can optionally specify port ranges instead
	   of single ports.  rdr ... port 2000:2999 -&gt; ... port	4000 redirects
	   ports 2000 to 2999 (inclusive) to port 4000.	 rdr ... port
	   2000:2999 -&gt;	... port 4000:*	redirects port 2000 to 4000, 2001 to
	   4001, ..., 2999 to 4999.

     In	addition to modifying the address, some	translation rules may modify
     source or destination ports for <a href="/cgi/man.cgi?query=tcp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">tcp(4)</a> or <a href="/cgi/man.cgi?query=udp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">udp(4)</a> connections; implicitly
     in	the case of <i>nat</i>	rules and explicitly in	the case of <i>rdr</i>	rules.	Port
     numbers are never translated with a <i>binat</i> rule.

     Evaluation	order of the translation rules is dependent on the type	of the
     translation rules and of the direction of a packet.  <i>binat</i>	rules are
     always evaluated first.  Then either the <i>rdr</i> rules	are evaluated on an
     inbound packet or the <i>nat</i> rules on	an outbound packet.  Rules of the same
     type are evaluated	in the same order in which they	appear in the ruleset.
     The first matching	rule decides what action is taken.

     The <i>no</i> option prefixed to a translation rule causes packets to remain
     untranslated, much	in the same way	as <i>drop</i>	<i>quick</i> works in the packet fil-
     ter (see below).  If no rule matches the packet it	is passed to the fil-
     ter engine	unmodified.

     Translation rules apply only to packets that pass through the specified
     interface,	and if no interface is specified, translation is applied to
     packets on	all interfaces.	 For instance, redirecting port	80 on an
     external interface	to an internal web server will only work for connec-
     tions originating from the	outside.  Connections to the address of	the
     external interface	from local hosts will not be redirected, since such
     packets do	not actually pass through the external interface.  Redirec-
     tions cannot reflect packets back through the interface they arrive on,
     they can only be redirected to hosts connected to different interfaces or
     to	the firewall itself.

     Note that redirecting external incoming connections to the	loopback
     address, as in

	   rdr on ne3 inet proto tcp to	port smtp -&gt; 127.0.0.1 port spamd

     will effectively allow an external	host to	connect	to daemons bound
     solely to the loopback address, circumventing the traditional blocking of
     such connections on a real	interface.  Unless this	effect is desired, any
     of	the local non-loopback addresses should	be used	as redirection target
     instead, which allows external connections	only to	daemons	bound to this
     address or	not bound to any address.

     See <i>TRANSLATION</i> <i>EXAMPLES</i> below.

<a name="PACKET_FILTERING" href="#end"><b>PACKET FILTERING</b></a>
     <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> has the ability to <i>block</i> and	<i>pass</i> packets based on attributes of
     their layer 3 (see	<a href="/cgi/man.cgi?query=ip&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ip(4)</a> and <a href="/cgi/man.cgi?query=ip6&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ip6(4)</a>) and layer 4 (see <a href="/cgi/man.cgi?query=icmp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">icmp(4)</a>, <a href="/cgi/man.cgi?query=icmp6&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">icmp6(4)</a>,
     <a href="/cgi/man.cgi?query=tcp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">tcp(4)</a>, <a href="/cgi/man.cgi?query=udp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">udp(4)</a>) headers.  In addition, packets may	also be	assigned to
     queues for	the purpose of bandwidth control.

     For each packet processed by the packet filter, the filter	rules are
     evaluated in sequential order, from first to last.	 The last matching
     rule decides what action is taken.	 If no rule matches the	packet,	the
     default action is to pass the packet.

     The following actions can be used in the filter:

     <i>block</i>
	   The packet is blocked.  There are a number of ways in which a <i>block</i>
	   rule	can behave when	blocking a packet.  The	default	behaviour is
	   to <i>drop</i> packets silently, however this can be overridden or made
	   explicit either globally, by	setting	the <i>block-policy</i> option, or on
	   a per-rule basis with one of	the following options:

	   <i>drop</i>	 The packet is silently	dropped.
	   <i>return-rst</i>
		 This applies only to <a href="/cgi/man.cgi?query=tcp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">tcp(4)</a> packets, and issues a TCP RST
		 which closes the connection.
	   <i>return-icmp</i>
	   <i>return-icmp6</i>
		 This causes ICMP messages to be returned for packets which
		 match the rule.  By default this is an	ICMP UNREACHABLE mes-
		 sage, however this can	be overridden by specifying a message
		 as a code or number.
	   <i>return</i>
		 This causes a TCP RST to be returned for <a href="/cgi/man.cgi?query=tcp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">tcp(4)</a> packets and
		 an ICMP UNREACHABLE for UDP and other packets.

	   Options returning ICMP packets currently have no effect if <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a>
	   operates on a <a href="/cgi/man.cgi?query=if_bridge&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">if_bridge(4)</a>, as the code to support this feature has
	   not yet been	implemented.

	   The simplest	mechanism to block everything by default and only pass
	   packets that	match explicit rules is	specify	a first	filter rule
	   of:

		 block all

     <i>pass</i>  The packet is passed; state is created unless the <i>no</i>	<i>state</i> option
	   is specified.

     By	default	<a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> filters packets statefully; the first time a packet
     matches a <i>pass</i> rule, a state entry	is created; for	subsequent packets the
     filter checks whether the packet matches any state.  If it	does, the
     packet is passed without evaluation of any	rules.	After the connection
     is	closed or times	out, the state entry is	automatically removed.

     This has several advantages.  For TCP connections,	comparing a packet to
     a state involves checking its sequence numbers, as	well as	TCP timestamps
     if	a <i>scrub</i>	<i>reassemble</i> <i>tcp</i> rule applies to the connection.	If these val-
     ues are outside the narrow	windows	of expected values, the	packet is
     dropped.  This prevents spoofing attacks, such as when an attacker	sends
     packets with a fake source	address/port but does not know the connec-
     tion's sequence numbers.  Similarly, <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a>	knows how to match ICMP
     replies to	states.	 For example,

	   pass	out inet proto icmp all	icmp-type echoreq

     allows echo requests (such	as those created by <a href="/cgi/man.cgi?query=ping&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ping(8)</a>) out statefully,
     and matches incoming echo replies correctly to states.

     Also, looking up states is	usually	faster than evaluating rules.  If
     there are 50 rules, all of	them are evaluated sequentially	in <a href="/cgi/man.cgi?query=O&amp;sektion=n&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">O(n)</a>.  Even
     with 50000	states,	only 16	comparisons are	needed to match	a state, since
     states are	stored in a binary search tree that allows searches in O(log2
     n).

     Furthermore, correct handling of ICMP error messages is critical to many
     protocols,	particularly TCP.  <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> matches ICMP error messages to	the
     correct connection, checks	them against connection	parameters, and	passes
     them if appropriate.  For example if an ICMP source quench	message	refer-
     ring to a stateful	TCP connection arrives,	it will	be matched to the
     state and get passed.

     Finally, state tracking is	required for <i>nat</i>, <i>binat</i>	and <i>rdr</i>	rules, in
     order to track address and	port translations and reverse the translation
     on	returning packets.

     <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> will	also create state for other protocols which are	effectively
     stateless by nature.  UDP packets are matched to states using only	host
     addresses and ports, and other protocols are matched to states using only
     the host addresses.

     If	stateless filtering of individual packets is desired, the <i>no</i> <i>state</i>
     keyword can be used to specify that state will not	be created if this is
     the last matching rule.  A	number of parameters can also be set to	affect
     how <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> handles state tracking.	See <i>STATEFUL</i> <i>TRACKING</i> <i>OPTIONS</i> below
     for further details.

<a name="PARAMETERS" href="#end"><b>PARAMETERS</b></a>
     The rule parameters specify the packets to	which a	rule applies.  A
     packet always comes in on,	or goes	out through, one interface.  Most
     parameters	are optional.  If a parameter is specified, the	rule only
     applies to	packets	with matching attributes.  Certain parameters can be
     expressed as lists, in which case <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a>	generates all needed rule com-
     binations.

     <i>in</i>	or <i>out</i>
	   This	rule applies to	incoming or outgoing packets.  If neither <i>in</i>
	   nor <i>out</i> are specified, the rule will	match packets in both direc-
	   tions.

     <i>log</i>   In addition to the action specified,	a log message is generated.
	   Only	the packet that	establishes the	state is logged, unless	the <i>no</i>
	   <i>state</i> option	is specified.  The logged packets are sent to a
	   <a href="/cgi/man.cgi?query=pflog&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pflog(4)</a> interface, by default <i>pflog0</i>.  This	interface is monitored
	   by the <a href="/cgi/man.cgi?query=pflogd&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pflogd(8)</a> logging daemon, which dumps	the logged packets to
	   the file <i>/var/log/pflog</i> in <a href="/cgi/man.cgi?query=pcap&amp;sektion=3&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pcap(3)</a> binary format.

     <i>log</i> <i>(all)</i>
	   Used	to force logging of all	packets	for a connection.  This	is not
	   necessary when <i>no</i> <i>state</i> is explicitly specified.  As	with <i>log</i>,
	   packets are logged to <a href="/cgi/man.cgi?query=pflog&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pflog(4)</a>.

     <i>log</i> <i>(user)</i>
	   Logs	the UNIX user ID of the	user that owns the socket and the PID
	   of the process that has the socket open where the packet is sourced
	   from	or destined to (depending on which socket is local).  This is
	   in addition to the normal information logged.

	   Only	the first packet logged	via <i>log</i>	<i>(all,</i> <i>user)</i> will have the user
	   credentials logged when using stateful matching.

     <i>log</i> <i>(to</i> &lt;<i>interface</i>&gt;)
	   Send	logs to	the specified <a href="/cgi/man.cgi?query=pflog&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pflog(4)</a> interface instead of <i>pflog0</i>.

     <i>quick</i>
	   If a	packet matches a rule which has	the <i>quick</i> option set, this
	   rule	is considered the last matching	rule, and evaluation of	subse-
	   quent rules is skipped.

     <i>on</i>	&lt;<i>interface</i>&gt;
	   This	rule applies only to packets coming in on, or going out
	   through, this particular interface or interface group.  For more
	   information on interface groups, see	the <b>group</b> keyword in
	   <a href="/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ifconfig(8)</a>.

     &lt;<i>af</i>&gt;  This	rule applies only to packets of	this address family.  Sup-
	   ported values are <i>inet</i> and <i>inet6</i>.

     <i>proto</i> &lt;<i>protocol</i>&gt;
	   This	rule applies only to packets of	this protocol.	Common proto-
	   cols	are <a href="/cgi/man.cgi?query=icmp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">icmp(4)</a>, <a href="/cgi/man.cgi?query=icmp6&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">icmp6(4)</a>, <a href="/cgi/man.cgi?query=tcp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">tcp(4)</a>, and <a href="/cgi/man.cgi?query=udp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">udp(4)</a>.  For	a list of all
	   the protocol	name to	number mappings	used by	<a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a>, see the file
	   <i>/etc/protocols</i>.

     <i>from</i> &lt;<i>source</i>&gt; <i>port</i>	&lt;<i>source</i>&gt; <i>os</i> &lt;<i>source</i>&gt; <i>to</i>	&lt;<i>dest</i>&gt; <i>port</i> &lt;<i>dest</i>&gt;
	   This	rule applies only to packets with the specified	source and
	   destination addresses and ports.

	   Addresses can be specified in CIDR notation (matching netblocks),
	   as symbolic host names, interface names or interface	group names,
	   or as any of	the following keywords:

	   <i>any</i>		   Any address.
	   <i>no-route</i>	   Any address which is	not currently routable.
	   <i>urpf-failed</i>	   Any source address that fails a unicast reverse
			   path	forwarding (URPF) check, i.e. packets coming
			   in on an interface other than that which holds the
			   route back to the packet's source address.
	   &lt;<i>table</i>&gt;	   Any address that matches the	given table.

	   Ranges of addresses are specified by	using the `-' operator.	 For
	   instance: ``10.1.1.10 - 10.1.1.12'' means all addresses from
	   10.1.1.10 to	10.1.1.12, hence addresses 10.1.1.10, 10.1.1.11, and
	   10.1.1.12.

	   Interface names and interface group names can have modifiers
	   appended:

	   <i>:network</i>	 Translates to the network(s) attached to the inter-
			 face.
	   <i>:broadcast</i>	 Translates to the interface's broadcast address(es).
	   <i>:peer</i>	 Translates to the point-to-point interface's peer
			 address(es).
	   <i>:0</i>		 Do not	include	interface aliases.

	   Host	names may also have the	<i>:0</i> option appended to restrict the
	   name	resolution to the first	of each	v4 and v6 address found.

	   Host	name resolution	and interface to address translation are done
	   at ruleset load-time.  When the address of an interface (or host
	   name) changes (under	DHCP or	PPP, for instance), the	ruleset	must
	   be reloaded for the change to be reflected in the kernel.  Sur-
	   rounding the	interface name (and optional modifiers)	in parentheses
	   changes this	behaviour.  When the interface name is surrounded by
	   parentheses,	the rule is automatically updated whenever the inter-
	   face	changes	its address.  The ruleset does not need	to be
	   reloaded.  This is especially useful	with <i>nat</i>.

	   Ports can be	specified either by number or by name.	For example,
	   port	80 can be specified as <i>www</i>.  For a list	of all port name to
	   number mappings used	by <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a>, see the file <i>/etc/services</i>.

	   Ports and ranges of ports are specified by using these operators:

		 =	 (equal)
		 !=	 (unequal)
		 &lt;	 (less than)
		 &lt;=	 (less than or equal)
		 &gt;	 (greater than)
		 &gt;=	 (greater than or equal)
		 :	 (range	including boundaries)
		 &gt;&lt;	 (range	excluding boundaries)
		 &lt;&gt;	 (except range)

	   `&gt;&lt;', `&lt;&gt;' and `:' are binary operators (they take two arguments).
	   For instance:

	   <i>port</i>	<i>2000:2004</i>
		       means `all ports	&gt;= 2000	and &lt;= 2004', hence ports
		       2000, 2001, 2002, 2003 and 2004.

	   <i>port</i>	<i>2000</i> __	<i>2004</i>
		       means `all ports	&gt; 2000 and &lt; 2004', hence ports	2001,
		       2002 and	2003.

	   <i>port</i>	<i>2000</i> __	<i>2004</i>
		       means `all ports	&lt; 2000 or &gt; 2004', hence ports 1-1999
		       and 2005-65535.

	   The operating system	of the source host can be specified in the
	   case	of TCP rules with the <i>OS</i> modifier.  See	the <i>OPERATING</i> <i>SYSTEM</i>
	   <i>FINGERPRINTING</i> section for more information.

	   The host, port and OS specifications	are optional, as in the	fol-
	   lowing examples:

		 pass in all
		 pass in from any to any
		 pass in proto tcp from	any port &lt;= 1024 to any
		 pass in proto tcp from	any to any port	25
		 pass in proto tcp from	10.0.0.0/8 port	&gt; 1024 \
		       to ! 10.1.2.3 port != ssh
		 pass in proto tcp from	any os "OpenBSD"

     <i>all</i>   This	is equivalent to "from any to any".

     <i>group</i> &lt;<i>group</i>&gt;
	   Similar to <i>user</i>, this rule only applies to packets of sockets owned
	   by the specified group.

     <i>user</i> &lt;<i>user</i>&gt;
	   This	rule only applies to packets of	sockets	owned by the specified
	   user.  For outgoing connections initiated from the firewall,	this
	   is the user that opened the connection.  For	incoming connections
	   to the firewall itself, this	is the user that listens on the	desti-
	   nation port.	 For forwarded connections, where the firewall is not
	   a connection	endpoint, the user and group are <i>unknown</i>.

	   All packets,	both outgoing and incoming, of one connection are
	   associated with the same user and group.  Only TCP and UDP packets
	   can be associated with users; for other protocols these parameters
	   are ignored.

	   User	and group refer	to the effective (as opposed to	the real) IDs,
	   in case the socket is created by a setuid/setgid process.  User and
	   group IDs are stored	when a socket is created; when a process cre-
	   ates	a listening socket as root (for	instance, by binding to	a
	   privileged port) and	subsequently changes to	another	user ID	(to
	   drop	privileges), the credentials will remain root.

	   User	and group IDs can be specified as either numbers or names.
	   The syntax is similar to the	one for	ports.	The value <i>unknown</i>
	   matches packets of forwarded	connections.  <i>unknown</i> can only be used
	   with	the operators <b>=</b>	and <b>!=</b>.	 Other constructs like <b>user</b> &gt;<b>=</b> <b>unknown</b>
	   are invalid.	 Forwarded packets with	unknown	user and group ID
	   match only rules that explicitly compare against <i>unknown</i> with the
	   operators <b>=</b> or <b>!=</b>.  For instance <b>user</b> &gt;<b>=</b> <b>0</b> does not match forwarded
	   packets.  The following example allows only selected	users to open
	   outgoing connections:

		 block out proto { tcp,	udp } all
		 pass  out proto { tcp,	udp } all user { &lt; 1000, dhartmei }

     <i>flags</i> &lt;<i>a</i>&gt; /&lt;<i>b</i>&gt; | /&lt;<i>b</i>&gt; | any
	   This	rule only applies to TCP packets that have the flags &lt;<i>a</i>&gt; set
	   out of set &lt;<i>b</i>&gt;.  Flags not specified	in &lt;<i>b</i>&gt; are ignored.  For
	   stateful connections, the default is	<i>flags</i> <i>S/SA</i>.  To	indicate that
	   flags should	not be checked at all, specify <i>flags</i> <i>any</i>.  The flags
	   are:	(F)IN, (S)YN, (R)ST, (P)USH, (A)CK, (U)RG, (E)CE, and C(W)R.

	   <i>flags</i> <i>S/S</i>   Flag SYN	is set.	 The other flags are ignored.

	   <i>flags</i> <i>S/SA</i>  This is the default setting for stateful	connections.
		       Out of SYN and ACK, exactly SYN may be set.  SYN,
		       SYN+PSH and SYN+RST match, but SYN+ACK, ACK and ACK+RST
		       do not.	This is	more restrictive than the previous
		       example.

	   <i>flags</i> <i>/SFRA</i>
		       If the first set	is not specified, it defaults to none.
		       All of SYN, FIN,	RST and	ACK must be unset.

	   Because <i>flags</i> <i>S/SA</i> is applied by default (unless <i>no</i> <i>state</i> is	speci-
	   fied), only the initial SYN packet of a TCP handshake will create a
	   state for a TCP connection.	It is possible to be less restrictive,
	   and allow state creation from intermediate (non-SYN)	packets, by
	   specifying <i>flags</i> <i>any</i>.  This will cause <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a>	to synchronize to
	   existing connections, for instance if one flushes the state table.
	   However, states created from	such intermediate packets may be miss-
	   ing connection details such as the TCP window scaling factor.
	   States which	modify the packet flow,	such as	those affected by <i>nat</i>,
	   <i>binat</i> or <i>rdr</i>	rules, <i>modulate</i>	or <i>synproxy</i> <i>state</i> options, or scrubbed
	   with	<i>reassemble</i> <i>tcp</i> will also not be	recoverable from intermediate
	   packets.  Such connections will stall and time out.

     <i>icmp-type</i> &lt;<i>type</i>&gt; <i>code</i> &lt;<i>code</i>&gt;

     <i>icmp6-type</i>	&lt;<i>type</i>&gt; <i>code</i> &lt;<i>code</i>&gt;
	   This	rule only applies to ICMP or ICMPv6 packets with the specified
	   type	and code.  Text	names for ICMP types and codes are listed in
	   <a href="/cgi/man.cgi?query=icmp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">icmp(4)</a> and <a href="/cgi/man.cgi?query=icmp6&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">icmp6(4)</a>.  This parameter is only valid for rules that
	   cover protocols ICMP	or ICMP6.  The protocol	and the	ICMP type
	   indicator (<i>icmp-type</i>	or <i>icmp6-type</i>) must match.

     <i>tos</i> &lt;<i>string</i>&gt; | &lt;<i>number</i>&gt;
	   This	rule applies to	packets	with the specified <i>TOS</i> bits set.  <i>TOS</i>
	   may be given	as one of <i>lowdelay</i>, <i>throughput</i>,	<i>reliability</i>, or	as
	   either hex or decimal.

	   For example,	the following rules are	identical:

		 pass all tos lowdelay
		 pass all tos 0x10
		 pass all tos 16

     <i>allow-opts</i>
	   By default, IPv4 packets with IP options or IPv6 packets with rout-
	   ing extension headers are blocked.  When <i>allow-opts</i> is specified
	   for a <i>pass</i> rule, packets that pass the filter based on that rule
	   (last matching) do so even if they contain IP options or routing
	   extension headers.  For packets that	match state, the rule that
	   initially created the state is used.	 The implicit <i>pass</i> rule	that
	   is used when	a packet does not match	any rules does not allow IP
	   options.

     <i>label</i> &lt;<i>string</i>&gt;
	   Adds	a <a href="/cgi/man.cgi?query=label&amp;sektion=name&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">label	(name)</a> to the rule, which can be used to identify the
	   rule.  For instance,	pfctl -s labels	shows per-rule statistics for
	   rules that have labels.

	   The following macros	can be used in labels:

		 <i>$if</i>	   The interface.
		 <i>$srcaddr</i>  The source IP address.
		 <i>$dstaddr</i>  The destination IP address.
		 <i>$srcport</i>  The source port specification.
		 <i>$dstport</i>  The destination port	specification.
		 <i>$proto</i>	   The protocol	name.
		 <i>$nr</i>	   The rule number.

	   For example:

		 ips = "{ 1.2.3.4, 1.2.3.5 }"
		 pass in proto tcp from	any to $ips \
		       port &gt; 1023 label "$dstaddr:$dstport"

	   expands to

		 pass in inet proto tcp	from any to 1.2.3.4 \
		       port &gt; 1023 label "1.2.3.4:&gt;1023"
		 pass in inet proto tcp	from any to 1.2.3.5 \
		       port &gt; 1023 label "1.2.3.5:&gt;1023"

	   The macro expansion for the <i>label</i> directive occurs only at configu-
	   ration file parse time, not during runtime.

     <i>queue</i> &lt;<i>queue</i>&gt; | (&lt;<i>queue</i>&gt;, &lt;<i>queue</i>&gt;)
	   Packets matching this rule will be assigned to the specified	queue.
	   If two queues are given, packets which have a <i>TOS</i> of	<i>lowdelay</i> and
	   TCP ACKs with no data payload will be assigned to the second	one.
	   See <i>QUEUEING</i>	for setup details.

	   For example:

		 pass in proto tcp to port 25 queue mail
		 pass in proto tcp to port 22 queue(ssh_bulk, ssh_prio)

     <b>set</b> <b>prio</b> <i>priority</i> | (<i>priority</i>, <i>priority</i>)
	   Packets matching this rule will be assigned a specific queueing
	   priority.  Priorities are assigned as integers 0 through 7.	If the
	   packet is transmitted on a <a href="/cgi/man.cgi?query=vlan&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">vlan(4)</a> interface, the queueing priority
	   will	be written as the priority code	point in the 802.1Q VLAN
	   header.  If two priorities are given, packets which have a TOS of
	   <b>lowdelay</b> and	TCP ACKs with no data payload will be assigned to the
	   second one.

	   For example:

		 pass in proto tcp to port 25 set prio 2
		 pass in proto tcp to port 22 set prio (2, 5)

     <i>tag</i> &lt;<i>string</i>&gt;
	   Packets matching this rule will be tagged with the specified
	   string.  The	tag acts as an internal	marker that can	be used	to
	   identify these packets later	on.  This can be used, for example, to
	   provide trust between interfaces and	to determine if	packets	have
	   been	processed by translation rules.	 Tags are "sticky", meaning
	   that	the packet will	be tagged even if the rule is not the last
	   matching rule.  Further matching rules can replace the tag with a
	   new one but will not	remove a previously applied tag.  A packet is
	   only	ever assigned one tag at a time.  Packet tagging can be	done
	   during <i>nat</i>, <i>rdr</i>, or <i>binat</i> rules in addition to filter rules.	 Tags
	   take	the same macros	as labels (see above).

     <i>tagged</i> &lt;<i>string</i>&gt;
	   Used	with filter, translation or scrub rules	to specify that	pack-
	   ets must already be tagged with the given tag in order to match the
	   rule.  Inverse tag matching can also	be done	by specifying the <b>!</b>
	   operator before the <i>tagged</i> keyword.

     <i>rtable</i> &lt;<i>number</i>&gt;
	   Used	to select an alternate routing table for the routing lookup.
	   Only	effective before the route lookup happened, i.e. when filter-
	   ing inbound.

     <i>divert-to</i> &lt;<i>host</i>&gt; <i>port</i> &lt;<i>port</i>&gt;
	   Used	to redirect packets to a local socket bound to <i>host</i> and	<i>port</i>.
	   The packets will not	be modified, so	<a href="/cgi/man.cgi?query=getsockname&amp;sektion=2&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">getsockname(2)</a> on the socket
	   will	return the original destination	address	of the packet.

     <i>divert-reply</i>
	   Used	to receive replies for sockets that are	bound to addresses
	   which are not local to the machine.	See <a href="/cgi/man.cgi?query=setsockopt&amp;sektion=2&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">setsockopt(2)</a> for informa-
	   tion	on how to bind these sockets.

     <i>probability</i> &lt;<i>number</i>&gt;
	   A probability attribute can be attached to a	rule, with a value set
	   between 0 and 1, bounds not included.  In that case,	the rule will
	   be honoured using the given probability value only.	For example,
	   the following rule will drop	20% of incoming	ICMP packets:

		 block in proto	icmp probability 20%

     <i>prio</i> &lt;<i>number</i>&gt;
	   Only	match packets which have the given queueing priority assigned.

<a name="ROUTING" href="#end"><b>ROUTING</b></a>
     If	a packet matches a rule	with a route option set, the packet filter
     will route	the packet according to	the type of route option.  When	such a
     rule creates state, the route option is also applied to all packets
     matching the same connection.

     <i>fastroute</i>
	   The <i>fastroute</i> option	does a normal route lookup to find the next
	   hop for the packet.

     <i>route-to</i>
	   The <i>route-to</i>	option routes the packet to the	specified interface
	   with	an optional address for	the next hop.  When a <i>route-to</i> rule
	   creates state, only packets that pass in the	same direction as the
	   filter rule specifies will be routed	in this	way.  Packets passing
	   in the opposite direction (replies) are not affected	and are	routed
	   normally.

     <i>reply-to</i>
	   The <i>reply-to</i>	option is similar to <i>route-to</i>, but routes packets that
	   pass	in the opposite	direction (replies) to the specified inter-
	   face.  Opposite direction is	only defined in	the context of a state
	   entry, and <i>reply-to</i> is useful only in rules that create state.  It
	   can be used on systems with multiple	external connections to	route
	   all outgoing	packets	of a connection	through	the interface the
	   incoming connection arrived through (symmetric routing enforce-
	   ment).

     <i>dup-to</i>
	   The <i>dup-to</i> option creates a duplicate of the	packet and routes it
	   like	<i>route-to</i>.  The original	packet gets routed as it normally
	   would.

<a name="POOL_OPTIONS" href="#end"><b>POOL OPTIONS</b></a>
     For <i>nat</i> and <i>rdr</i> rules, (as	well as	for the	<i>route-to</i>, <i>reply-to</i> and <i>dup-to</i>
     rule options) for which there is a	single redirection address which has a
     subnet mask smaller than 32 for IPv4 or 128 for IPv6 (more	than one IP
     address), a variety of different methods for assigning this address can
     be	used:

     <i>bitmask</i>
	   The <i>bitmask</i> option applies the network portion of the redirection
	   address to the address to be	modified (source with <i>nat</i>, destination
	   with	<i>rdr</i>).

     <i>random</i>
	   The <i>random</i> option selects an	address	at random within the defined
	   block of addresses.

     <i>source-hash</i>
	   The <i>source-hash</i> option uses a hash of the source address to deter-
	   mine	the redirection	address, ensuring that the redirection address
	   is always the same for a given source.  An optional key can be
	   specified after this	keyword	either in hex or as a string; by
	   default <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a> randomly generates a key for source-hash every
	   time	the ruleset is reloaded.

     <i>round-robin</i>
	   The <i>round-robin</i> option loops	through	the redirection	address(es).

	   When	more than one redirection address is specified,	<i>round-robin</i> is
	   the only permitted pool type.

     <i>static-port</i>
	   With	<i>nat</i> rules, the <i>static-port</i> option prevents <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> from modify-
	   ing the source port on TCP and UDP packets.

     Additionally, the <i>sticky-address</i> option can be specified to help ensure
     that multiple connections from the	same source are	mapped to the same re-
     direction address.	 This option can be used with the <i>random</i> and
     <i>round-robin</i> pool options.	Note that by default these associations	are
     destroyed as soon as there	are no longer states which refer to them; in
     order to make the mappings	last beyond the	lifetime of the	states,
     increase the global options with <i>set</i> <i>timeout</i> <i>src.track</i>.  See <i>STATEFUL</i>
     <i>TRACKING</i> <i>OPTIONS</i> for more ways to control the source tracking.

<a name="STATE_MODULATION" href="#end"><b>STATE MODULATION</b></a>
     Much of the security derived from TCP is attributable to how well the
     initial sequence numbers (ISNs) are chosen.  Some popular stack implemen-
     tations choose <i>very</i> poor ISNs and thus are	normally susceptible to	ISN
     prediction	exploits.  By applying a <i>modulate</i> <i>state</i>	rule to	a TCP connec-
     tion, <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> will create a high quality random sequence number for each
     connection	endpoint.

     The <i>modulate</i> <i>state</i>	directive implicitly keeps state on the	rule and is
     only applicable to	TCP connections.

     For instance:

	   block all
	   pass	out proto tcp from any to any modulate state
	   pass	in  proto tcp from any to any port 25 flags S/SFRA modulate state

     Note that modulated connections will not recover when the state table is
     lost (firewall reboot, flushing the state table, etc...).	<a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> will not
     be	able to	infer a	connection again after the state table flushes the
     connection's modulator.  When the state is	lost, the connection may be
     left dangling until the respective	endpoints time out the connection.  It
     is	possible on a fast local network for the endpoints to start an ACK
     storm while trying	to resynchronize after the loss	of the modulator.  The
     default <i>flags</i> settings (or	a more strict equivalent) should be used on
     <i>modulate</i> <i>state</i> rules to prevent ACK storms.

     Note that alternative methods are available to prevent loss of the	state
     table and allow for firewall failover.  See <a href="/cgi/man.cgi?query=carp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">carp(4)</a> and <a href="/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfsync(4)</a> for
     further information.

<a name="SYN_PROXY" href="#end"><b>SYN PROXY</b></a>
     By	default, <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> passes packets that are part of a <a href="/cgi/man.cgi?query=tcp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">tcp(4)</a>	handshake
     between the endpoints.  The <i>synproxy</i> <i>state</i>	option can be used to cause
     <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> itself to complete the handshake with the active endpoint, perform
     a handshake with the passive endpoint, and	then forward packets between
     the endpoints.

     No	packets	are sent to the	passive	endpoint before	the active endpoint
     has completed the handshake, hence	so-called SYN floods with spoofed
     source addresses will not reach the passive endpoint, as the sender can't
     complete the handshake.

     The proxy is transparent to both endpoints, they each see a single	con-
     nection from/to the other endpoint.  <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a>	chooses	random initial
     sequence numbers for both handshakes.  Once the handshakes	are completed,
     the sequence number modulators (see previous section) are used to trans-
     late further packets of the connection.  <i>synproxy</i> <i>state</i> includes <i>modulate</i>
     <i>state</i>.

     Rules with	<i>synproxy</i> will not work if <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a>	operates on a <a href="/cgi/man.cgi?query=bridge&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">bridge(4)</a>.

     Example:

	   pass	in proto tcp from any to any port www synproxy state

<a name="STATEFUL_TRACKING_OPTIONS" href="#end"><b>STATEFUL TRACKING OPTIONS</b></a>
     A number of options related to stateful tracking can be applied on	a per-
     rule basis.  <i>keep</i> <i>state</i>, <i>modulate</i> <i>state</i> and <i>synproxy</i> <i>state</i>	support	these
     options, and <i>keep</i> <i>state</i> must be specified explicitly to apply options to
     a rule.

     <i>max</i> &lt;<i>number</i>&gt;
	   Limits the number of	concurrent states the rule may create.	When
	   this	limit is reached, further packets that would create state will
	   not match this rule until existing states time out.
     <i>no-sync</i>
	   Prevent state changes for states created by this rule from appear-
	   ing on the <a href="/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfsync(4)</a>	interface.
     &lt;<i>timeout</i>&gt; &lt;<i>seconds</i>&gt;
	   Changes the timeout values used for states created by this rule.
	   For a list of all valid timeout names, see <i>OPTIONS</i> above.
     <i>sloppy</i>
	   Uses	a sloppy TCP connection	tracker	that does not check sequence
	   numbers at all, which makes insertion and ICMP teardown attacks way
	   easier.  This is intended to	be used	in situations where one	does
	   not see all packets of a connection,	e.g. in	asymmetric routing
	   situations.	Cannot be used with modulate or	synproxy state.
     <i>pflow</i>
	   States created by this rule are exported on the <a href="/cgi/man.cgi?query=pflow&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pflow(4)</a> interface.

     Multiple options can be specified,	separated by commas:

	   pass	in proto tcp from any to any \
		 port www keep state \
		 (max 100, source-track	rule, max-src-nodes 75,	\
		 max-src-states	3, tcp.established 60, tcp.closing 5)

     When the <i>source-track</i> keyword is specified, the number of states per
     source IP is tracked.

     <i>source-track</i> <i>rule</i>
	   The maximum number of states	created	by this	rule is	limited	by the
	   rule's <i>max-src-nodes</i>	and <i>max-src-states</i> options.  Only state
	   entries created by this particular rule count toward	the rule's
	   limits.
     <i>source-track</i> <i>global</i>
	   The number of states	created	by all rules that use this option is
	   limited.  Each rule can specify different <i>max-src-nodes</i> and
	   <i>max-src-states</i> options, however state entries created by any	par-
	   ticipating rule count towards each individual rule's	limits.

     The following limits can be set:

     <i>max-src-nodes</i> &lt;<i>number</i>&gt;
	   Limits the maximum number of	source addresses which can simultane-
	   ously have state table entries.
     <i>max-src-states</i> &lt;<i>number</i>&gt;
	   Limits the maximum number of	simultaneous state entries that	a sin-
	   gle source address can create with this rule.

     For stateful TCP connections, limits on established connections (connec-
     tions which have completed	the TCP	3-way handshake) can also be enforced
     per source	IP.

     <i>max-src-conn</i> &lt;<i>number</i>&gt;
	   Limits the maximum number of	simultaneous TCP connections which
	   have	completed the 3-way handshake that a single host can make.
     <i>max-src-conn-rate</i> &lt;<i>number</i>&gt;	/ &lt;<i>seconds</i>&gt;
	   Limit the rate of new connections over a time interval.  The	con-
	   nection rate	is an approximation calculated as a moving average.

     Because the 3-way handshake ensures that the source address is not	being
     spoofed, more aggressive action can be taken based	on these limits.  With
     the <i>overload</i> &lt;<i>table</i>&gt; state	option,	source IP addresses which hit either
     of	the limits on established connections will be added to the named ta-
     ble.  This	table can be used in the ruleset to block further activity
     from the offending	host, redirect it to a tarpit process, or restrict its
     bandwidth.

     The optional <i>flush</i>	keyword	kills all states created by the	matching rule
     which originate from the host which exceeds these limits.	The <i>global</i>
     modifier to the flush command kills all states originating	from the
     offending host, regardless	of which rule created the state.

     For example, the following	rules will protect the webserver against hosts
     making more than 100 connections in 10 seconds.  Any host which connects
     faster than this rate will	have its address added to the &lt;bad_hosts&gt; ta-
     ble and have all states originating from it flushed.  Any new packets
     arriving from this	host will be dropped unconditionally by	the block
     rule.

	   block quick from &lt;bad_hosts&gt;
	   pass	in on $ext_if proto tcp	to $webserver port www keep state \
		   (max-src-conn-rate 100/10, overload &lt;bad_hosts&gt; flush global)

<a name="OPERATING_SYSTEM_FINGERPRINTING" href="#end"><b>OPERATING SYSTEM FINGERPRINTING</b></a>
     Passive OS	Fingerprinting is a mechanism to inspect nuances of a TCP con-
     nection's initial SYN packet and guess at the host's operating system.
     Unfortunately these nuances are easily spoofed by an attacker so the fin-
     gerprint is not useful in making security decisions.  But the fingerprint
     is	typically accurate enough to make policy decisions upon.

     The fingerprints may be specified by operating system class, by version,
     or	by subtype/patchlevel.	The class of an	operating system is typically
     the vendor	or genre and would be OpenBSD for the <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> firewall itself.
     The version of the	oldest available OpenBSD release on the	main FTP site
     would be 2.6 and the fingerprint would be written

	   "OpenBSD 2.6"

     The subtype of an operating system	is typically used to describe the
     patchlevel	if that	patch led to changes in	the TCP	stack behavior.	 In
     the case of OpenBSD, the only subtype is for a fingerprint	that was nor-
     malized by	the <i>no-df</i> scrub	option and would be specified as

	   "OpenBSD 3.3	no-df"

     Fingerprints for most popular operating systems are provided by <a href="/cgi/man.cgi?query=pf.os&amp;sektion=5&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf.os(5)</a>.
     Once <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a>	is running, a complete list of known operating system finger-
     prints may	be listed by running:

	   # pfctl -so

     Filter rules can enforce policy at	any level of operating system specifi-
     cation assuming a fingerprint is present.	Policy could limit traffic to
     approved operating	systems	or even	ban traffic from hosts that aren't at
     the latest	service	pack.

     The <i>unknown</i> class can also	be used	as the fingerprint which will match
     packets for which no operating system fingerprint is known.

     Examples:

	   pass	 out proto tcp from any	os OpenBSD
	   block out proto tcp from any	os Doors
	   block out proto tcp from any	os "Doors PT"
	   block out proto tcp from any	os "Doors PT SP3"
	   block out from any os "unknown"
	   pass	on lo0 proto tcp from any os "OpenBSD 3.3 lo0"

     Operating system fingerprinting is	limited	only to	the TCP	SYN packet.
     This means	that it	will not work on other protocols and will not match a
     currently established connection.

     Caveat: operating system fingerprints are occasionally wrong.  There are
     three problems: an	attacker can trivially craft his packets to appear as
     any operating system he chooses; an operating system patch	could change
     the stack behavior	and no fingerprints will match it until	the database
     is	updated; and multiple operating	systems	may have the same fingerprint.

<a name="BLOCKING_SPOOFED_TRAFFIC" href="#end"><b>BLOCKING SPOOFED TRAFFIC</b></a>
     "Spoofing"	is the faking of IP addresses, typically for malicious pur-
     poses.  The <i>antispoof</i> directive expands to	a set of filter	rules which
     will block	all traffic with a source IP from the network(s) directly con-
     nected to the specified interface(s) from entering	the system through any
     other interface.

     For example, the line

	   antispoof for lo0

     expands to

	   block drop in on ! lo0 inet from 127.0.0.1/8	to any
	   block drop in on ! lo0 inet6	from ::1 to any

     For non-loopback interfaces, there	are additional rules to	block incoming
     packets with a source IP address identical	to the interface's IP(s).  For
     example, assuming the interface wi0 had an	IP address of 10.0.0.1 and a
     netmask of	255.255.255.0, the line

	   antispoof for wi0 inet

     expands to

	   block drop in on ! wi0 inet from 10.0.0.0/24	to any
	   block drop in inet from 10.0.0.1 to any

     Caveat: Rules created by the <i>antispoof</i> directive interfere	with packets
     sent over loopback	interfaces to local addresses.	One should pass	these
     explicitly.

<a name="FRAGMENT_HANDLING" href="#end"><b>FRAGMENT HANDLING</b></a>
     The size of IP datagrams (packets)	can be significantly larger than the
     maximum transmission unit (MTU) of	the network.  In cases when it is nec-
     essary or more efficient to send such large packets, the large packet
     will be fragmented	into many smaller packets that will each fit onto the
     wire.  Unfortunately for a	firewalling device, only the first logical
     fragment will contain the necessary header	information for	the subproto-
     col that allows <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> to filter on	things such as TCP ports or to perform
     NAT.

     Besides the use of	<i>scrub</i> rules as described in <i>TRAFFIC</i> <i>NORMALIZATION</i>
     above, there are three options for	handling fragments in the packet fil-
     ter.

     One alternative is	to filter individual fragments with filter rules.  If
     no	<i>scrub</i> rule applies to a	fragment, it is	passed to the filter.  Filter
     rules with	matching IP header parameters decide whether the fragment is
     passed or blocked,	in the same way	as complete packets are	filtered.
     Without reassembly, fragments can only be filtered	based on IP header
     fields (source/destination	address, protocol), since subprotocol header
     fields are	not available (TCP/UDP port numbers, ICMP code/type).  The
     <i>fragment</i> option can be used to restrict filter rules to apply only	to
     fragments,	but not	complete packets.  Filter rules	without	the <i>fragment</i>
     option still apply	to fragments, if they only specify IP header fields.
     For instance, the rule

	   pass	in proto tcp from any to any port 80

     never applies to a	fragment, even if the fragment is part of a TCP	packet
     with destination port 80, because without reassembly this information is
     not available for each fragment.  This also means that fragments cannot
     create new	or match existing state	table entries, which makes stateful
     filtering and address translation (NAT, redirection) for fragments	impos-
     sible.

     It's also possible	to reassemble only certain fragments by	specifying
     source or destination addresses or	protocols as parameters	in <i>scrub</i>
     rules.

     In	most cases, the	benefits of reassembly outweigh	the additional memory
     cost, and it's recommended	to use <i>scrub</i> rules to reassemble all fragments
     via the <i>fragment</i> <i>reassemble</i> modifier.

     The memory	allocated for fragment caching can be limited using <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a>.
     Once this limit is	reached, fragments that	would have to be cached	are
     dropped until other entries time out.  The	timeout	value can also be
     adjusted.

     When forwarding reassembled IPv6 packets, pf refragments them with	the
     original maximum fragment size.  This allows the sender to	determine the
     optimal fragment size by path MTU discovery.

<a name="ANCHORS" href="#end"><b>ANCHORS</b></a>
     Besides the main ruleset, <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a>	can load rulesets into <i>anchor</i> attach-
     ment points.  An <i>anchor</i> is	a container that can hold rules, address
     tables, and other anchors.

     An	<i>anchor</i> has a name which	specifies the path where <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a> can be used
     to	access the anchor to perform operations	on it, such as attaching child
     anchors to	it or loading rules into it.  Anchors may be nested, with com-
     ponents separated by `/' characters, similar to how file system hierar-
     chies are laid out.  The main ruleset is actually the default anchor, so
     filter and	translation rules, for example,	may also be contained in any
     anchor.

     An	anchor can reference another <i>anchor</i> attachment point using the follow-
     ing kinds of rules:

     <i>nat-anchor</i>	&lt;<i>name</i>&gt;
	   Evaluates the <i>nat</i> rules in the specified <i>anchor</i>.

     <i>rdr-anchor</i>	&lt;<i>name</i>&gt;
	   Evaluates the <i>rdr</i> rules in the specified <i>anchor</i>.

     <i>binat-anchor</i> &lt;<i>name</i>&gt;
	   Evaluates the <i>binat</i> rules in	the specified <i>anchor</i>.

     <i>anchor</i> &lt;<i>name</i>&gt;
	   Evaluates the filter	rules in the specified <i>anchor</i>.

     <i>load</i> <i>anchor</i> &lt;<i>name</i>&gt;	<i>from</i> &lt;<i>file</i>&gt;
	   Loads the rules from	the specified file into	the anchor <i>name</i>.

     When evaluation of	the main ruleset reaches an <i>anchor</i> rule, <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a> will
     proceed to	evaluate all rules specified in	that anchor.

     Matching filter and translation rules marked with the <i>quick</i> option	are
     final and abort the evaluation of the rules in other anchors and the main
     ruleset.  If the <i>anchor</i> itself is marked with the <i>quick</i> option, ruleset
     evaluation	will terminate when the	anchor is exited if the	packet is
     matched by	any rule within	the anchor.

     <i>anchor</i> rules are evaluated	relative to the	anchor in which	they are con-
     tained.  For example, all <i>anchor</i> rules specified in the main ruleset will
     reference anchor attachment points	underneath the main ruleset, and
     <i>anchor</i> rules specified in a file loaded from a <i>load</i> <i>anchor</i>	rule will be
     attached under that anchor	point.

     Rules may be contained in <i>anchor</i> attachment points	which do not contain
     any rules when the	main ruleset is	loaded,	and later such anchors can be
     manipulated through <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a> without reloading the	main ruleset or	other
     anchors.  For example,

	   ext_if = "kue0"
	   block on $ext_if all
	   anchor spam
	   pass	out on $ext_if all
	   pass	in on $ext_if proto tcp	from any \
		 to $ext_if port smtp

     blocks all	packets	on the external	interface by default, then evaluates
     all rules in the <i>anchor</i> named "spam", and finally passes all outgoing
     connections and incoming connections to port 25.

	   # echo "block in quick from 1.2.3.4 to any" | \
		 pfctl -a spam -f -

     This loads	a single rule into the <i>anchor</i>, which blocks all	packets	from a
     specific address.

     The anchor	can also be populated by adding	a <i>load</i> <i>anchor</i> rule after the
     <i>anchor</i> rule:

	   anchor spam
	   load	anchor spam from "/etc/pf-spam.conf"

     When <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a> loads <b>pf.conf</b>, it will also load all	the rules from the
     file <i>/etc/pf-spam.conf</i> into the anchor.

     Optionally, <i>anchor</i>	rules can specify packet filtering parameters using
     the same syntax as	filter rules.  When parameters are used, the <i>anchor</i>
     rule is only evaluated for	matching packets.  This	allows conditional
     evaluation	of anchors, like:

	   block on $ext_if all
	   anchor spam proto tcp from any to any port smtp
	   pass	out on $ext_if all
	   pass	in on $ext_if proto tcp	from any to $ext_if port smtp

     The rules inside <i>anchor</i> spam are only evaluated for <i>tcp</i> packets with des-
     tination port 25.	Hence,

	   # echo "block in quick from 1.2.3.4 to any" | \
		 pfctl -a spam -f -

     will only block connections from 1.2.3.4 to port 25.

     Anchors may end with the asterisk (`*') character,	which signifies	that
     all anchors attached at that point	should be evaluated in the alphabeti-
     cal ordering of their anchor name.	 For example,

	   anchor "spam/*"

     will evaluate each	rule in	each anchor attached to	the spam anchor.  Note
     that it will only evaluate	anchors	that are directly attached to the spam
     anchor, and will not descend to evaluate anchors recursively.

     Since anchors are evaluated relative to the anchor	in which they are con-
     tained, there is a	mechanism for accessing	the parent and ancestor
     anchors of	a given	anchor.	 Similar to file system	path name resolution,
     if	the sequence ``..'' appears as an anchor path component, the parent
     anchor of the current anchor in the path evaluation at that point will
     become the	new current anchor.  As	an example, consider the following:

	   # echo ' anchor "spam/allowed" ' | pfctl -f -
	   # echo -e ' anchor "../banned" \n pass' | \
		 pfctl -a spam/allowed -f -

     Evaluation	of the main ruleset will lead into the spam/allowed anchor,
     which will	evaluate the rules in the spam/banned anchor, if any, before
     finally evaluating	the <i>pass</i> rule.

     Filter rule <i>anchors</i> can also be loaded inline in the ruleset within a
     brace ('{'	'}') delimited block.  Brace delimited blocks may contain
     rules or other brace-delimited blocks.  When anchors are loaded this way
     the anchor	name becomes optional.

	   anchor "external" on	egress {
		   block
		   anchor out {
			   pass	proto tcp from any to port { 25, 80, 443 }
		   }
		   pass	in proto tcp to	any port 22
	   }

     Since the parser specification for	anchor names is	a string, any refer-
     ence to an	anchor name containing `/' characters will require double
     quote (`"') characters around the anchor name.

<a name="TRANSLATION_EXAMPLES" href="#end"><b>TRANSLATION EXAMPLES</b></a>
     This example maps incoming	requests on port 80 to port 8080, on which a
     daemon is running (because, for example, it is not	run as root, and
     therefore lacks permission	to bind	to port	80).

     # use a macro for the interface name, so it can be	changed	easily
     ext_if = "ne3"

     # map daemon on 8080 to appear to be on 80
     rdr on $ext_if proto tcp from any to any port 80 -&gt; 127.0.0.1 port	8080

     If	the <i>pass</i> modifier is given, packets matching the translation rule are
     passed without inspecting the filter rules:

     rdr pass on $ext_if proto tcp from	any to any port	80 -&gt; 127.0.0.1	\
	   port	8080

     In	the example below, vlan12 is configured	as 192.168.168.1; the machine
     translates	all packets coming from	192.168.168.0/24 to 204.92.77.111 when
     they are going out	any interface except vlan12.  This has the net effect
     of	making traffic from the	192.168.168.0/24 network appear	as though it
     is	the Internet routable address 204.92.77.111 to nodes behind any	inter-
     face on the router	except for the nodes on	vlan12.	 (Thus,	192.168.168.1
     can talk to the 192.168.168.0/24 nodes.)

     nat on ! vlan12 from 192.168.168.0/24 to any -&gt; 204.92.77.111

     In	the example below, the machine sits between a fake internal
     144.19.74.*  network, and a routable external IP of 204.92.77.100.	 The
     <i>no</i>	<i>nat</i> rule excludes protocol AH from being translated.

     # NO NAT
     no	nat on $ext_if proto ah	from 144.19.74.0/24 to any
     nat on $ext_if from 144.19.74.0/24	to any -&gt; 204.92.77.100

     In	the example below, packets bound for one specific server, as well as
     those generated by	the sysadmins are not proxied; all other connections
     are.

     # NO RDR
     no	rdr on $int_if proto { tcp, udp	} from any to $server port 80
     no	rdr on $int_if proto { tcp, udp	} from $sysadmins to any port 80
     rdr on $int_if proto { tcp, udp } from any	to any port 80 -&gt; 127.0.0.1 \
	   port	80

     This longer example uses both a NAT and a redirection.  The external
     interface has the address 157.161.48.183.	On localhost, we are running
     <a href="/cgi/man.cgi?query=ftp-proxy&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ftp-proxy(8)</a>, waiting for FTP sessions to be redirected to	it.  The three
     mandatory anchors for <a href="/cgi/man.cgi?query=ftp-proxy&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ftp-proxy(8)</a>	are omitted from this example; see the
     <a href="/cgi/man.cgi?query=ftp-proxy&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ftp-proxy(8)</a> manpage.

     # NAT
     # Translate outgoing packets' source addresses (any protocol).
     # In this case, any address but the gateway's external address is mapped.
     nat on $ext_if inet from !	($ext_if) to any -&gt; ($ext_if)

     # NAT PROXYING
     # Map outgoing packets' source port to an assigned	proxy port instead of
     # an arbitrary port.
     # In this case, proxy outgoing isakmp with	port 500 on the	gateway.
     nat on $ext_if inet proto udp from	any port = isakmp to any -&gt; ($ext_if) \
	   port	500

     # BINAT
     # Translate outgoing packets' source address (any protocol).
     # Translate incoming packets' destination address to an internal machine
     # (bidirectional).
     binat on $ext_if from 10.1.2.150 to any -&gt;	$ext_if

     # RDR
     # Translate incoming packets' destination addresses.
     # As an example, redirect a TCP and UDP port to an	internal machine.
     rdr on $ext_if inet proto tcp from	any to ($ext_if) port 8080 \
	   -&gt; 10.1.2.151 port 22
     rdr on $ext_if inet proto udp from	any to ($ext_if) port 8080 \
	   -&gt; 10.1.2.151 port 53

     # RDR
     # Translate outgoing ftp control connections to send them to localhost
     # for proxying with <a href="/cgi/man.cgi?query=ftp-proxy&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ftp-proxy(8)</a> running on port 8021.
     rdr on $int_if proto tcp from any to any port 21 -&gt; 127.0.0.1 port	8021

     In	this example, a	NAT gateway is set up to translate internal addresses
     using a pool of public addresses (192.0.2.16/28) and to redirect incoming
     web server	connections to a group of web servers on the internal network.

     # NAT LOAD	BALANCE
     # Translate outgoing packets' source addresses using an address pool.
     # A given source address is always	translated to the same pool address by
     # using the source-hash keyword.
     nat on $ext_if inet from any to any -&gt; 192.0.2.16/28 source-hash

     # RDR ROUND ROBIN
     # Translate incoming web server connections to a group of web servers on
     # the internal network.
     rdr on $ext_if proto tcp from any to any port 80 \
	   -&gt; {	10.1.2.155, 10.1.2.160,	10.1.2.161 } round-robin

<a name="FILTER_EXAMPLES" href="#end"><b>FILTER EXAMPLES</b></a>
     # The external interface is kue0
     # (157.161.48.183,	the only routable address)
     # and the private network is 10.0.0.0/8, for which	we are doing NAT.

     # use a macro for the interface name, so it can be	changed	easily
     ext_if = "kue0"

     # normalize all incoming traffic
     scrub in on $ext_if all fragment reassemble

     # block and log everything	by default
     block return log on $ext_if all

     # block anything coming from source we have no back routes	for
     block in from no-route to any

     # block packets whose ingress interface does not match the	one in
     # the route back to their source address
     block in from urpf-failed to any

     # block and log outgoing packets that do not have our address as source,
     # they are	either spoofed or something is misconfigured (NAT disabled,
     # for instance), we want to be nice and do	not send out garbage.
     block out log quick on $ext_if from ! 157.161.48.183 to any

     # silently	drop broadcasts	(cable modem noise)
     block in quick on $ext_if from any	to 255.255.255.255

     # block and log incoming packets from reserved address space and invalid
     # addresses, they are either spoofed or misconfigured, we cannot reply to
     # them anyway (hence, no return-rst).
     block in log quick	on $ext_if from	{ 10.0.0.0/8, 172.16.0.0/12, \
	   192.168.0.0/16, 255.255.255.255/32 }	to any

     # ICMP

     # pass out/in certain ICMP	queries	and keep state (ping)
     # state matching is done on host addresses	and ICMP id (not type/code),
     # so replies (like	0/0 for	8/0) will match	queries
     # ICMP error messages (which always refer to a TCP/UDP packet) are
     # handled by the TCP/UDP states
     pass on $ext_if inet proto	icmp all icmp-type 8 code 0

     # UDP

     # pass out	all UDP	connections and	keep state
     pass out on $ext_if proto udp all

     # pass in certain UDP connections and keep	state (DNS)
     pass in on	$ext_if	proto udp from any to any port domain

     # TCP

     # pass out	all TCP	connections and	modulate state
     pass out on $ext_if proto tcp all modulate	state

     # pass in certain TCP connections and keep	state (SSH, SMTP, DNS, IDENT)
     pass in on	$ext_if	proto tcp from any to any port { ssh, smtp, domain, \
	   auth	}

     # Do not allow Windows 9x SMTP connections	since they are typically
     # a viral worm. Alternately we could limit	these OSes to 1	connection each.
     block in on $ext_if proto tcp from	any os {"Windows 95", "Windows 98"} \
	   to any port smtp

     # IPv6
     # pass in/out all IPv6 traffic: note that we have to enable this in two
     # different ways, on both our physical interface and our tunnel
     pass quick	on gif0	inet6
     pass quick	on $ext_if proto ipv6

     # Packet Tagging

     # three interfaces: $int_if, $ext_if, and $wifi_if	(wireless). NAT	is
     # being done on $ext_if for all outgoing packets. tag packets in on
     # $int_if and pass	those tagged packets out on $ext_if.  all other
     # outgoing	packets	(i.e., packets from the	wireless network) are only
     # permitted to access port	80.

     pass in on	$int_if	from any to any	tag INTNET
     pass in on	$wifi_if from any to any

     block out on $ext_if from any to any
     pass out quick on $ext_if tagged INTNET
     pass out on $ext_if proto tcp from	any to any port	80

     # tag incoming packets as they are	redirected to <a href="/cgi/man.cgi?query=spamd&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">spamd(8)</a>.	use the	tag
     # to pass those packets through the packet	filter.

     rdr on $ext_if inet proto tcp from	&lt;spammers&gt; to port smtp	\
	     tag SPAMD -&gt; 127.0.0.1 port spamd

     block in on $ext_if
     pass in on	$ext_if	inet proto tcp tagged SPAMD

<a name="GRAMMAR" href="#end"><b>GRAMMAR</b></a>
     Syntax for	<b>pf.conf</b>	in BNF:

     line	    = (	option | pf-rule | nat-rule | binat-rule | rdr-rule |
		      antispoof-rule | altq-rule | queue-rule |	trans-anchors |
		      anchor-rule | anchor-close | load-anchor | table-rule |
		      include )

     option	    = "set" ( [	"timeout" ( timeout | "{" timeout-list "}" ) ] |
		      [	"ruleset-optimization" [ "none"	| "basic" | "profile" ]] |
		      [	"optimization" [ "default" | "normal" |
		      "high-latency" | "satellite" |
		      "aggressive" | "conservative" ] ]
		      [	"limit"	( limit-item | "{" limit-list "}" ) ] |
		      [	"loginterface" ( interface-name	| "none" ) ] |
		      [	"block-policy" ( "drop"	| "return" ) ] |
		      [	"state-policy" ( "if-bound" | "floating" ) ]
		      [	"state-defaults" state-opts ]
		      [	"require-order"	( "yes"	| "no" ) ]
		      [	"fingerprints" filename	] |
		      [	"skip on" ifspec ] |
		      [	"debug"	( "none" | "urgent" | "misc" | "loud" )	] )

     pf-rule	    = action [ ( "in" |	"out" )	]
		      [	"log" [	"(" logopts ")"] ] [ "quick" ]
		      [	"on" ifspec ] [	"fastroute" | route ] [	af ] [ protospec ]
		      hosts [ filteropt-list ]

     logopts	    = logopt [ "," logopts ]
     logopt	    = "all" | "user" | "to" interface-name

     filteropt-list = filteropt-list filteropt | filteropt
     filteropt	    = user | group | flags | icmp-type | icmp6-type | "tos" tos	|
		      (	"no" | "keep" |	"modulate" | "synproxy"	) "state"
		      [	"(" state-opts ")" ] |
		      "fragment" | "no-df" | "min-ttl" number |	"set-tos" tos |
		      "max-mss"	number | "random-id" | "reassemble tcp"	|
		      fragmentation | "allow-opts" |
		      "label" string | "tag" string | [	! ] "tagged" string |
		      "set prio" ( number | "("	number [ [ "," ] number	] ")" )	|
		      "queue" (	string | "(" string [ [	"," ] string ] ")" ) |
		      "rtable" number |	"probability" number"%"	| "prio" number

     nat-rule	    = [	"no" ] "nat" [ "pass" [	"log" [	"(" logopts ")"	] ] ]
		      [	"on" ifspec ] [	af ]
		      [	protospec ] hosts [ "tag" string ] [ "tagged" string ]
		      [	"-&gt;" ( redirhost | "{" redirhost-list "}" )
		      [	portspec ] [ pooltype ]	[ "static-port"	] ]

     binat-rule	    = [	"no" ] "binat" [ "pass"	[ "log"	[ "(" logopts ")" ] ] ]
		      [	"on" interface-name ] [	af ]
		      [	"proto"	( proto-name | proto-number ) ]
		      "from" address [ "/" mask-bits ] "to" ipspec
		      [	"tag" string ] [ "tagged" string ]
		      [	"-&gt;" address [ "/" mask-bits ] ]

     rdr-rule	    = [	"no" ] "rdr" [ "pass" [	"log" [	"(" logopts ")"	] ] ]
		      [	"on" ifspec ] [	af ]
		      [	protospec ] hosts [ "tag" string ] [ "tagged" string ]
		      [	"-&gt;" ( redirhost | "{" redirhost-list "}" )
		      [	portspec ] [ pooltype ]	]

     antispoof-rule = "antispoof" [ "log" ] [ "quick" ]
		      "for" ifspec [ af	] [ "label" string ]

     table-rule	    = "table" "&lt;" string "&gt;" [ tableopts-list ]
     tableopts-list = tableopts-list tableopts | tableopts
     tableopts	    = "persist"	| "const" | "counters" | "file"	string |
		      "{" [ tableaddr-list ] "}"
     tableaddr-list = tableaddr-list [ "," ] tableaddr-spec | tableaddr-spec
     tableaddr-spec = [	"!" ] tableaddr	[ "/" mask-bits	]
     tableaddr	    = hostname | ifspec	| "self" |
		      ipv4-dotted-quad | ipv6-coloned-hex

     altq-rule	    = "altq on"	interface-name queueopts-list
		      "queue" subqueue
     queue-rule	    = "queue" string [ "on" interface-name ] queueopts-list
		      subqueue

     anchor-rule    = "anchor" [ string	] [ ( "in" | "out" ) ] [ "on" ifspec ]
		      [	af ] [ protospec ] [ hosts ] [ filteropt-list ]	[ "{" ]

     anchor-close   = "}"

     trans-anchors  = (	"nat-anchor" | "rdr-anchor" | "binat-anchor" ) string
		      [	"on" ifspec ] [	af ] [ "proto" ] [ protospec ] [ hosts ]

     load-anchor    = "load anchor" string "from" filename

     queueopts-list = queueopts-list queueopts | queueopts
     queueopts	    = [	"bandwidth" bandwidth-spec ] |
		      [	"qlimit" number	] | [ "tbrsize"	number ] |
		      [	"priority" number ] | [	schedulers ]
     schedulers	    = (	cbq-def	| priq-def | hfsc-def )
     bandwidth-spec = "number" ( "b" | "Kb" | "Mb" | "Gb" | "%"	)

     action	    = "pass" | "block" [ return	] | [ "no" ] "scrub"
     return	    = "drop" | "return"	| "return-rst" [ "( ttl" number	")" ] |
		      "return-icmp" [ "(" icmpcode [ [ "," ] icmp6code ] ")" ] |
		      "return-icmp6" [ "(" icmp6code ")" ]
     icmpcode	    = (	icmp-code-name | icmp-code-number )
     icmp6code	    = (	icmp6-code-name	| icmp6-code-number )

     ifspec	    = (	[ "!" ]	( interface-name | interface-group ) ) |
		      "{" interface-list "}"
     interface-list = [	"!" ] (	interface-name | interface-group )
		      [	[ "," ]	interface-list ]
     route	    = (	"route-to" | "reply-to"	| "dup-to" )
		      (	routehost | "{"	routehost-list "}" )
		      [	pooltype ]
     af		    = "inet" | "inet6"

     protospec	    = "proto" (	proto-name | proto-number |
		      "{" proto-list "}" )
     proto-list	    = (	proto-name | proto-number ) [ [	"," ] proto-list ]

     hosts	    = "all" |
		      "from" ( "any" | "no-route" | "urpf-failed" | "self" | host |
		      "{" host-list "}"	) [ port ] [ os	]
		      "to"   ( "any" | "no-route" | "self" | host |
		      "{" host-list "}"	) [ port ]

     ipspec	    = "any" | host | "{" host-list "}"
     host	    = [	"!" ] (	address	[ "/" mask-bits	] | "&lt;"	string "&gt;" )
     redirhost	    = address [	"/" mask-bits ]
     routehost	    = "(" interface-name [ address [ "/" mask-bits ] ] ")"
     address	    = (	interface-name | interface-group |
		      "(" ( interface-name | interface-group ) ")" |
		      hostname | ipv4-dotted-quad | ipv6-coloned-hex )
     host-list	    = host [ [ "," ] host-list ]
     redirhost-list = redirhost	[ [ ","	] redirhost-list ]
     routehost-list = routehost	[ [ ","	] routehost-list ]

     port	    = "port" ( unary-op	| binary-op | "{" op-list "}" )
     portspec	    = "port" ( number |	name ) [ ":" ( "*" | number | name ) ]
     os		    = "os"  ( os-name |	"{" os-list "}"	)
     user	    = "user" ( unary-op	| binary-op | "{" op-list "}" )
     group	    = "group" (	unary-op | binary-op | "{" op-list "}" )

     unary-op	    = [	"=" | "!=" | "&lt;" | "&lt;="	| "&gt;" |	"&gt;=" ]
		      (	name | number )
     binary-op	    = number ( "&lt;&gt;" | "&gt;&lt;" | ":" ) number
     op-list	    = (	unary-op | binary-op ) [ [ "," ] op-list ]

     os-name	    = operating-system-name
     os-list	    = os-name [	[ "," ]	os-list	]

     flags	    = "flags" (	[ flag-set ] "/"  flag-set | "any" )
     flag-set	    = [	"F" ] [	"S" ] [	"R" ] [	"P" ] [	"A" ] [	"U" ] [	"E" ]
		      [	"W" ]

     icmp-type	    = "icmp-type" ( icmp-type-code | "{" icmp-list "}" )
     icmp6-type	    = "icmp6-type" ( icmp-type-code | "{" icmp-list "}"	)
     icmp-type-code = (	icmp-type-name | icmp-type-number )
		      [	"code" ( icmp-code-name	| icmp-code-number ) ]
     icmp-list	    = icmp-type-code [ [ "," ] icmp-list ]

     tos	    = (	"lowdelay" | "throughput" | "reliability" |
		      [	"0x" ] number )

     state-opts	    = state-opt	[ [ ","	] state-opts ]
     state-opt	    = (	"max" number | "no-sync" | timeout | "sloppy" |	"pflow"	|
		      "source-track" [ ( "rule"	| "global" ) ] |
		      "max-src-nodes" number | "max-src-states"	number |
		      "max-src-conn" number |
		      "max-src-conn-rate" number "/" number |
		      "overload" "&lt;" string "&gt;"	[ "flush" ] |
		      "if-bound" | "floating" )

     fragmentation  = [	"fragment reassemble" ]

     timeout-list   = timeout [	[ "," ]	timeout-list ]
     timeout	    = (	"tcp.first" | "tcp.opening" | "tcp.established"	|
		      "tcp.closing" | "tcp.finwait" | "tcp.closed" |
		      "udp.first" | "udp.single" | "udp.multiple" |
		      "icmp.first" | "icmp.error" |
		      "other.first" | "other.single" | "other.multiple"	|
		      "frag" | "interval" | "src.track"	|
		      "adaptive.start" | "adaptive.end"	) number

     limit-list	    = limit-item [ [ "," ] limit-list ]
     limit-item	    = (	"states" | "frags" | "src-nodes" ) number

     pooltype	    = (	"bitmask" | "random" |
		      "source-hash" [ (	hex-key	| string-key ) ] |
		      "round-robin" ) [	sticky-address ]

     subqueue	    = string | "{" queue-list "}"
     queue-list	    = string [ [ "," ] string ]
     cbq-def	    = "cbq" [ "(" cbq-opt [ [ "," ] cbq-opt ] ")" ]
     priq-def	    = "priq" [ "(" priq-opt [ [	"," ] priq-opt ] ")" ]
     hfsc-def	    = "hfsc" [ "(" hfsc-opt [ [	"," ] hfsc-opt ] ")" ]
     cbq-opt	    = (	"default" | "borrow" | "red" | "ecn" | "rio" )
     priq-opt	    = (	"default" | "red" | "ecn" | "rio" )
     hfsc-opt	    = (	"default" | "red" | "ecn" | "rio" |
		      linkshare-sc | realtime-sc | upperlimit-sc )
     linkshare-sc   = "linkshare" sc-spec
     realtime-sc    = "realtime" sc-spec
     upperlimit-sc  = "upperlimit" sc-spec
     sc-spec	    = (	bandwidth-spec |
		      "(" bandwidth-spec number	bandwidth-spec ")" )
     include	    = "include"	filename

<a name="FILES" href="#end"><b>FILES</b></a>
     /etc/hosts	     Host name database.
     /etc/pf.conf    Default location of the ruleset file.
     /etc/pf.os	     Default location of OS fingerprints.
     /etc/protocols  Protocol name database.
     /etc/services   Service name database.

<a name="SEE_ALSO" href="#end"><b>SEE ALSO</b></a>
     <a href="/cgi/man.cgi?query=altq&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">altq(4)</a>, <a href="/cgi/man.cgi?query=carp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">carp(4)</a>, <a href="/cgi/man.cgi?query=icmp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">icmp(4)</a>,	<a href="/cgi/man.cgi?query=icmp6&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">icmp6(4)</a>, <a href="/cgi/man.cgi?query=ip&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ip(4)</a>, <a href="/cgi/man.cgi?query=ip6&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ip6(4)</a>, <a href="/cgi/man.cgi?query=pf&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf(4)</a>,	<a href="/cgi/man.cgi?query=pflow&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pflow(4)</a>,
     <a href="/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfsync(4)</a>,	<a href="/cgi/man.cgi?query=tcp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">tcp(4)</a>,	<a href="/cgi/man.cgi?query=udp&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">udp(4)</a>,	<a href="/cgi/man.cgi?query=hosts&amp;sektion=5&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">hosts(5)</a>, <a href="/cgi/man.cgi?query=pf.os&amp;sektion=5&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pf.os(5)</a>, <a href="/cgi/man.cgi?query=protocols&amp;sektion=5&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">protocols(5)</a>, <a href="/cgi/man.cgi?query=services&amp;sektion=5&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">services(5)</a>,
     <a href="/cgi/man.cgi?query=ftp-proxy&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">ftp-proxy(8)</a>, <a href="/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pfctl(8)</a>, <a href="/cgi/man.cgi?query=pflogd&amp;sektion=8&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">pflogd(8)</a>

<a name="HISTORY" href="#end"><b>HISTORY</b></a>
     The <b>pf.conf</b> file format first appeared in OpenBSD 3.0.

FreeBSD	11.2			 June 9, 2016			  FreeBSD 11.2
</pre>
<a name="end" />
<hr />
<a href="#NAME">NAME</a> |
<a href="#DESCRIPTION">DESCRIPTION</a> |
<a href="#STATEMENT_ORDER">STATEMENT ORDER</a> |
<a href="#MACROS">MACROS</a> |
<a href="#TABLES">TABLES</a> |
<a href="#OPTIONS">OPTIONS</a> |
<a href="#TRAFFIC%09NORMALIZATION">TRAFFIC	NORMALIZATION</a> |
<a href="#QUEUEING">QUEUEING</a> |
<a href="#TRANSLATION">TRANSLATION</a> |
<a href="#PACKET_FILTERING">PACKET FILTERING</a> |
<a href="#PARAMETERS">PARAMETERS</a> |
<a href="#ROUTING">ROUTING</a> |
<a href="#POOL_OPTIONS">POOL OPTIONS</a> |
<a href="#STATE_MODULATION">STATE MODULATION</a> |
<a href="#SYN_PROXY">SYN PROXY</a> |
<a href="#STATEFUL_TRACKING_OPTIONS">STATEFUL TRACKING OPTIONS</a> |
<a href="#OPERATING_SYSTEM_FINGERPRINTING">OPERATING SYSTEM FINGERPRINTING</a> |
<a href="#BLOCKING_SPOOFED_TRAFFIC">BLOCKING SPOOFED TRAFFIC</a> |
<a href="#FRAGMENT_HANDLING">FRAGMENT HANDLING</a> |
<a href="#ANCHORS">ANCHORS</a> |
<a href="#TRANSLATION_EXAMPLES">TRANSLATION EXAMPLES</a> |
<a href="#FILTER_EXAMPLES">FILTER EXAMPLES</a> |
<a href="#GRAMMAR">GRAMMAR</a> |
<a href="#FILES">FILES</a> |
<a href="#SEE_ALSO">SEE ALSO</a> |
<a href="#HISTORY">HISTORY</a>
<p align="left">Want to link to this manual page? Use this URL:<br/>&lt;<a href="https://www.freebsd.org/cgi/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports">https://www.freebsd.org/cgi/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports</a>&gt;</p>
<span class="footer_links"><a href="/cgi/man.cgi?manpath=">home</a> | <a href="/cgi/man.cgi/help.html">help</a></span>
<hr noshade="noshade" />
	</div>
        <div id="footer">
          <a href="../copyright/">Legal Notices</a> | &copy; 1995-2018
          The FreeBSD Project. All rights reserved.<br />
	  <address><a href='../mailto.html'>Contact</a><br /></address>
        </div>
      </div>
    </div>
  </body>
</html>
